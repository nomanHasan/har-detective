export const v1Data = {
  "log": {
    "version": "1.2",
    "creator": {
      "name": "Firefox",
      "version": "115.0.3"
    },
    "browser": {
      "name": "Firefox",
      "version": "115.0.3"
    },
    "pages": [
      {
        "id": "page_2",
        "pageTimings": {
          "onContentLoad": -1,
          "onLoad": -1
        },
        "startedDateTime": "2023-08-02T17:02:09.616+06:00",
        "title": "details - booking agency and record label software"
      }
    ],
    "entries": [
      {
        "startedDateTime": "2023-08-02T17:02:09.616+06:00",
        "request": {
          "bodySize": 93,
          "method": "POST",
          "url": "https://dev.berlin3.com/designcheck/distribution.pl",
          "httpVersion": "HTTP/1.1",
          "headers": [
            {
              "name": "Host",
              "value": "dev.berlin3.com"
            },
            {
              "name": "User-Agent",
              "value": "Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/115.0"
            },
            {
              "name": "Accept",
              "value": "*/*"
            },
            {
              "name": "Accept-Language",
              "value": "en-US,en;q=0.5"
            },
            {
              "name": "Accept-Encoding",
              "value": "gzip, deflate, br"
            },
            {
              "name": "Referer",
              "value": "https://dev.berlin3.com/designcheck/index.pl?start=1"
            },
            {
              "name": "Content-Type",
              "value": "application/x-www-form-urlencoded"
            },
            {
              "name": "X-Requested-With",
              "value": "XMLHttpRequest"
            },
            {
              "name": "Content-Length",
              "value": "93"
            },
            {
              "name": "Origin",
              "value": "https://dev.berlin3.com"
            },
            {
              "name": "Connection",
              "value": "keep-alive"
            },
            {
              "name": "Cookie",
              "value": "DISKO::AUTH_berlin3=geralt:2023-08-02-08-05-30:2023-08-04-08-05-30::e60a2e76975475a2a5584c7f616a3df2; mainWindow=width%3A990%2Cheight%3A620%2CxPos%3A0%2CyPos%3A0%2CzIndex%3A%2CactiveTabId%3ADistribution%2Cstate%3Aundefined; WindowSettings=width%3A990%2Cheight%3A600%2CxPos%3A2%2CyPos%3A2%2CzIndex%3A%2CactiveTabId%3ABookingSettingsTab%2Cstate%3Aundefined; WindowAccounting=width%3A990%2Cheight%3A600%2CxPos%3A2%2CyPos%3A2%2CzIndex%3A%2CactiveTabId%3AAccInvoicesTab%2Cstate%3Aundefined; WindowBooking=width%3A990%2Cheight%3A600%2CxPos%3A2%2CyPos%3A2%2CzIndex%3A%2CactiveTabId%3ABookCalendarTab%2Cstate%3Aundefined; WindowLabel=width%3A990%2Cheight%3A600%2CxPos%3A2%2CyPos%3A2%2CzIndex%3A%2CactiveTabId%3ALabelRoyaltyTab%2Cstate%3Aundefined; WindowDistribution=width%3A990%2Cheight%3A600%2CxPos%3A2%2CyPos%3A2%2CzIndex%3A%2CactiveTabId%3ADistAccountsTab%2Cstate%3Aundefined; WindowContacts=width%3A990%2Cheight%3A600%2CxPos%3A2%2CyPos%3A2%2CzIndex%3A%2CactiveTabId%3AGenContactsTab%2Cstate%3Aundefined; chatbox_minimized=Support%7CSupport; _ga=GA1.2.2001653648.1668753357; _ga_4GJL8L77LJ=GS1.1.1683275798.7.0.1683275798.0.0.0; _ga_BM42RTS79Q=GS1.2.1690175692.1.1.1690176135.0.0.0; CGISESSID=d13ec288b68da2ce5a3b6408ced3df7a"
            },
            {
              "name": "Sec-Fetch-Dest",
              "value": "empty"
            },
            {
              "name": "Sec-Fetch-Mode",
              "value": "cors"
            },
            {
              "name": "Sec-Fetch-Site",
              "value": "same-origin"
            }
          ],
          "cookies": [
            {
              "name": "DISKO::AUTH_berlin3",
              "value": "geralt:2023-08-02-08-05-30:2023-08-04-08-05-30::e60a2e76975475a2a5584c7f616a3df2"
            },
            {
              "name": "mainWindow",
              "value": "width:990,height:620,xPos:0,yPos:0,zIndex:,activeTabId:Distribution,state:undefined"
            },
            {
              "name": "WindowSettings",
              "value": "width:990,height:600,xPos:2,yPos:2,zIndex:,activeTabId:BookingSettingsTab,state:undefined"
            },
            {
              "name": "WindowAccounting",
              "value": "width:990,height:600,xPos:2,yPos:2,zIndex:,activeTabId:AccInvoicesTab,state:undefined"
            },
            {
              "name": "WindowBooking",
              "value": "width:990,height:600,xPos:2,yPos:2,zIndex:,activeTabId:BookCalendarTab,state:undefined"
            },
            {
              "name": "WindowLabel",
              "value": "width:990,height:600,xPos:2,yPos:2,zIndex:,activeTabId:LabelRoyaltyTab,state:undefined"
            },
            {
              "name": "WindowDistribution",
              "value": "width:990,height:600,xPos:2,yPos:2,zIndex:,activeTabId:DistAccountsTab,state:undefined"
            },
            {
              "name": "WindowContacts",
              "value": "width:990,height:600,xPos:2,yPos:2,zIndex:,activeTabId:GenContactsTab,state:undefined"
            },
            {
              "name": "chatbox_minimized",
              "value": "Support|Support"
            },
            {
              "name": "_ga",
              "value": "GA1.2.2001653648.1668753357"
            },
            {
              "name": "_ga_4GJL8L77LJ",
              "value": "GS1.1.1683275798.7.0.1683275798.0.0.0"
            },
            {
              "name": "_ga_BM42RTS79Q",
              "value": "GS1.2.1690175692.1.1.1690176135.0.0.0"
            },
            {
              "name": "CGISESSID",
              "value": "d13ec288b68da2ce5a3b6408ced3df7a"
            }
          ],
          "queryString": [],
          "headersSize": 1763,
          "postData": {
            "mimeType": "application/x-www-form-urlencoded",
            "params": [
              {
                "name": "section",
                "value": "accounts"
              },
              {
                "name": "action",
                "value": "create_set_statements_invoice"
              },
              {
                "name": "account_id",
                "value": "4"
              },
              {
                "name": "statements",
                "value": "[\"435\"]"
              }
            ],
            "text": "section=accounts&action=create_set_statements_invoice&account_id=4&statements=%5B%22435%22%5D"
          }
        },
        "response": {
          "status": 200,
          "statusText": "OK",
          "httpVersion": "HTTP/1.1",
          "headers": [
            {
              "name": "Date",
              "value": "Wed, 02 Aug 2023 11:02:09 GMT"
            },
            {
              "name": "Server",
              "value": "Apache/2.4.52 (Ubuntu) OpenSSL/3.0.2 mod_perl/2.0.12 Perl/v5.34.0"
            },
            {
              "name": "Set-Cookie",
              "value": "DISKO::AUTH_berlin3=geralt:2023-08-02-08-05-30:2023-08-04-08-05-30::e60a2e76975475a2a5584c7f616a3df2; expires=Fri, 04 Aug 2023 11:02:09 GMT; path=/designcheck/; domain=.berlin3.com"
            },
            {
              "name": "Access-Control-Allow-Credentials",
              "value": "true"
            },
            {
              "name": "Keep-Alive",
              "value": "timeout=30, max=84"
            },
            {
              "name": "Connection",
              "value": "Keep-Alive"
            },
            {
              "name": "Transfer-Encoding",
              "value": "chunked"
            },
            {
              "name": "Content-Type",
              "value": "application/json; charset=utf-8"
            }
          ],
          "cookies": [
            {
              "name": "DISKO::AUTH_berlin3",
              "value": "geralt:2023-08-02-08-05-30:2023-08-04-08-05-30::e60a2e76975475a2a5584c7f616a3df2"
            }
          ],
          "content": {
            "mimeType": "application/json; charset=utf-8",
            "size": 8329,
            "text": "{\"process\":\"complete\",\"account\":{\"contact_id_delivery\":2005,\"account_type\":null,\"account_name\":\"Rough Trade\",\"contact_id_invoice\":2005,\"transfer_order_account_id\":null,\"contact_id_buyer\":null,\"credit_limit\":null,\"notes\":null,\"no_backorder\":null,\"deal_memo\":null,\"digital\":null,\"default_order_type\":1,\"physical\":1,\"own_stock\":1,\"shipping_info\":\"Rough Trade · Rough Trade Distribution GmbH · Mathias-Brüggen-Str. 85 · 50829 Köln · Germany\",\"identifier\":null,\"user_id\":null,\"shipping_type_id\":null,\"contra_account_id\":null,\"dispatcher\":1,\"short_name\":\"RT\",\"ignore_payment_period\":null,\"main_account\":1,\"pricelist_id\":1,\"last_modified\":\"2019-06-17 14:03:14\",\"created\":\"1970-12-16 01:01:01\",\"release_shift\":null,\"price_list_discount\":null,\"currency_id\":1,\"mechanicals_omit\":1,\"account_id\":4,\"invoice_project_id\":1},\"statements\":[{\"invoice_project_id\":1,\"account_id\":4,\"invoice_contact\":\"Aggregator Of Music\",\"currency\":\"NZD\",\"digital_physical\":\"physical\",\"currency_id\":6,\"statement_period_txt\":\"M1\",\"description\":\"phys\",\"all_lines_assigned\":1,\"import_amount\":null,\"statement_id\":424,\"invoice_id\":null,\"fix_country\":\"\",\"rounding_difference\":0,\"choose_key\":\"OPEN_STATEMENTS\\n4_6_86020_1\",\"statement_year\":2024,\"statement_amount\":null,\"contact_id\":86020},{\"import_amount\":null,\"statement_id\":367,\"invoice_id\":null,\"fix_country\":\"\",\"rounding_difference\":0,\"choose_key\":\"OPEN_STATEMENTS\\n4_6_86020_1\",\"statement_year\":2023,\"contact_id\":86020,\"statement_amount\":null,\"account_id\":4,\"invoice_project_id\":1,\"invoice_contact\":\"Aggregator Of Music\",\"currency\":\"NZD\",\"digital_physical\":\"physical\",\"currency_id\":6,\"statement_period_txt\":\"M12\",\"description\":\"phys\",\"all_lines_assigned\":1},{\"import_amount\":\"1450.68\",\"statement_id\":434,\"invoice_id\":null,\"fix_country\":\"\",\"choose_key\":\"OPEN_STATEMENTS\\n4_6_86020_1\",\"rounding_difference\":0,\"statement_year\":2023,\"contact_id\":86020,\"statement_amount\":\"1450.68\",\"account_id\":4,\"invoice_project_id\":1,\"invoice_contact\":\"Aggregator Of Music\",\"currency\":\"NZD\",\"digital_physical\":\"physical\",\"currency_id\":6,\"statement_period_txt\":\"M7\",\"description\":\"phys\",\"all_lines_assigned\":0},{\"invoice_contact\":\"Aggregator Of Music\",\"account_id\":4,\"invoice_project_id\":1,\"currency\":\"NZD\",\"digital_physical\":\"physical\",\"statement_period_txt\":\"M2\",\"currency_id\":6,\"description\":\"phys\",\"all_lines_assigned\":0,\"import_amount\":\"15166.81\",\"invoice_id\":null,\"statement_id\":279,\"fix_country\":\"\",\"statement_year\":2023,\"rounding_difference\":0,\"choose_key\":\"OPEN_STATEMENTS\\n4_6_86020_1\",\"statement_amount\":\"15166.81\",\"contact_id\":86020},{\"fix_country\":null,\"rounding_difference\":0,\"choose_key\":\"OPEN_STATEMENTS\\n4_1_91007_206\",\"statement_year\":2022,\"statement_amount\":\"-18681.05\",\"contact_id\":91007,\"import_amount\":\"-18681.05\",\"statement_id\":263,\"invoice_id\":null,\"currency_id\":1,\"statement_period_txt\":\"M9\",\"description\":\"test\",\"all_lines_assigned\":0,\"account_id\":4,\"invoice_project_id\":206,\"invoice_contact\":\"!!! SQL KILL META - copy !\",\"currency\":\"EUR\",\"digital_physical\":\"costs\"},{\"invoice_contact\":\"!!! SQL KILL META - copy !\",\"invoice_project_id\":206,\"account_id\":4,\"digital_physical\":\"costs\",\"currency\":\"EUR\",\"statement_period_txt\":\"M1\",\"currency_id\":1,\"all_lines_assigned\":1,\"description\":\"test\",\"import_amount\":\"-50.00\",\"invoice_id\":null,\"statement_id\":304,\"statement_year\":2021,\"choose_key\":\"OPEN_STATEMENTS\\n4_1_91007_206\",\"rounding_difference\":0,\"fix_country\":null,\"contact_id\":91007,\"statement_amount\":\"-50.00\"},{\"digital_physical\":\"costs\",\"currency\":\"EUR\",\"invoice_contact\":\"Rough Trade\",\"account_id\":4,\"invoice_project_id\":204,\"all_lines_assigned\":1,\"description\":\"RT Costs\",\"statement_period_txt\":\"M1\",\"currency_id\":1,\"invoice_id\":null,\"statement_id\":305,\"import_amount\":\"-50.00\",\"statement_amount\":\"-50.00\",\"contact_id\":2005,\"statement_year\":2020,\"choose_key\":\"OPEN_STATEMENTS\\n4_1_2005_204\",\"rounding_difference\":0,\"fix_country\":\"fix_shop\"},{\"description\":\"RT Costs\",\"all_lines_assigned\":1,\"statement_period_txt\":\"M8\",\"currency_id\":1,\"currency\":\"EUR\",\"digital_physical\":\"costs\",\"invoice_contact\":\"Rough Trade\",\"account_id\":4,\"invoice_project_id\":204,\"statement_amount\":\"-50.00\",\"contact_id\":2005,\"fix_country\":\"fix_shop\",\"statement_year\":2016,\"rounding_difference\":0,\"choose_key\":\"OPEN_STATEMENTS\\n4_1_2005_204\",\"invoice_id\":null,\"statement_id\":324,\"import_amount\":\"-50.00\"},{\"invoice_project_id\":204,\"account_id\":4,\"invoice_contact\":\"Rough Trade\",\"digital_physical\":\"costs\",\"currency\":\"EUR\",\"currency_id\":1,\"statement_period_txt\":\"M7\",\"all_lines_assigned\":0,\"description\":\"RT Costs\",\"import_amount\":\"-18681.05\",\"statement_id\":316,\"invoice_id\":null,\"rounding_difference\":0,\"choose_key\":\"OPEN_STATEMENTS\\n4_1_2005_204\",\"statement_year\":2016,\"fix_country\":\"fix_shop\",\"contact_id\":2005,\"statement_amount\":\"-18681.05\"},{\"rounding_difference\":0,\"choose_key\":\"OPEN_STATEMENTS\\n4_1_2005_204\",\"statement_year\":2016,\"fix_country\":\"fix_shop\",\"contact_id\":2005,\"statement_amount\":\"-50.00\",\"import_amount\":\"-50.00\",\"statement_id\":321,\"invoice_id\":null,\"currency_id\":1,\"statement_period_txt\":\"M2\",\"all_lines_assigned\":1,\"description\":\"RT Costs\",\"account_id\":4,\"invoice_project_id\":204,\"invoice_contact\":\"Rough Trade\",\"digital_physical\":\"costs\",\"currency\":\"EUR\"},{\"statement_year\":2016,\"rounding_difference\":0,\"choose_key\":\"OPEN_STATEMENTS\\n4_1_91007_206\",\"fix_country\":null,\"statement_amount\":\"-50.00\",\"contact_id\":91007,\"import_amount\":\"-50.00\",\"invoice_id\":null,\"statement_id\":322,\"statement_period_txt\":\"M2\",\"currency_id\":1,\"all_lines_assigned\":1,\"description\":\"test\",\"invoice_contact\":\"!!! SQL KILL META - copy !\",\"invoice_project_id\":206,\"account_id\":4,\"digital_physical\":\"costs\",\"currency\":\"EUR\"},{\"statement_year\":2016,\"rounding_difference\":0,\"choose_key\":\"OPEN_STATEMENTS\\n4_1_2005_204\",\"fix_country\":\"fix_shop\",\"statement_amount\":\"-50.00\",\"contact_id\":2005,\"import_amount\":\"-50.00\",\"invoice_id\":null,\"statement_id\":317,\"statement_period_txt\":\"M1\",\"currency_id\":1,\"all_lines_assigned\":1,\"description\":\"RT Costs\",\"invoice_contact\":\"Rough Trade\",\"invoice_project_id\":204,\"account_id\":4,\"digital_physical\":\"costs\",\"currency\":\"EUR\"},{\"digital_physical\":\"costs\",\"currency\":\"EUR\",\"invoice_contact\":\"!!! SQL KILL META - copy !\",\"account_id\":4,\"invoice_project_id\":206,\"all_lines_assigned\":0,\"description\":\"test\",\"statement_period_txt\":\"M1\",\"currency_id\":1,\"invoice_id\":null,\"statement_id\":318,\"import_amount\":\"-18681.05\",\"contact_id\":91007,\"statement_amount\":\"-18681.05\",\"statement_year\":2016,\"rounding_difference\":0,\"choose_key\":\"OPEN_STATEMENTS\\n4_1_91007_206\",\"fix_country\":null},{\"statement_id\":325,\"invoice_id\":null,\"import_amount\":\"-50.00\",\"statement_amount\":\"-50.00\",\"contact_id\":2005,\"rounding_difference\":0,\"choose_key\":\"OPEN_STATEMENTS\\n4_1_2005_204\",\"statement_year\":2015,\"fix_country\":\"fix_shop\",\"digital_physical\":\"costs\",\"currency\":\"EUR\",\"account_id\":4,\"invoice_project_id\":204,\"invoice_contact\":\"Rough Trade\",\"all_lines_assigned\":1,\"description\":\"RT Costs\",\"currency_id\":1,\"statement_period_txt\":\"M7\"}],\"invoice\":{\"performance_date\":null,\"invoice_language\":null,\"invoice_ref\":\"details-2023-0087\",\"invoice_ref_key\":\"details-2023-#nr#\",\"exchange_rate\":1.7855,\"country_id\":null,\"external_table\":\"accounts\",\"gross_amount\":null,\"trailing_text\":null,\"paypal_email\":null,\"exported_date\":null,\"amount\":null,\"vat_rate1\":\"19.00\",\"tax_deduction_percent\":null,\"vat_rate2\":\"6.00\",\"vat_handling\":3,\"royalty_date2\":null,\"external_id2\":null,\"end_of_month_flag\":null,\"royalty_date1\":null,\"vat_rate3\":null,\"last_modified\":\"2023-08-02 11:02:10\",\"created\":\"2023-08-02 11:02:09\",\"currency_id\":6,\"performance_country\":null,\"invoice_id\":575,\"net_amount\":null,\"exchange_rate_creation\":null,\"vat2_amount\":null,\"subject\":\"physical - phys 2023/M8\",\"invoice_no\":87,\"money_account_id\":2,\"invoice_address\":\"Aggregator Of Music\\nOld Mill Road 177\\nEG3 HT4 London\\nUnited Kingdom\",\"notes\":null,\"leading_text\":null,\"external_table2\":null,\"tax_type_id_deduction\":null,\"vat_territory\":null,\"discount_days\":null,\"vat1_amount\":null,\"discount_percent\":null,\"lock_flag\":null,\"forward_completed_flag\":null,\"display_correction\":null,\"paid_flag\":null,\"invoice_date\":\"2023-08-02\",\"invoice_project_id\":1,\"tax_deduction_amount\":null,\"cancelled_flag\":null,\"payment_date\":null,\"invoice_user_id\":null,\"cost_flag\":null,\"due_days\":10,\"external_id\":4,\"contact_id\":86020,\"cost_group_id\":null,\"payment_method_id\":4,\"external_ref\":null,\"json_data\":null}}"
          },
          "redirectURL": "",
          "headersSize": 496,
          "bodySize": 8825
        },
        "cache": {},
        "timings": {
          "blocked": 0,
          "dns": 0,
          "connect": 0,
          "ssl": 0,
          "send": 0,
          "wait": 1802,
          "receive": 0
        },
        "time": 1802,
        "_securityState": "secure",
        "serverIPAddress": "79.125.7.197",
        "connection": "443",
        "pageref": "page_2"
      },
      {
        "startedDateTime": "2023-08-02T17:02:11.431+06:00",
        "request": {
          "bodySize": 0,
          "method": "GET",
          "url": "https://dev.berlin3.com/designcheck/accounting.pl?section=invoices&rndval=1690974131431",
          "httpVersion": "HTTP/1.1",
          "headers": [
            {
              "name": "Host",
              "value": "dev.berlin3.com"
            },
            {
              "name": "User-Agent",
              "value": "Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/115.0"
            },
            {
              "name": "Accept",
              "value": "*/*"
            },
            {
              "name": "Accept-Language",
              "value": "en-US,en;q=0.5"
            },
            {
              "name": "Accept-Encoding",
              "value": "gzip, deflate, br"
            },
            {
              "name": "Referer",
              "value": "https://dev.berlin3.com/designcheck/index.pl?start=1"
            },
            {
              "name": "Connection",
              "value": "keep-alive"
            },
            {
              "name": "Cookie",
              "value": "DISKO::AUTH_berlin3=geralt:2023-08-02-08-05-30:2023-08-04-08-05-30::e60a2e76975475a2a5584c7f616a3df2; mainWindow=width%3A990%2Cheight%3A620%2CxPos%3A0%2CyPos%3A0%2CzIndex%3A%2CactiveTabId%3AAccounting%2Cstate%3Aundefined; WindowSettings=width%3A990%2Cheight%3A600%2CxPos%3A2%2CyPos%3A2%2CzIndex%3A%2CactiveTabId%3ABookingSettingsTab%2Cstate%3Aundefined; WindowAccounting=width%3A990%2Cheight%3A600%2CxPos%3A2%2CyPos%3A2%2CzIndex%3A%2CactiveTabId%3AAccInvoicesTab%2Cstate%3Aundefined; WindowBooking=width%3A990%2Cheight%3A600%2CxPos%3A2%2CyPos%3A2%2CzIndex%3A%2CactiveTabId%3ABookCalendarTab%2Cstate%3Aundefined; WindowLabel=width%3A990%2Cheight%3A600%2CxPos%3A2%2CyPos%3A2%2CzIndex%3A%2CactiveTabId%3ALabelRoyaltyTab%2Cstate%3Aundefined; WindowDistribution=width%3A990%2Cheight%3A600%2CxPos%3A2%2CyPos%3A2%2CzIndex%3A%2CactiveTabId%3ADistAccountsTab%2Cstate%3Aundefined; WindowContacts=width%3A990%2Cheight%3A600%2CxPos%3A2%2CyPos%3A2%2CzIndex%3A%2CactiveTabId%3AGenContactsTab%2Cstate%3Aundefined; chatbox_minimized=Support%7CSupport; _ga=GA1.2.2001653648.1668753357; _ga_4GJL8L77LJ=GS1.1.1683275798.7.0.1683275798.0.0.0; _ga_BM42RTS79Q=GS1.2.1690175692.1.1.1690176135.0.0.0; CGISESSID=d13ec288b68da2ce5a3b6408ced3df7a"
            },
            {
              "name": "Sec-Fetch-Dest",
              "value": "empty"
            },
            {
              "name": "Sec-Fetch-Mode",
              "value": "cors"
            },
            {
              "name": "Sec-Fetch-Site",
              "value": "same-origin"
            }
          ],
          "cookies": [
            {
              "name": "DISKO::AUTH_berlin3",
              "value": "geralt:2023-08-02-08-05-30:2023-08-04-08-05-30::e60a2e76975475a2a5584c7f616a3df2"
            },
            {
              "name": "mainWindow",
              "value": "width:990,height:620,xPos:0,yPos:0,zIndex:,activeTabId:Accounting,state:undefined"
            },
            {
              "name": "WindowSettings",
              "value": "width:990,height:600,xPos:2,yPos:2,zIndex:,activeTabId:BookingSettingsTab,state:undefined"
            },
            {
              "name": "WindowAccounting",
              "value": "width:990,height:600,xPos:2,yPos:2,zIndex:,activeTabId:AccInvoicesTab,state:undefined"
            },
            {
              "name": "WindowBooking",
              "value": "width:990,height:600,xPos:2,yPos:2,zIndex:,activeTabId:BookCalendarTab,state:undefined"
            },
            {
              "name": "WindowLabel",
              "value": "width:990,height:600,xPos:2,yPos:2,zIndex:,activeTabId:LabelRoyaltyTab,state:undefined"
            },
            {
              "name": "WindowDistribution",
              "value": "width:990,height:600,xPos:2,yPos:2,zIndex:,activeTabId:DistAccountsTab,state:undefined"
            },
            {
              "name": "WindowContacts",
              "value": "width:990,height:600,xPos:2,yPos:2,zIndex:,activeTabId:GenContactsTab,state:undefined"
            },
            {
              "name": "chatbox_minimized",
              "value": "Support|Support"
            },
            {
              "name": "_ga",
              "value": "GA1.2.2001653648.1668753357"
            },
            {
              "name": "_ga_4GJL8L77LJ",
              "value": "GS1.1.1683275798.7.0.1683275798.0.0.0"
            },
            {
              "name": "_ga_BM42RTS79Q",
              "value": "GS1.2.1690175692.1.1.1690176135.0.0.0"
            },
            {
              "name": "CGISESSID",
              "value": "d13ec288b68da2ce5a3b6408ced3df7a"
            }
          ],
          "queryString": [
            {
              "name": "section",
              "value": "invoices"
            },
            {
              "name": "rndval",
              "value": "1690974131431"
            }
          ],
          "headersSize": 1660
        },
        "response": {
          "status": 200,
          "statusText": "OK",
          "httpVersion": "HTTP/1.1",
          "headers": [
            {
              "name": "Date",
              "value": "Wed, 02 Aug 2023 11:02:11 GMT"
            },
            {
              "name": "Server",
              "value": "Apache/2.4.52 (Ubuntu) OpenSSL/3.0.2 mod_perl/2.0.12 Perl/v5.34.0"
            },
            {
              "name": "Set-Cookie",
              "value": "DISKO::AUTH_berlin3=geralt:2023-08-02-08-05-30:2023-08-04-08-05-30::e60a2e76975475a2a5584c7f616a3df2; expires=Fri, 04 Aug 2023 11:02:11 GMT; path=/designcheck/; domain=.berlin3.com"
            },
            {
              "name": "Vary",
              "value": "Accept-Encoding"
            },
            {
              "name": "Content-Encoding",
              "value": "gzip"
            },
            {
              "name": "Access-Control-Allow-Credentials",
              "value": "true"
            },
            {
              "name": "Content-Length",
              "value": "19839"
            },
            {
              "name": "Keep-Alive",
              "value": "timeout=30, max=83"
            },
            {
              "name": "Connection",
              "value": "Keep-Alive"
            },
            {
              "name": "Content-Type",
              "value": "text/html; charset=utf-8"
            }
          ],
          "cookies": [
            {
              "name": "DISKO::AUTH_berlin3",
              "value": "geralt:2023-08-02-08-05-30:2023-08-04-08-05-30::e60a2e76975475a2a5584c7f616a3df2"
            }
          ],
          "content": {
            "mimeType": "text/html; charset=utf-8",
            "size": 117586,
            "text": "\r\n<!-- status start:: i found that from beginning we are using open = 1, partially_paid = 2, fully_paid = 3 and cancelled = 4 in htm, i put it in one place so that we can use as varialble and can can the number if need. -->\r\n\r\n<!-- status end -->\r\n<div id=\"accounting_invoices\">\r\n\t\t<div class=\"DHTMLSuite_aTab\">\r\n        \t<div class=\"mb5\">\r\n            \t<table id=\"invoice_table_header\" class=\"fullWidth fixedLayout\">\r\n                \t<tr>\r\n                    \t<td width=\"16%\" class=\"pl5\">\r\n\t\t\t\t\t\t\tSearch<input type=\"text\" id=\"search_invoices\" onkeyup=\"berlin3.common.keyUpInput(this);\" handler=\"berlin3.invoices.msgHandler\" msg=\"str_filter_invoice\" class=\"box\" style=\"width: 70%;\" />\r\n                        </td>\r\n\r\n                        <td width=\"47%\">\r\n                            <select id=\"invoice_project\" onchange=\"berlin3.invoices.filter_invoice(this);\" class=\"box\" style=\"width: 40%;\">\r\n                            \t<option value=\"0\"></option>\r\n                            \t\r\n                                <option value=\"1\">Details Label</option>\r\n                                \r\n                                <option value=\"227\">Details Label COPY</option>\r\n                                \r\n                                <option value=\"206\">Details Order</option>\r\n                                \r\n                                <option value=\"204\">Details UK</option>\r\n                                \r\n                                <option value=\"211\">DJ XYZ</option>\r\n                                \r\n                                <option value=\"100\">Invoice Including Barcode</option>\r\n                                \r\n                                <option value=\"226\">Magical Melodies Invoices</option>\r\n                                \r\n                                <option value=\"215\">TEST </option>\r\n                                \r\n                                <option value=\"216\">TEST 2</option>\r\n                                \r\n                            </select>\r\n                        </td>\r\n                         <td width=\"10%\">\r\n                            <select id=\"invoice_user_id\" onchange=\"berlin3.invoices.filter_invoice(this);\" class=\"box\" style=\"width: 90%;\">\r\n                                <option value=\"0\"></option>\r\n                                \r\n                                <option value=\"231\">aa</option>\r\n                                \r\n                                <option value=\"44\">aki2</option>\r\n                                \r\n                                <option value=\"159\">Anika</option>\r\n                                \r\n                                <option value=\"81\">foysal</option>\r\n                                \r\n                                <option value=\"217\">geralt</option>\r\n                                \r\n                                <option value=\"110\">hannes</option>\r\n                                \r\n                                <option value=\"118\">jim</option>\r\n                                \r\n                                <option value=\"156\">lucie</option>\r\n                                \r\n                                <option value=\"106\">noman</option>\r\n                                \r\n                                <option value=\"157\">peta</option>\r\n                                \r\n                                <option value=\"232\">RESTRICTED</option>\r\n                                \r\n                                <option value=\"124\">safiqul</option>\r\n                                \r\n                                <option value=\"107\">samir</option>\r\n                                \r\n                                <option value=\"233\">Selenium</option>\r\n                                \r\n                                <option value=\"219\">silja</option>\r\n                                \r\n                                <option value=\"114\">Simo</option>\r\n                                \r\n                                <option value=\"168\">solid</option>\r\n                                \r\n                                <option value=\"160\">strom</option>\r\n                                \r\n                                <option value=\"80\">syedi</option>\r\n                                \r\n                            </select>\r\n                        </td>\r\n                        <td width=\"15%\" align=\"left\">\r\n                            <select id=\"invoice_statuses\" multiple=\"multiple\" size=\"3\" onchange=\"berlin3.invoices.filter_invoice(this);\" class=\"box\" style=\"margin-right:10px; width: 100%;\">\r\n                                \r\n                                <option value=\"07f300\">Paid</option>\r\n                                \r\n                                <option value=\"fffe00\">Open</option>\r\n                                \r\n                                <option value=\"0000ff\">Partly Paid</option>\r\n                                \r\n                                <option value=\"fd5b2c\">Due</option>\r\n                                \r\n                                <option value=\"ca0005\">Overdue</option>\r\n                                \r\n                                <option value=\"666666\">Cancelled</option>\r\n                                \r\n                                <option value=\"000000\">Bad Debt</option>\r\n                                \r\n                            </select>\r\n                            <!-- <div id=\"invoice_status_color\" style=\"float:right;width:10px;height:10px;background-color:#ffffff;border:1px solid #000;margin-top: 3px;\"></div>  -->\r\n                         </td>\r\n                         <td width=\"11%\">\r\n                         </td>\r\n                    </tr>\r\n                </table>\r\n            </div>\r\n\r\n        \t<div class=\"hdiv\"><span class=\"htext\" style=\"width:18%;\">Invoice No. </span><span class=\"htext\" style=\"width:9%;\">Sender</span><span class=\"htext\" style=\"width:9%;\">Date</span><span class=\"htext\" style=\"width:15%;\">Recipient</span><span class=\"htext\" style=\"width:20%;\">Description</span><span class=\"htext tright\" style=\"width:8%;\">Amount</span><span class=\"htext\" style=\"width:4.5%;padding-left:2.5%;\">Status</span><span class=\"htext\" style=\"width:3%;padding-left:1%;\">&nbsp;</span><span class=\"htext tright\" style=\"width:10%;\"><a href=\"#\" onclick=\"displayMessage('accounting.pl?section=invoices&action=modal_new_invoice',400,100);\"><img src=\"/images/newimg/Plus.png\"/></a></span></div>\r\n             <div id=\"invoices_table_container\" class=\"h00\" style=\"height:410px;margin-bottom:5px;\" onscroll=\"berlin3.invoices.scrollInvoices();\"></div>\r\n\r\n\r\n\r\n             <div style=\"padding:5px;\">\r\n\t\t\t\t<span class=\"column\" style=\"width:18%;\">\r\n\t\t\t\t\t<input type=\"button\" id=\"refresh_invoice_list\" value=\"Refresh\" />\r\n\t\t\t\t</span>\r\n\t\t\t\t<span class=\"rcolumn\" style=\"width:80%;\">\r\n                \r\n                <span style=\"display:inline-block;width:10px;height:10px;background-color:#07f300;border:1px solid #000;\"></span> <span style=\"display:inline-block;line-height:12px;margin-right:20px;vertical-align:top;\">Paid</span>\r\n                \r\n                <span style=\"display:inline-block;width:10px;height:10px;background-color:#fffe00;border:1px solid #000;\"></span> <span style=\"display:inline-block;line-height:12px;margin-right:20px;vertical-align:top;\">Open</span>\r\n                \r\n                <span style=\"display:inline-block;width:10px;height:10px;background-color:#0000ff;border:1px solid #000;\"></span> <span style=\"display:inline-block;line-height:12px;margin-right:20px;vertical-align:top;\">Partly Paid</span>\r\n                \r\n                <span style=\"display:inline-block;width:10px;height:10px;background-color:#fd5b2c;border:1px solid #000;\"></span> <span style=\"display:inline-block;line-height:12px;margin-right:20px;vertical-align:top;\">Due</span>\r\n                \r\n                <span style=\"display:inline-block;width:10px;height:10px;background-color:#ca0005;border:1px solid #000;\"></span> <span style=\"display:inline-block;line-height:12px;margin-right:20px;vertical-align:top;\">Overdue</span>\r\n                \r\n                <span style=\"display:inline-block;width:10px;height:10px;background-color:#666666;border:1px solid #000;\"></span> <span style=\"display:inline-block;line-height:12px;margin-right:20px;vertical-align:top;\">Cancelled</span>\r\n                \r\n                <span style=\"display:inline-block;width:10px;height:10px;background-color:#000000;border:1px solid #000;\"></span> <span style=\"display:inline-block;line-height:12px;margin-right:20px;vertical-align:top;\">Bad Debt</span>\r\n                \r\n\t\t\t\t</span>\r\n             </div>\r\n        </div>\r\n</div>\r\n<!-- -------------------------------------------------- TEMPLATE ---------------------------------------------- -->\r\n<div id=\"invoices_templates\" class=\"dnone\">\r\n\t<!-- ---------------------------------------- invoice row ------------------------------------------- -->\r\n\t<div id=\"invoice_row_template\">\r\n        <div class=\"row\" id=\"invoiceRow_{invoice_id}\">\r\n        \t<span class=\"column top\" style=\"width:18%;\"><a href=\"#\" invoice_id=\"{invoice_id}\" class=\"open-invoice\">{invoice_ref}</a></span>\r\n            <span class=\"column top\" style=\"width:9%;\">{invoice_project_name}</span>\r\n            <span class=\"column top\" style=\"width:9%;\">{invoice_date}</span>\r\n            <span class=\"column top\" style=\"width:15%;\" invoice_id=\"{invoice_id}\"><a href=\"#\" onclick=\"active_contact('{name}','{contact_id}','{invoice_contact_type}');\">{name}</a></span>\r\n            <span class=\"column top\" style=\"width:20%;\">{subject}</span>\r\n            <span class=\"rcolumn top\" style=\"width:6.5%;padding-right:0.5%;\">{gross_amount_cc}</span>\r\n            <span class=\"column top\" style=\"width:3%;\">{currency_iso}</span>\r\n            <span class=\"rcolumn top\" style=\"width:2%;padding-left:2%;\">\r\n            \t<div class=\"invoice-status-div\" invoice_id=\"{invoice_id}\" style=\"width:10px;height:10px;background-color:{color};border:1px solid #000;\"></div>\r\n            </span>\r\n            <span class=\"rcolumn top\" style=\"width:2%;\"><a href=\"#\"><img style=\"display: none;\" invoice_id=\"{invoice_id}\" class=\"forward-icon-{artist_invoice_forward_count} forwarding-icon\" height=\"16\" src=\"/images/newimg/fast_forward-24px.svg\" onmouseover=\"berlin3.invoices.onInvoiceForwardingIconMouseHover(this, event)\" onmouseout=\"berlin3.invoices.onInvoiceForwardingIconMouseout(this, event)\" /></a></span>\r\n            <span class=\"rcolumn top\" style=\"width:3%;\"><a href=\"#\"><img src=\"/images/newimg/Mail.png\" class=\"invoice-email\" invoice_id=\"{invoice_id}\" paypal_email=\"{paypal_email}\" email=\"{invoice_contact_email}\" /></a></span>\r\n\r\n            <span class=\"rcolumn top\" style=\"width:3%;\"><a href=\"javascript:void(0);\"><img src=\"/images/newimg/Printer.png\" class=\"print-invoice\" lockedUnlockedObj=\"#invoiceListLockedUnlocked_{invoice_id}\" invoice_id=\"{invoice_id}\" /></a></span>\r\n            <span class=\"rcolumn top\" style=\"width:3%;\">\r\n                <a href=\"javascript:void(0)\"><img src=\"/images/newimg/Edit.png\" invoice_id=\"{invoice_id}\" onclick=\"berlin3.invoices.openInvoiceFlagChangeModal(this);\" invoice_id=\"{invoice_id}\" /></a>\r\n            </span>\r\n            <!--span class=\"rcolumn top\" style=\"width:3%;\"><a href=\"#\"><img src=\"/images/newimg/Cancel.png\" class=\"delete-invoice\" invoice_id=\"{invoice_id}\" /></a></span-->\r\n            <span class=\"rcolumn top\" style=\"width:3%;\"><a href=\"javascript:void(0);\">{lock_flag_image}</a></span>\r\n        </div>\r\n    </div>\r\n    <!-- -------------------------------------------- Currency ------------------------------------------- -->\r\n\t<div id=\"currency_list\">\r\n    \t<select>\r\n        \t<option></option>\r\n            \r\n            <option value=\"11\" exchange_rate=\"1.4553\">CAD</option>\r\n            \r\n            <option value=\"12\" exchange_rate=\"0.9554\">CHF</option>\r\n            \r\n            <option value=\"10\" exchange_rate=\"7.4527\">DKK</option>\r\n            \r\n            <option value=\"1\" exchange_rate=\"1\">EUR</option>\r\n            \r\n            <option value=\"23\" exchange_rate=\"100\">GAL</option>\r\n            \r\n            <option value=\"3\" exchange_rate=\"0.8556\">GBP</option>\r\n            \r\n            <option value=\"14\" exchange_rate=\"8.5865\">HKD</option>\r\n            \r\n            <option value=\"18\" exchange_rate=\"4.0717\">ILS</option>\r\n            \r\n            <option value=\"17\" exchange_rate=\"90.501\">INR</option>\r\n            \r\n            <option value=\"4\" exchange_rate=\"153.35\">JPY</option>\r\n            \r\n            <option value=\"7\" exchange_rate=\"18.3975\">MXN</option>\r\n            \r\n            <option value=\"9\" exchange_rate=\"11.168\">NOK</option>\r\n            \r\n            <option value=\"6\" exchange_rate=\"1.7855\">NZD</option>\r\n            \r\n            <option value=\"19\" exchange_rate=\"73.4773\">RUR</option>\r\n            \r\n            <option value=\"8\" exchange_rate=\"11.5545\">SEK</option>\r\n            \r\n            <option value=\"13\" exchange_rate=\"1.4653\">SGD</option>\r\n            \r\n            <option value=\"21\" exchange_rate=\"29.6771\">TRY</option>\r\n            \r\n            <option value=\"15\" exchange_rate=\"35.661\">TWD</option>\r\n            \r\n            <option value=\"2\" exchange_rate=\"1.101\">USD</option>\r\n            \r\n            <option value=\"22\" exchange_rate=\"26765\">VND</option>\r\n            \r\n            <option value=\"16\" exchange_rate=\"19.4309\">ZAR</option>\r\n            \r\n        </select>\r\n    </div>\r\n    <!-- -------------------------------------- invoice forwarding div -------------------------------------- -->\r\n    <div id=\"invoice_forwarding_tpl\">\r\n    \t<div style=\"float:right;width:78%;\">\r\n            {agent_html}{artist_html}\r\n        </div>\r\n        <div style=\"width:20%;\">\r\n        \t<div class=\"hdiv\" style=\"margin-top:5px;\">\r\n            \t<span class=\"htext\">Deal Memo (internal)</span>\r\n            </div>\r\n        \t<div class=\"h00\" style=\"height:395px;\">\r\n            \t<textarea class=\"box\" style=\"height:385px;width:95%;\" calendar_date_id=\"{calendar_date_id}\" onblur=\"berlin3.invoices.msgHandler('save_first_offer_notes', this);\">{first_offer_notes}</textarea>\r\n            </div>\r\n        </div>\r\n    </div>\r\n\r\n    <!---------------------------------------- invoice forwarding div2 ---------------------------------------->\r\n    <div id=\"invoice_forwarding_tpl2\">\r\n    \t<div>\r\n            {agent_html}{artist_html}\r\n        </div>\r\n    </div>\r\n    <!---------------------------------------- invoice forwarding invoice lines div ---------------------------------------->\r\n    <div id=\"invoice_forwarding_invoice_lines_div_tpl\">\r\n    \t<div class=\"hdiv\" style=\"margin-top: 5px;\">\r\n        \t<span class=\"htext column\" style=\"width:50%;\">Description</span>\r\n            <span class=\"htext column\" style=\"width:15%;\">Price</span>\r\n            <span class=\"htext column\" style=\"width:24%;\">Amount</span>\r\n            <span class=\"htext rcolumn\" style=\"width:10%;\">VAT</span>\r\n        </div>\r\n        <div class=\"h00 invoice-lines-list\" invoice_id=\"{invoice_id}\" style=\"height:170px;\">{invoicelines}</div>\r\n        <div style=\"height: 40px;\">\r\n            <div class=\"fl w50 mt10\" style=\"margin-left: 5px;\">\r\n                <div>\r\n                    <span style=\"display:inline-block;width:10px;height:10px;background-color:{invoice_status_color};border:1px solid #000;\"></span>\r\n                    <span style=\"display:inline-block;line-height:12px;vertical-align:top;padding-left: 3px;\">{invoice_status_description}</span>\r\n                </div>\r\n                <div><em>{fully_paid_on}</em></div>\r\n            </div>\r\n            <div class=\"fr w50\">\r\n                <table class=\"MainTable\">\r\n                    <thead>\r\n                        <tr>\r\n                            <th>&nbsp;</th>\r\n                            <th align=\"left\">{invoice_currency_iso}</th>\r\n                            <th align=\"left\">{client_currency_iso}</th>\r\n                        </tr>\r\n                    </thead>\r\n                    <tbody>\r\n                        <tr>\r\n                            <td class=\"tda\">Net Amount</td>\r\n                            <td class=\"tdb\">{net_amount}</td>\r\n                            <td class=\"tdb\">{net_amount_default_currency}</td>\r\n                        </tr>                        \r\n                        <tr>\r\n                            <td>Gross Amount</td>\r\n                            <td>{gross_amount}</td>\r\n                            <td>{gross_amount_default_currency}</td>\r\n                        </tr>\r\n                    </tbody>\r\n                </table>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <!---------------------------------------- invoice forwarding invoice lines row ---------------------------------------->\r\n    <div id=\"invoice_forwarding_invoice_lines_row_tpl\">\r\n    \t<div class=\"row\">\r\n        \t<span class=\"column\" style=\"width:50%;\"><textarea type=\"text\" class=\"text mtext disabled\" style=\"width: 97%;height:15px;\" disabled=\"disabled\">{text}</textarea></span>\r\n            <span class=\"column\" style=\"width:15%;\"><input type=\"text\" value=\"{price}\" class=\"text mtext disabled\" style=\"text-align:right;\" disabled=\"disabled\" /></span>\r\n            <!-- <span class=\"column\" style=\"width:25%;\"><input id=\"total_\" type=\"text\" class=\"text mtext \"  value=\"0.00\" style=\"text-align:right; border: medium none; background-color: #eee;\" readonly=\"readonly\" /></span> -->\r\n            <span class=\"column\" style=\"width:24%;\"><input type=\"text\" class=\"text mtext\" value=\"{computed_total}\" readonly=\"readonly\" /></span>\r\n            <span class=\"rcolumn\" style=\"width:10%;\">{computed_vat}</span>\r\n            \r\n        </div>\r\n    </div>\r\n    <!---------------------------------------- artist forwarding div ---------------------------------------->\r\n    <div id=\"artist_forwarding_div_tpl\">\r\n    \t<div class=\"hdiv\" style=\"margin-top: 5px; clear: both;\">\r\n        \t<span class=\"htext column\" style=\"width:11%;\">Artist</span>\r\n            <span class=\"htext column\" style=\"width:15%;\">Recipient</span>\r\n            <span class=\"htext column\" style=\"width:25%;\">Notes</span>\r\n            <span class=\"htext column\" style=\"width:12%;\">Amount</span>\r\n            <span class=\"htext column\" style=\"width:8%;\">Currency</span>\r\n            <span class=\"htext column\" style=\"width:16%;\">Exchange Rate</span>\r\n            <span class=\"htext column\" style=\"width:7%;\">EUR</span>\r\n            <span class=\"rcolumn\" style=\"width:6%;\">\r\n            \t<a href=\"#\"><img src=\"/images/newimg/Plus.png\" class=\"add-artist-forwarding\" invoice_id=\"{invoice_id}\" /></a>\r\n            </span>\r\n        </div>\r\n        <div class=\"h00 artist-forwarding-list\" invoice_id=\"{invoice_id}\" style=\"height:170px;\">{artist_payments_html}</div>\r\n        <div style=\"margin:5px 0px 10px 0px;\">\r\n            <span class=\"column\" style=\"width:50%;\">\r\n                <input id=\"forward_completed_flag_{invoice_id}\" type=\"checkbox\" {forward_completed_flag_checked_attr} value=\"{forward_completed_flag}\" key=\"invoice_id\" keyval=\"{invoice_id}\" column=\"forward_completed_flag\" last_modified=\"{last_modified}\" oldval=\"{forward_completed_flag}\" onclick=\"this.value = this.checked ? 1 : 0;BERLIN3.common.updateData(this);\" />\r\n                <img style=\"margin-right: 0px;\" height=\"16\" src=\"/images/newimg/fast_forward-24px.svg\"> Forwarding Completed\r\n            </span>\r\n        \t<span class=\"rcolumn\" style=\"width:30%;\">Total Artist</span>\r\n            <span class=\"rcolumn total-artist\" style=\"width:10%;\" invoice_id={invoice_id}></span>\r\n        </div>\r\n    </div>\r\n    <!---------------------------------------- artist forwarding row ---------------------------------------->\r\n    <div id=\"artist_forwarding_tpl\">\r\n    \t<div class=\"row\">\r\n        \t<span class=\"column\" style=\"width:10%;\"><input type=\"text\" class=\"box\" style=\"width: 90%;\" value=\"{date}\" key=\"payment_id\" key_val=\"{payment_id}\" field=\"date\" onblur=\"berlin3.invoices.msgHandler('save_payment_field', this);\" onclick=\"berlin3.invoices.msgHandler('pick_date', this);\" /></span>\r\n            <span class=\"column\" style=\"width:15%; overflow:visible;\">\r\n                <div class=\"dropdown\">\r\n                    <input type=\"text\" class=\"box\" style=\"width: 90%\" value=\"{recipient}\" key=\"payment_id\" key_val=\"{payment_id}\" field=\"recipient\" onblur=\"berlin3.invoices.msgHandler('save_payment_field', this);\" />\r\n                    {cdaDropdownContent}\r\n                </div>\r\n            </span>\r\n            <span class=\"column\" style=\"width:25%;\"><input type=\"text\" class=\"box\" style=\"width:90%;\" value=\"{notes}\" key=\"payment_id\" key_val=\"{payment_id}\" field=\"notes\" onblur=\"berlin3.invoices.msgHandler('save_payment_field', this);\" /></span>\r\n            <span class=\"rcolumn\" style=\"width:10%;\"><input type=\"text\" class=\"box\" style=\"width: 80%;text-align:right;\" value=\"{amount}\" key=\"payment_id\" key_val=\"{payment_id}\" field=\"amount\" onblur=\"berlin3.invoices.msgHandler('save_payment_field', this);\" onkeyup=\"berlin3.invoices.msgHandler('artist_exchangerate_calculation', this);\" /></span>\r\n            <span class=\"rcolumn\" style=\"width:10%;\">{currencies}</span>\r\n            <span class=\"rcolumn\" style=\"width:10%;\"><input type=\"text\" class=\"box\" style=\"width: 90%;text-align:right;\" value=\"{exchangerate}\" key=\"payment_id\" key_val=\"{payment_id}\" field=\"exchangerate\" onblur=\"berlin3.invoices.msgHandler('save_payment_field', this);\" onkeyup=\"berlin3.invoices.msgHandler('artist_exchangerate_calculation', this);\" /></span>\r\n            <span class=\"rcolumn sys-cur-calculation-artist\" style=\"width:10%;\" payment_id=\"{payment_id}\" invoice_id=\"{invoice_id}\">{sys_cur_val}</span>\r\n            <span class=\"rcolumn\" style=\"width:10%;\"><a href=\"#\"><img src=\"/images/newimg/Cancel.png\" payment_id=\"{payment_id}\" invoice_id=\"{invoice_id}\" class=\"remove-payment\" /></a></span>\r\n        </div>\r\n    </div>\r\n    <!---------------------------------------- agent forwarding div ---------------------------------------->\r\n    <div id=\"agent_forwarding_div_tpl\">\r\n    \t<div class=\"hdiv\">\r\n        \t<span class=\"htext column\" style=\"width:10%;\">User</span>\r\n            <span class=\"htext column\" style=\"width:15%;\">Recipient</span>\r\n            <span class=\"htext column\" style=\"width:24%;\">Notes</span>\r\n            <span class=\"htext rcolumn\" style=\"width:10%;\">Amount</span>\r\n            <span class=\"htext rcolumn\" style=\"width:10%;\">Currency</span>\r\n            <span class=\"htext rcolumn\" style=\"width:10%;\">Exchange Rate</span>\r\n            <span class=\"htext rcolumn\" style=\"width:10%;\">EUR</span>\r\n            <span class=\"rcolumn\" style=\"width:11%;\">\r\n            \t<a href=\"#\"><img src=\"/images/newimg/Plus.png\" class=\"add-agent-forwarding\" invoice_id=\"{invoice_id}\" /></a>\r\n            </span>\r\n        </div>\r\n        <div class=\"h00 agent-forwarding-list\" invoice_id=\"{invoice_id}\" style=\"height:170px;\">{agent_payments_html}</div>\r\n        <div style=\"margin-top:5px;\">\r\n        \t<span class=\"rcolumn\" style=\"width:80%;\">Total Agent</span>\r\n            <span class=\"rcolumn total-agent\" style=\"width:10%;\" invoice_id={invoice_id}></span>\r\n        </div>\r\n    </div>\r\n    <!---------------------------------------- agent forwarding row ---------------------------------------->\r\n    <div id=\"agent_forwarding_tpl\">\r\n    \t<div class=\"row\">\r\n        \t<span class=\"column\" style=\"width:10%;\"><input type=\"text\" class=\"box\" style=\"width: 90%;\" value=\"{date}\" key=\"payment_id\" key_val=\"{payment_id}\" field=\"date\" onblur=\"berlin3.invoices.msgHandler('save_payment_field', this);\" onclick=\"berlin3.invoices.msgHandler('pick_date', this);\" /></span>\r\n            <span class=\"column\" style=\"width:15%;\"><input type=\"text\" class=\"box\" style=\"width: 90%\" value=\"{recipient}\" key=\"payment_id\" key_val=\"{payment_id}\" field=\"recipient\" onblur=\"berlin3.invoices.msgHandler('save_payment_field', this);\" /></span>\r\n            <span class=\"column\" style=\"width:25%;\"><input type=\"text\" class=\"box\" style=\"width:90%;\" value=\"{notes}\" key=\"payment_id\" key_val=\"{payment_id}\" field=\"notes\" onblur=\"berlin3.invoices.msgHandler('save_payment_field', this);\" /></span>\r\n            <span class=\"rcolumn\" style=\"width:10%;\"><input type=\"text\" class=\"box\" style=\"width: 80%;text-align:right;\" value=\"{amount}\" key=\"payment_id\" key_val=\"{payment_id}\" field=\"amount\" onblur=\"berlin3.invoices.msgHandler('save_payment_field', this);\" onkeyup=\"berlin3.invoices.msgHandler('agent_exchangerate_calculation', this);\" /></span>\r\n            <span class=\"rcolumn\" style=\"width:10%;\">{currencies}</span>\r\n            <span class=\"rcolumn\" style=\"width:10%;\"><input type=\"text\" class=\"box\" style=\"width: 90%;text-align:right;\" value=\"{exchangerate}\" key=\"payment_id\" key_val=\"{payment_id}\" field=\"exchangerate\" onblur=\"berlin3.invoices.msgHandler('save_payment_field', this);\" onkeyup=\"berlin3.invoices.msgHandler('agent_exchangerate_calculation', this);\" /></span>\r\n            <span class=\"rcolumn sys-cur-calculation-agent\" style=\"width:10%;\" payment_id=\"{payment_id}\" invoice_id=\"{invoice_id}\">{sys_cur_val}</span>\r\n            <span class=\"rcolumn\" style=\"width:10%;\"><a href=\"#\"><img src=\"/images/newimg/Cancel.png\" payment_id=\"{payment_id}\" invoice_id=\"{invoice_id}\" class=\"remove-payment\" /></a></span>\r\n        </div>\r\n    </div>\r\n\r\n    <!-- -------------------------------------- Related Royalty Period rows -------------------------------------- -->\r\n    <div id=\"tpl_modal_on_delete_cancel_invoice_related_with_royaltyperiod\">\r\n\r\n        <div class=\"mb10\" style=\"text-align:center;font-size:1.4em;font-weight:bold;\">\r\n            Invoice cannot be deleted / cancelled because of Related Royalties.\r\n        </div>\r\n\r\n        <div id=\"invoice_related_with_royaltyperiod_header_{invoice_id}\" class=\"hdiv\" style=\"margin-top:5px;\">\r\n            <span class=\"htext fchild\" style=\"width:50%;\">Royalty Accounts</span>\r\n            <span class=\"htext child\" style=\"width:23%;\">Start Date</span>\r\n            <span class=\"htext child\" style=\"width:20%;\">End Date</span>\r\n        </div>\r\n\r\n        <div id=\"invoice_related_with_royaltyperiod_rows_{invoice_id}\" class=\"h300 mb10\" style=\"\" invoice_id=\"{invoice_id}\" onscroll=\"berlin3.invoices.scrollRelatedRoyaltyPeriodOnDCModal(this);\">\r\n        </div>\r\n        <div class=\"modalButtons\">\r\n            <span class=\"right\">\r\n                <input type=\"button\" value=\"Cancel\" onclick=\"closeMessage();\" />\r\n            </span>\r\n        </div>\r\n    </div>\r\n\r\n    <!-- -------------------------------------- Related Royalty Period rows -------------------------------------- -->\r\n    <div id=\"tpl_related_royalty_period_row\">\r\n        <div class=\"row\">\r\n            <span class=\"column\" style=\"width:50%;\">\r\n                <!--a href=\"javascript:void(0);\" royalty_account_id=\"{royalty_account_id}\" onclick=\"\"-->{royalty_account_name}<!--/a-->\r\n            </span>\r\n            <span class=\"column\" style=\"width:23%;\">{start_date}</span>\r\n            <span class=\"column\" style=\"width:20%;\">{end_date}</span>\r\n        </div>\r\n    </div>\r\n\r\n    <!-- -------------------------------------- openInvoiceFlagChangeModal -------------------------------------- -->\r\n    <div id=\"tpl_invoiceFlagChangeModal\">\r\n        <div id=\"invoiceFlagChangeModal_{invoice_id}\">\r\n            <div class=\"hdiv\">\r\n                <span class=\"htext\">Invoice Status</span>\r\n            </div>\r\n\r\n            <div style=\"margin-top:5px;\">\r\n                <span class=\"rcolumn\" style=\"width:25%; padding-right:5px;\">Date:</span>\r\n                <span class=\"column\" style=\"width:73%;\">{invoice_date}</span>\r\n            </div>\r\n            <div style=\"margin-top:5px;\">\r\n                <span class=\"rcolumn\" style=\"width:25%; padding-right:5px;\">Details:</span>\r\n                <span class=\"column\" style=\"width:73%;\">{invoice_ref}</span>\r\n            </div>\r\n            <div style=\"margin-top:5px;\">\r\n                <span class=\"rcolumn\" style=\"width:25%; padding-right:5px;\">Amount:</span>\r\n                <span class=\"column\" style=\"width:73%;\">{amount} {currency_iso}</span>\r\n            </div>\r\n            <div style=\"margin-top:5px;\">\r\n                <span class=\"rcolumn\" style=\"width:25%; padding-right:5px;\">Paid:</span>\r\n                <span class=\"column\" style=\"width:73%;\" id=\"total_payment\">{paidAmounts}</span>\r\n            </div>\r\n\r\n            <div style=\"margin-top:10px;\" class=\"{displaySetFullyPaid}\">\r\n                <span class=\"ccolumn\" style=\"width:100%;\">\r\n                    <input type=\"button\" style=\"width: 80%;\" value=\"Set Fully Paid\" invoice_id=\"{invoice_id}\" lock_flag=\"{lock_flag}\" fullOrPartial=\"3\" onclick=\"berlin3.invoices.displayPaidModal(this);\" />\r\n                </span>\r\n            </div>\r\n\r\n            <div style=\"margin-top:10px;\" class=\"{displaySetPartiallyPaid}\">\r\n                <span class=\"ccolumn\" style=\"width:100%;\">\r\n                    <input type=\"button\" style=\"width: 80%;\" value=\"Set Partly Paid\" invoice_id=\"{invoice_id}\" lock_flag=\"{lock_flag}\" fullOrPartial=\"2\" onclick=\"berlin3.invoices.displayPaidModal(this);\" />\r\n                </span>\r\n            </div>\r\n\r\n            <div style=\"margin-top:10px;\" class=\"{displayCreateCreditNote}\">\r\n                <span class=\"ccolumn\" style=\"width:100%;\">\r\n                    <input type=\"button\" style=\"width: 80%;\" value=\"Create Credit Note\" invoice_id=\"{invoice_id}\" invoice_project_id=\"{invoice_project_id}\" onclick=\"berlin3.invoices.displayCreateCreditNoteModal(this);\" />\r\n                </span>\r\n            </div>\r\n\r\n            <div style=\"margin-top:10px;\" class=\"{displayDeletePaymentsOpen}\">\r\n                <span class=\"ccolumn\" style=\"width:100%;\">\r\n                    <input type=\"button\" style=\"width: 80%;\" value=\"Delete Payments and Set open\" invoice_id=\"{invoice_id}\" onclick=\"berlin3.invoices.deleteInvoicePaymentsSetOpen(this);\" />\r\n                </span>\r\n            </div>\r\n\r\n            <div style=\"margin-top:10px;\" class=\"{displayCancelInvoice}\">\r\n                <span class=\"ccolumn\" style=\"width:100%;\">\r\n                    <input type=\"button\" class=\"delete\" style=\"width: 80%;\" value=\"Cancel Invoice\" task=\"cancel\" invoice_id=\"{invoice_id}\" onclick=\"berlin3.invoices.invoiceCancelDeletePreChecking(this);\" />\r\n                </span>\r\n            </div>\r\n\r\n            <div style=\"margin-top:10px;\" class=\"{displaySetBadDept}\">\r\n                <span class=\"ccolumn\" style=\"width:100%;\">\r\n                    <input type=\"button\" class=\"delete\" style=\"width: 80%;\" value=\"Set Bad Debt\" invoice_id=\"{invoice_id}\" onclick=\"berlin3.invoices.setInvoiceToBadDept(this);\" />\r\n                </span>\r\n            </div>\r\n\r\n            <div style=\"margin-top:10px;\" class=\"{displayDeleteInvoice}\">\r\n                <span class=\"ccolumn\" style=\"width:100%;\">\r\n                    <input type=\"button\" class=\"delete\" style=\"width: 80%;\" value=\"Delete Invoice\" task=\"delete\" invoice_id=\"{invoice_id}\" onclick=\"berlin3.invoices.invoiceCancelDeletePreChecking(this);\" />\r\n                </span>\r\n            </div>\r\n\r\n            <div style=\"margin-top:10px;\">\r\n                <span class=\"ccolumn\" style=\"width:100%;\">\r\n                    <input type=\"button\" class=\"close\" style=\"width: 80%;\" value=\"Cancel\" onclick=\"closeMessage();\" />\r\n                </span>\r\n            </div>\r\n        </div>\r\n\r\n    </div>\r\n    <!-- -------------------------------------- openInvoiceFlagChangeModal -------------------------------------- -->\r\n\r\n    <!-- -------------------------------------- displayPaidModal -------------------------------------- -->\r\n    <div id=\"tpl_displayPaidModal\">\r\n        <div id=\"displayPaidModal_{invoice_id}\">\r\n\r\n            <div class=\"hdiv\">\r\n                <span class=\"htext\">Invoice Status</span>\r\n            </div>\r\n\r\n            <div style=\"margin-top:5px;\">\r\n                <span class=\"rcolumn\" style=\"width:25%; padding-right:5px;\">Date:</span>\r\n                <span class=\"column\" style=\"width:73%;\">{invoice_date}</span>\r\n            </div>\r\n            <div style=\"margin-top:5px;\">\r\n                <span class=\"rcolumn\" style=\"width:25%; padding-right:5px;\">Details:</span>\r\n                <span class=\"column\" style=\"width:73%;\">{invoice_ref}</span>\r\n            </div>\r\n            <div style=\"margin-top:5px;\">\r\n                <span class=\"rcolumn\" style=\"width:25%; padding-right:5px;\">Amount:</span>\r\n                <span class=\"column\" style=\"width:73%;\">{amount} {currency_iso}</span>\r\n            </div>\r\n            <!-- display it only if number of payments is 1 or 0 -->\r\n            <div style=\"margin-top:5px;\" class=\"{displayOnePayment}\">\r\n                <span class=\"rcolumn\" style=\"width:25%; padding-right:5px;\">Paid:</span>\r\n                <span class=\"column\" style=\"width:73%;\">{paymentsHtml}</span>\r\n            </div>\r\n\r\n            <!-- display it only if number of payments more than 1 -->\r\n            <div style=\"margin-top:10px; border-top:1px solid #ccc; border-bottom:1px solid #ccc; max-height: 80px; overflow: auto;\" class=\"{displayPaymentList}\">{paymentsHtml}</div>\r\n            <div class=\"{displayPaymentList}\"><div class=\"\"><span style=\"width:100%;\" class=\"rcolumn\">{totalPaymentByExRate} {sys_currency_iso}</span></div></div>\r\n\r\n            <div style=\"margin-top:10px;\">\r\n\r\n                <div style=\"margin-top:5px;\">\r\n                    <span class=\"rcolumn\" style=\"width:25%; padding-right:5px;\">Date:</span>\r\n                    <span class=\"column\" style=\"width:73%;\">\r\n                        <input id=\"date\" type=\"text\" class=\"required\" style=\"width: 50%;\" value=\"{today}\" onfocus=\"pickDay(this,this);\" onclick=\"pickDay(this,this);\" />\r\n                    </span>\r\n                </div>\r\n                <div style=\"margin-top:5px;\">\r\n                    <span class=\"rcolumn\" style=\"width:25%; padding-right:5px;\">Amount:</span>\r\n                    <span class=\"column\" style=\"width:73%;\"><input id=\"amount\" type=\"text\" class=\"required\" style=\"width: 50%;\" value=\"{gross_amount_cc}\" /></span>\r\n                </div>\r\n                <div style=\"margin-top:5px;\">\r\n                    <span class=\"rcolumn\" style=\"width:25%; padding-right:5px;\">Currency:</span>\r\n                    <span class=\"column\" style=\"width:73%;\">{currencies_list}</span>\r\n                </div>\r\n                <div style=\"margin-top:5px;\" class=\"{displayExrate}\" id=\"exRateFieldGourp\">\r\n                    <span class=\"rcolumn\" style=\"width:25%; padding-right:5px;\">Exchange Rate:</span>\r\n                    <span class=\"column\" style=\"width:73%;\"><input style=\"width: 50%;\" type=\"text\" id=\"exchangerate\" value=\"{sys_currency_exrate}\" /></span>\r\n                </div>\r\n\r\n                <div style=\"margin-top:5px;\">\r\n                    <span class=\"rcolumn\" style=\"width:25%; padding-right:5px;\">Money Account:</span>\r\n                    <span class=\"column\" style=\"width:73%;\">\r\n                        <select id=\"money_account_id\" style=\"width: 53%;\">\r\n                            <option value=\"\"></option>\r\n                            {moneyAccountOptions}\r\n                        </select>\r\n                    </span>\r\n                </div>\r\n\r\n            </div>\r\n\r\n            <div style=\"margin-top:10px;\" class=\"{displaySetFullyPaid}\">\r\n                <span class=\"ccolumn\" style=\"width:100%;\">\r\n                    <input type=\"button\" style=\"width: 80%;\" value=\"Set Fully Paid\" invoice_id=\"{invoice_id}\" lock_flag=\"{lock_flag}\" fullOrPartial=\"3\" onclick=\"berlin3.invoices.checkCurrencyRateLimit(this);\" />\r\n                </span>\r\n            </div>\r\n\r\n            <div style=\"margin-top:10px;\" class=\"{displaySetPartiallyPaid}\">\r\n                <span class=\"ccolumn\" style=\"width:100%;\">\r\n                    <input type=\"button\" style=\"width: 80%;\" value=\"Set Partly Paid\" invoice_id=\"{invoice_id}\" lock_flag=\"{lock_flag}\" fullOrPartial=\"2\" onclick=\"berlin3.invoices.savePaidModalInfo(this);\" />\r\n                </span>\r\n            </div>\r\n\r\n            <div style=\"margin-top:10px;\">\r\n                <span class=\"ccolumn\" style=\"width:100%;\">\r\n                    <input type=\"button\" class=\"close\" style=\"width: 80%;\" value=\"Cancel\" onclick=\"closeMessage();\" />\r\n                </span>\r\n            </div>\r\n\r\n        </div>\r\n    </div>\r\n    <!-- -------------------------------------- displayPaidModal -------------------------------------- -->\r\n\r\n    <!-- -------------------------------------- paidModalPayments -------------------------------------- -->\r\n    <div id=\"tpl_paidModalPaymentRow\">\r\n\r\n        <div class=\"row\">\r\n            <span class=\"column\" style=\"width:60%;\">{date}</span>\r\n            <span class=\"rcolumn\" style=\"width:40%;\">{amount} {currency_iso} / {paymentByExRate} {sys_currency_iso}</span>\r\n        </div>\r\n\r\n    </div>\r\n    <!-- -------------------------------------- paidModalPayments -------------------------------------- -->\r\n\r\n    <!-- -------------------------------------- createCreditNoteNodal -------------------------------------- -->\r\n    <div id=\"tpl_displayCreateCreditNoteModal\">\r\n        <div id=\"displayCreateCreditNoteModal_{invoice_id}\">\r\n\r\n            <div class=\"hdiv\">\r\n                <span class=\"htext\">Select Invoice Project for Credit Note</span>\r\n            </div>\r\n\r\n            <div style=\"margin-top:5px;\">\r\n                <span class=\"rcolumn\" style=\"width:25%; padding-right:5px;\">Project:</span>\r\n                <span class=\"column\" style=\"width:73%;\">\r\n                    <select id=\"invoice_project_id\" class=\"required\" style=\"width: 53%;\">\r\n                        <option value=\"\"></option>\r\n                        {invioceProjectOptions}\r\n                    </select>\r\n                </span>\r\n            </div>\r\n\r\n            <div style=\"margin-top:10px;\">\r\n                <span class=\"rcolumn\" style=\"width:100%;\">\r\n                    <input type=\"button\" value=\"Create Credit Note\" invoice_id=\"{invoice_id}\" onclick=\"berlin3.invoices.createInvoiceCreditNote(this);\" />\r\n                    <input type=\"button\" class=\"close\" style=\"padding-left: 10px;\" value=\"Cancel\" onclick=\"closeMessage();\" />\r\n                </span>\r\n            </div>\r\n\r\n        </div>\r\n\r\n    </div>\r\n    <!-- -------------------------------------- createCreditNoteNodal -------------------------------------- -->\r\n\r\n\r\n    <!---------------------------    Select Options  ------------------------------------------>\r\n    <div id=\"tpl_option\">\r\n        <option value=\"{value}\" {selected}>{label}</option>\r\n    </div>\r\n\r\n\r\n\r\n\r\n\r\n</div>\r\n\r\n<!---------------------------    Invoice forwarding icon tooltip container   ------------------------------------------>\r\n<div class=\"forwardingTooltipContainer\" style=\"z-index: 10000; display: none; width: 400px; height: 150px;background-color: #fff;border: 2px solid #878787;padding:3px;overflow: auto;\">Tooltip text</div>\r\n\r\n<script type=\"text/javascript\">\r\nvar acc_inv_title = 'All Invoices';\r\n\r\n///////////////////////////////  accounting_invoice.js start here //////////////////////////////////////////////////////////////////////\r\n// JavaScript Document\r\nvar accountingInvoices = new DHTMLSuite.tabView();\r\naccountingInvoices.setParentId('accounting_invoices');\r\naccountingInvoices.setTabTitles(Array(acc_inv_title));\r\naccountingInvoices.setIndexActiveTab(0);\r\naccountingInvoices.setMaximumTabs(20);\r\naccountingInvoices.setHeight(520);\r\naccountingInvoices.init();\r\n\r\n\r\n\r\nvar accInvoiceObj = {\r\n\tinvoice_detail:function(title,invoice_id){\r\n\t\taccountingInvoices.createNewTab('accounting_invoices',title,'','accounting.pl?section=invoices&action=invoice_detail&invoice_id='+invoice_id,true);\r\n\t}\r\n};\r\n/*\r\nif(bookingInvoice.runtab == 1){\r\n\taccInvoiceObj.invoice_detail(bookingInvoice.title,bookingInvoice.invoice_id);\r\n\tbookingInvoice.runtab = 0;\r\n}\r\n*/\r\n//accInvoiceObj.invoice_list();\r\n\r\nfunction Invoice(){\r\n\tthis.loadInvoice = function(invoiceId){\r\n\t\tvar self = this;\r\n\t\t$.ajax('accounting.pl', {\r\n\t\t\tdata : {\r\n\t\t\t\tsection: 'invoices',\r\n\t\t\t\taction: 'invoice_data_as_json',\r\n\t\t\t\tinvoice_id: invoiceId\r\n\t\t\t},\r\n\t\t\tdataType : \"json\",\r\n\t\t\tasync : false,\r\n\t\t\tsuccess : function(data) {\r\n\t\t\t\tself.invoice = data;\r\n\t\t\t}\r\n\t\t});\r\n\t};\r\n\tthis.saveInvoice = function(keys,values){\r\n\t\tvar params = {\r\n\t\t\tmodify_type : 'record',\r\n\t\t\ttable : 'invoices',\r\n\t\t\tkVal : this.invoice.invoice_id,\r\n\r\n\t\t};\r\n\t\tfor(var i=0; i<keys.length; i++) {\r\n\t\t\tparams[keys[i]] = encodeURIComponent(values[i]);\r\n\t\t}\r\n\t\t$.ajax('modify.pl', {\r\n\t\t\tdata : params,\r\n\t\t\tasync : false\r\n\t\t});\r\n\t\tthis.loadInvoice(this.invoice.invoice_id);\r\n\t};\r\n\tthis.calculate = function(){\r\n\t\tthis.netAmountCC = 0;\r\n\t\tthis.vatAmountCC1 = 0;\r\n\t\tthis.vatAmountCC2 = 0;\r\n\t\tthis.vatAmountCC3 = 0;\r\n\t\tthis.paymentTotalCC = 0;\r\n\t\tthis.paymentTotalSC = 0;\r\n\t\tthis.invoicelines = Jemplate.JSON.parse(Jemplate.Ajax.get('accounting.pl?section=invoices&action=invoicelines_as_json&invoice_id='+this.invoice.invoice_id));\r\n\t\tthis.payments = Jemplate.JSON.parse(Jemplate.Ajax.get('accounting.pl?section=invoices&action=all_payments_as_json&invoice_id='+this.invoice.invoice_id));\r\n\r\n\t\tif(this.invoice.tax_type_id_deduction > 0){\r\n\t\t\tthis.tax_type = Jemplate.JSON.parse(Jemplate.Ajax.get('accounting.pl?section=invoices&action=tax_type_json&tax_type_id='+this.invoice.tax_type_id_deduction));\r\n\t\t\tfor(var i=0;i<this.invoicelines.length;i++){\r\n\t\t\t\tvar ppuTotal = Number(this.invoicelines[i].price) * (Number(this.invoicelines[i].qty) ? Number(this.invoicelines[i].qty) : 1);\r\n\t\t\t\tthis.netAmountCC += ppuTotal;\r\n\t\t\t}\r\n\t\t\tthis.vatAmountCC = this.netAmountCC * Number( this.tax_type.tax_rate_percent / 100 );\r\n\t\t}else if(this.invoice.vat_handling  == 1){\r\n\t\t\tfor(var i=0;i<this.invoicelines.length;i++){\r\n\t\t\t\tvar ppuTotal = Number(this.invoicelines[i].price) * (Number(this.invoicelines[i].qty) ? Number(this.invoicelines[i].qty) : 1);\r\n\t\t\t\tthis.netAmountCC += ppuTotal;\r\n\t\t\t\tif(this.invoicelines[i].vat_type == 1){\r\n\t\t\t\t\tthis.vatAmountCC1 += (ppuTotal * Number(this.invoice.vat_rate1 / 100));\r\n\t\t\t\t}else if(this.invoicelines[i].vat_type == 2){\r\n\t\t\t\t\tthis.vatAmountCC2 += (ppuTotal * Number(this.invoice.vat_rate2 / 100));\r\n\t\t\t\t}else if(this.invoicelines[i].vat_type == 3){\r\n\t\t\t\t\tthis.vatAmountCC3 += (ppuTotal * Number(this.invoice.vat_rate3 / 100));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.vatAmountCC = this.vatAmountCC1 + this.vatAmountCC2 + this.vatAmountCC3;\r\n\t\t}else if(this.invoice.vat_handling  == 2){\r\n\t\t\tfor(var i=0;i<this.invoicelines.length;i++){\r\n\t\t\t\tvar ppuTotal = Number(this.invoicelines[i].price) * (Number(this.invoicelines[i].qty) ? Number(this.invoicelines[i].qty) : 1);\r\n\t\t\t\tif(this.invoicelines[i].vat_type == 1){\r\n\t\t\t\t\tthis.vatAmountCC1 += (ppuTotal / (100 + Number(this.invoice.vat_rate1)) * Number(this.invoice.vat_rate1));\r\n\t\t\t\t\tthis.netAmountCC += (ppuTotal / (100 + Number(this.invoice.vat_rate1)) * 100);\r\n\t\t\t\t}else if(this.invoicelines[i].vat_type == 2){\r\n\t\t\t\t\tthis.vatAmountCC2 += (ppuTotal / (100 + Number(this.invoice.vat_rate2)) * Number(this.invoice.vat_rate2));\r\n\t\t\t\t\tthis.netAmountCC += (ppuTotal / (100 + Number(this.invoice.vat_rate2)) * 100);\r\n\t\t\t\t}else if(this.invoicelines[i].vat_type == 3){\r\n\t\t\t\t\tthis.vatAmountCC3 += (ppuTotal / (100 + Number(this.invoice.vat_rate3)) * Number(this.invoice.vat_rate3));\r\n\t\t\t\t\tthis.netAmountCC += (ppuTotal / (100 + Number(this.invoice.vat_rate3)) * 100);\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\t\t\tthis.vatAmountCC = this.vatAmountCC1 + this.vatAmountCC2 + this.vatAmountCC3;\r\n\t\t}else{\r\n\t\t\tfor(var i=0;i<this.invoicelines.length;i++){\r\n\t\t\t\tvar ppuTotal = Number(this.invoicelines[i].price) * (Number(this.invoicelines[i].qty) ? Number(this.invoicelines[i].qty) : 1);\r\n\t\t\t\tthis.netAmountCC += ppuTotal;\r\n\t\t\t}\r\n\t\t\tthis.vatAmountCC = 0;\r\n\t\t}\r\n\t\tthis.grossAmountCC = this.netAmountCC + this.vatAmountCC;\r\n\t\tthis.grossAmountSC = this.grossAmountCC / (Number(this.invoice.exchange_rate_creation) || Number(this.invoice.exchange_rate) || 1) ;\r\n\t\tfor(i=0;i<this.payments.length;i++){\r\n\t\t\tthis.paymentTotalCC += Number(this.payments[i].amount);\r\n\t\t\tthis.paymentTotalSC += (Number(this.payments[i].amount) / (Number(this.payments[i].exchangerate) || 1)) * Number(this.payments[i].debit_credit);\r\n\t\t}\r\n\t};\r\n\tthis.calculateStatus = function(){\r\n\t\tvar date1 = new Date(this.invoice.invoice_date ? this.invoice.invoice_date : '0000-00-00');\r\n\t\tvar day = date1.getDate() + Number(this.invoice.due_days);\r\n\t\tvar month = Number(date1.getMonth() + 1);\r\n\t\tvar year = date1.getFullYear();\r\n\t\tvar tmp = new Date(year+' '+month+' '+day);\r\n\t\tif(Number(this.invoice.end_of_month_flag) == 1){\r\n\t\t\tmonth = tmp.getMonth() + 2;\r\n\t\t\tday = 1;\r\n\t\t\tyear = tmp.getFullYear();\r\n\t\t\ttmp = new Date(year+' '+month+' '+day);\r\n\t\t\tday = tmp.getDate() - 1;\r\n\t\t\tmonth = tmp.getMonth() + 1;\r\n\t\t\tyear = tmp.getFullYear();\r\n\t\t\tthis.dueDate = new Date(year+' '+month+' '+day);\r\n\t\t}else{\r\n\t\t\tthis.dueDate = new Date(year+' '+month+' '+day);\r\n\t\t}\r\n\t\tvar curDate = new Date();\r\n\t\tif(Number(this.invoice.cancelled_flag) == 1){\r\n\t\t\tthis.statusColor = '#666666';\r\n\t\t}else if(Number(this.invoice.paid_flag) == 1){\r\n\t\t\tthis.statusColor = '#07f300';\r\n\t\t}else{\r\n\t\t\tvar diff = (curDate - this.dueDate)/(1000*60*60*24);\r\n\t\t\tif(diff <= 0 ){\r\n\t\t\t\tthis.statusColor =  '#fffe00';\r\n\t\t\t}else if(diff >0 && diff <= 7){\r\n\t\t\t\tthis.statusColor =  '#fd5b2c';\r\n\t\t\t}else{\r\n\t\t\t\tthis.statusColor =  '#ca0005';\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n}\r\n\r\nBERLIN3.accounting_invoices = {\r\n\tmodify_invoiceline:function(id,key,value){\r\n\t\tDHTMLSuite.ajax.sendRequest('modify.pl','modify_type=record&table=invoicelines&kVal='+id+'&'+key+'='+value);\r\n\t},\r\n\tdelete_invoice:function(rowIndex,table,url,param){\r\n\t\tvar msg = '<div class=\"mb10\"><center><font size=\"2\" style=\"font-weight:bold;\">Do you really want to delete this invoice?</font></center></div><div><center><input type=\"button\" value=\"YES\" onclick=\"closeMessage();BERLIN3.common.removeTableRow(\\''+rowIndex+'\\',\\''+table+'\\',\\''+url+'\\',\\''+param+'\\');\" /> <input type=\"button\" value=\"NO\" onclick=\"closeMessage();\"/></center></div>';\r\n\t\tdisplayStaticMessage(msg,400,60);\r\n\t},\r\n\tchange_invoice_status:function(invoice_id, status_id, selected_date, save_only){\r\n\t\tstatus_id *= 1;\r\n\t\tvar cancelled_flag;\r\n\t\tvar paid_flag;\r\n\t\tvar payment_date = '';\r\n\t\tswitch(status_id){\r\n\t\t\tcase 1: //open\r\n\t\t\t\tcancelled_flag = 0;\r\n\t\t\t\tpaid_flag = 0;\r\n\t\t\t\tbreak;\r\n\t\t\tcase 2: //partially paid\r\n\t\t\t\tcancelled_flag = 0;\r\n\t\t\t\tpaid_flag = 2;\r\n\t\t\t\tbreak;\r\n\t\t\tcase 3: // fully paid\r\n\t\t\t\tcancelled_flag = 0;\r\n\t\t\t\tpaid_flag = 1;\r\n\t\t\t\tif(selected_date){\r\n\t\t\t\t\tpayment_date = selected_date;\r\n\t\t\t\t}else{\r\n\t\t\t\t\tpayment_date =  berlin3.today();\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\tcase 4: // cancelled flag\r\n\t\t\t\tcancelled_flag = 1;\r\n\t\t\t\tpaid_flag = 0;\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t\tvar callback = function() {\r\n\t\t\t$.post('accounting.pl', {\r\n\t\t\t\tsection: 'invoices',\r\n\t\t\t\taction: 'status_color',\r\n\t\t\t\tinvoice_id: invoice_id\r\n\t\t\t}, function(invoice) {\r\n\t\t\t\t$('.invoice-status-div[invoice_id=' + invoice_id + ']').css({'background-color':invoice.color});\r\n\t\t\t}, \"json\");\r\n\t\t};\r\n\t\t$.post('modify.pl', {\r\n\t\t\t'modify_type' : 'record',\r\n\t\t\t'table': 'invoices',\r\n\t\t\t'kVal': invoice_id,\r\n\t\t\t'cancelled_flag': cancelled_flag,\r\n\t\t\t'paid_flag': paid_flag,\r\n\t\t\t'payment_date': payment_date\r\n\t\t}, callback);\r\n\t\t//dynConObj.loadContent('invoices_table_container','accounting.pl?section=invoices&action=load_all_invoices');\r\n\t},\r\n\tupdate_status_color:function(invoice_id){\r\n\t\tsetTimeout( function() {\r\n\t\t\t\tvar invoice = Jemplate.JSON.parse(Jemplate.Ajax.get('accounting.pl?section=invoices&action=status_color&invoice_id='+invoice_id));\r\n\t\t\t\tdocument.getElementById('status_color_'+invoice_id).style.backgroundColor = invoice.color;\r\n\t\t\t},1000 );\r\n\t}\r\n};\r\n\r\n(function(){\r\n\t//var tableObj = new BERLIN3.common.SortTable('invoices_table_header','invoices_table',[2,1,1,1,0,1,0,0,2,2],[1,1,1,1,0,1,0,0,0,0],2,'desc');\r\n\t//tableObj.initTable();\r\n\tif(BERLIN3.common.invoiceParam.active == 1){\r\n\t\tBERLIN3.common.invoiceParam.active = 0;\r\n\t\taccountingInvoices.createNewTab('accounting_invoices',BERLIN3.common.invoiceParam.title,'','accounting.pl?section=invoices&action=invoice_detail&invoice_id='+BERLIN3.common.invoiceParam.id,true);\r\n\t}\r\n})();\r\n\r\n\r\n//////////////////////////////// accounting_invoice.js end here /////////////////////////////////////////////////////////////\r\n\r\n\r\n\r\nautoCom = new DHTMLSuite.autoComplete();\r\n\r\nberlin3.invoices = berlin3.invoices || {};\r\nberlin3.invoices.lang = 'en';\r\nberlin3.invoices.CDA = [];\r\n\r\nberlin3.invoices.getStatusText = function(index) {\r\n    var status = [\"\", \"open\", \"partially paid\", \"fully paid\", \"cancelled\"];\r\n\r\n    return status[index];\r\n};\r\n\r\nberlin3.invoices.filter_invoice = function(obj) {\r\n\r\n    var $searchDiv      = $('#invoice_table_header');\r\n\r\n    var searchStr       =  $searchDiv.find('#search_invoices').val();\r\n    var invoiceProject  =  $searchDiv.find('#invoice_project').val();\r\n    var invoiceUserId   =  $searchDiv.find('#invoice_user_id option:selected').val() || '';\r\n\r\n    var invoiceStatuses = [];\r\n    $searchDiv.find('select#invoice_statuses option:selected').each(function(i, selected){\r\n        invoiceStatuses[i] = $(selected).val();\r\n    });\r\n\r\n\tif ($(obj).is('#search_invoices') && searchStr == '') {\r\n\t\t$('#invoices_table_container').html(berlin3.invoices.cache_invoice_list);\r\n\t\treturn;\r\n\t}\r\n\tBERLIN3.common.wait('invoices_table_container');\r\n\t$.post('accounting.pl', {\r\n\t\tsection: 'invoices',\r\n\t\taction: 'filter_invoice_json',\r\n\t\tsearch_str: searchStr,\r\n\t\tinvoiceStatuses: invoiceStatuses.join(),\r\n\t\tinvoice_project_id: invoiceProject,\r\n        invoice_user_id: invoiceUserId\r\n\t}, function(invoices) {\r\n\t\tberlin3.invoices.renderInvoices(invoices);\r\n\t\t// var val = $('#invoice_statuses').val();\r\n\t\t// if (val == 0) {\r\n\t\t// \tval = 'ffffff';\r\n\t\t// }\r\n\t\t// $('#invoice_status_color').css('backgroundColor', '#'+ val);\r\n\t\tif (!$(obj).is('#search_invoices')) {\r\n\t\t\tberlin3.invoices.cache_invoice_list = $('#invoices_table_container').html();\r\n\t\t}\r\n\t});\r\n};\r\n\r\nberlin3.invoices.loadInvoices = function() {\r\n\t$.post('accounting.pl', {\r\n\t\tsection: 'invoices',\r\n\t\taction: 'all_invoices'\r\n\t}, function(invoices) {\r\n\t\tberlin3.invoices.renderInvoices(invoices);\r\n\t\tberlin3.invoices.cache_invoice_list = $('#invoices_table_container').html();\r\n\t}, \"json\");\r\n};\r\n\r\nberlin3.invoices.renderInvoices = function(invoices) {\r\n\tvar parentId = '#invoices_table_container';\r\n\tvar templateId = '#invoices_templates #invoice_row_template';\r\n\tvar invoices = berlin3.invoices._proprocessInvoices(invoices);\r\n\tvar html = berlin3.common.listRows(templateId, invoices);\r\n\t$(parentId).html(html);\r\n    berlin3.common.colorRows(parentId);\r\n    berlin3.invoices.showHideForwardIcon();\r\n};\r\n\r\nberlin3.invoices.showHideForwardIcon = function() {\r\n    $(\"#invoices_table_container [class^='forward-icon-']\").not('.forward-icon-0').show();\r\n};\r\n\r\nberlin3.invoices._proprocessInvoices = function(invoices) {\r\n\r\n    var length = invoices.length;\r\n    for (var i = 0; i< length;i++) {\r\n        invoices[i].gross_amount_cc = BERLIN3.common.i18n_number(invoices[i].gross_amount_cc, berlin3.invoices.lang, true);\r\n        invoices[i].invoice_project_name = invoices[i].invoice_project_name ? invoices[i].invoice_project_name.substr(0, 10) : '';\r\n\r\n        invoices[i].invoice_contact_type = 'individual';\r\n        if (invoices[i].company_name) {\r\n            invoices[i].name = invoices[i].company_name;\r\n            invoices[i].invoice_contact_type = 'company';\r\n        }\r\n        else {\r\n            invoices[i].name = invoices[i].first_name + ' ' + invoices[i].last_name;\r\n        }\r\n\r\n        // invoices[i].lock_flag_image = invoices[i].lock_flag == 1 ? \"/images/newimg/locked.png\" : \"/images/newimg/unlocked.png\";\r\n        var lock_flag_image = invoices[i].lock_flag == 1 ? \"/images/newimg/locked.png\" : \"/images/newimg/unlocked.png\";\r\n        invoices[i].lock_flag_image = '<img style=\"border-radius: 0px; width:14px;\" id=\"invoiceListLockedUnlocked_'+ invoices[i].invoice_id +'\" src=\"'+ lock_flag_image +'\" invoice_id=\"'+ invoices[i].invoice_id +'\" lock_flag=\"'+ invoices[i].lock_flag +'\" onclick=\"berlin3.invoices.lockUnlockInvoice(this);\" />';\r\n        // invoices[i].lock_flag_image = '<img style=\"border-radius: 0px; width:14px;\" id=\"invoiceListLockedUnlocked_'+ invoices[i].invoice_id +'\" src=\"'+ lock_flag_image +'\" invoice_id=\"'+ invoices[i].invoice_id +'\" lock_flag=\"'+ invoices[i].lock_flag +'\" onclick=\"berlin3.invoices.lockUnlockInvoice(this);\" />';\r\n    }\r\n    return invoices;\r\n};\r\n\r\nberlin3.invoices.scrollInvoices = function() {\r\n\tvar parentId      = '#invoices_table_container';\r\n\r\n\t// If scroll at bottom and not locked\r\n\tif ( berlin3.common.scrolledToBottom(parentId) && !berlin3.common.isScrollLock(parentId) ) {\r\n\r\n\t\t// Lock scroll to prevent double event.\r\n\t\tberlin3.common.scrollLock(parentId);\r\n\r\n\t\tvar start           = $('#invoices_table_container > div').size();\r\n\r\n        var $searchDiv      = $('#invoice_table_header');\r\n\r\n        var searchStr       =  $searchDiv.find('#search_invoices').val();\r\n        var invoiceProject  =  $searchDiv.find('#invoice_project').val();\r\n        var invoiceUserId   =  $searchDiv.find('#invoice_user_id option:selected').val() || '';\r\n\r\n        var invoiceStatuses = [];\r\n        $searchDiv.find('select#invoice_statuses option:selected').each(function(i, selected){\r\n            invoiceStatuses[i] = $(selected).val();\r\n        });\r\n\r\n\t\t$.post('accounting.pl', {\r\n\t\t\tsection: 'invoices',\r\n\t\t\taction: 'invoice_scroll',\r\n\t\t\tinvoiceStatuses: invoiceStatuses.join(),\r\n\t\t\tinvoice_project_id: invoiceProject,\r\n\t\t\tsearch_str: searchStr,\r\n\t\t\tstart_from: start,\r\n            invoice_user_id: invoiceUserId\r\n\t\t}, function(invoices) {\r\n\t\t\tvar html = $(parentId).html();\r\n\t\t\tberlin3.invoices.renderInvoices(invoices);\r\n\t\t\tvar html1 = $(parentId).html();\r\n\t\t\t$(parentId).html(html + html1);\r\n\t\t\tberlin3.common.colorRows(parentId);\r\n\t\t\tberlin3.invoices.cache_invoice_list = $(parentId).html();\r\n\r\n\t\t\t// Release the scroll\r\n\t\t\tberlin3.common.scrollUnlock(parentId);\r\n\r\n\t\t}, \"json\");\r\n\t}\r\n};\r\n\r\nberlin3.invoices.openInvoice = function(obj) {\r\n\tvar invoice_ref = $(obj).text();\r\n\tvar invoice_id = $(obj).attr('invoice_id');\r\n\r\n    BERLIN3.common.activateInvoice(invoice_ref, invoice_id);\r\n\r\n\t// accountingInvoices.createNewTab('accounting_invoices', invoice_ref, '', 'accounting.pl?section=invoices&action=invoice_detail&invoice_id=' + invoice_id, true);\r\n};\r\n\r\nberlin3.invoices.editInvoice = function(obj) {\r\n\tvar invoice_id = $(obj).attr('invoice_id');\r\n\tdisplayMessage('accounting.pl?section=invoices&action=payment_form&save_only=1&invoice_id=' + invoice_id, 400, 145);\r\n};\r\n\r\nberlin3.invoices.printInvoice = function(obj) {\r\n\tvar invoice_id        = $(obj).attr('invoice_id')        || '';\r\n    var lockedUnlockedObj = $(obj).attr('lockedUnlockedObj') || '';\r\n\r\n\twindow.open('accounting.pl?section=invoices&action=print_invoice&invoice_id=' + invoice_id, '_blank', 'menubar=yes,scrollbars=yes');\r\n\r\n    var $lulObj = $(lockedUnlockedObj);\r\n    if($lulObj.exists()) {\r\n        // Un print lock invoice always\r\n        $lulObj.attr('lock_flag', '0');\r\n        berlin3.invoices.lockUnlockInvoice($lulObj);\r\n    }\r\n\r\n};\r\n\r\nberlin3.invoices.lockUnlockInvoice = function(obj) {\r\n    berlin3.common.accounting.lockUnlockInvoice(obj);\r\n    // var invoice_id        = $(obj).attr('invoice_id') || '';\r\n    // var src               = $(obj).attr(\"src\")        || '';\r\n    // var lock_flag         = $(obj).attr(\"lock_flag\")  || 0;\r\n    // var expectedLock_flag = lock_flag == '1' ? '0' : '1';\r\n    // var callback          = $(obj).attr(\"callback\")   || '';\r\n\r\n    // if(!invoice_id) {\r\n    //     return false;\r\n    // }\r\n\r\n    // $.ajax({\r\n    //     type: 'POST',\r\n    //     url: \"accounting.pl\",\r\n    //     data: {\r\n    //         section: 'invoices',\r\n    //         action: 'lockUnlockInvoice',\r\n    //         invoice_id: invoice_id,\r\n    //         lock_flag: expectedLock_flag\r\n    //     },\r\n    //     beforeSend:function(){\r\n    //         $(obj).attr(\"src\", \"/images/loading_gifs/loaderA16.gif\");\r\n    //     },\r\n    //     success:function(data){\r\n    //         var new_lock_flag        = data.lock_flag            || \"\";\r\n    //         var accounting_more_flag = data.accounting_more_flag || \"\";\r\n\r\n    //         $(obj).attr(\"lock_flag\", new_lock_flag);\r\n\r\n    //         var type  = 'success';\r\n    //         var msg   = '';\r\n\r\n    //         if(expectedLock_flag == '1') {\r\n    //             $(obj).attr(\"src\", \"/images/newimg/locked.png\");\r\n    //             msg   = \"Invoice locked\";\r\n    //         } else if(accounting_more_flag == \"1\" && expectedLock_flag == '0') {\r\n    //             $(obj).attr(\"src\", \"/images/newimg/unlocked.png\");\r\n    //             msg   = \"Invoice unlocked\";\r\n    //         } else if(accounting_more_flag != \"1\" && expectedLock_flag == '0') {\r\n    //             $(obj).attr(\"src\", src);\r\n\r\n    //             type  = 'warning';\r\n    //             msg   = \"Don't have permission to unloack invoice\";\r\n    //         }\r\n\r\n    //         berlin3.common.displayToastr({type: type, msg: msg});\r\n\r\n    //         if( callback != '' && callback != 'undefined' ) {\r\n    //             callback = eval(callback);\r\n    //             callback(obj);\r\n    //         }\r\n    //     },\r\n    //     error:function(){\r\n    //         $(obj).attr(\"src\", src);\r\n    //     }\r\n    // });\r\n};\r\n\r\nberlin3.invoices.deleteInvoice = function(obj) {\r\n\r\n    var invoice_id    = $(obj).attr('invoice_id');\r\n    var report_lines  = $(obj).attr('report_lines');\r\n    var licence_lines = $(obj).attr('licence_lines');\r\n\r\n\tvar parentId = '#invoices_table_container';\r\n\r\n    $.ajax({\r\n        type: 'POST',\r\n        url: \"accounting.pl\",\r\n        data: {\r\n            section: 'invoices',\r\n            action: 'deleteInvoice',\r\n            invoice_id: invoice_id,\r\n            report_lines: report_lines,\r\n            licence_lines: licence_lines\r\n        },\r\n        beforeSend:function(){\r\n            $(obj).prop('disabled', true);\r\n            berlin3.common.displayToastr({type: \"info\", msg: \"Invoice deleting...\", timeOut: 1000, showDuration: 100});\r\n            $(\"#invoices_table_container\").find(\"#invoiceRow_\"+ invoice_id).remove();\r\n            // $('#openInvoiceFlagChangeModal_' + invoice_id).parent().parent().parent().remove();\r\n            berlin3.common.colorRows();\r\n        },\r\n        success:function(data){\r\n\r\n            $(obj).prop('disabled', false);\r\n            berlin3.common.colorRows(parentId);\r\n            berlin3.common.displayToastr({type: \"success\", msg: \"Invoice deleted\"});\r\n            closeMessage();\r\n\r\n            /**\r\n             * If selected invoice tab is opened, then close it\r\n             */\r\n            if($(\"#invoice_tabview_\"+ invoice_id).exists()) {\r\n                var index = accountingInvoices.getTabIndex();\r\n                // console.log( data.response.invoice_ref, index );\r\n                accountingInvoices.deleteTab(data.response.invoice_ref, index);\r\n            }\r\n\r\n        },\r\n        error:function(){\r\n            $(obj).prop('disabled', false);\r\n            berlin3.common.displayToastr({type: \"error\", msg: \"Can not delete invioce\"});\r\n            closeMessage();\r\n        }\r\n    });\r\n};\r\n\r\nberlin3.invoices.cancelInvoice = function(obj) {\r\n\r\n    var invoice_id    = $(obj).attr('invoice_id');\r\n\r\n    $.ajax({\r\n        type: 'POST',\r\n        url: \"accounting.pl\",\r\n        data: {\r\n            section: 'invoices',\r\n            action: 'cancelInvoice',\r\n            invoice_id: invoice_id\r\n        },\r\n        beforeSend:function(){\r\n            berlin3.common.colorRows();\r\n            $(obj).prop('disabled', true);\r\n\r\n        },\r\n        success:function(data){\r\n\r\n            $(obj).prop('disabled', false);\r\n            berlin3.common.displayToastr({type: \"success\", msg: \"Invoice cancelled\"});\r\n            closeMessage();\r\n\r\n            berlin3.invoices.updateInvocieStatusDisplayElements({invoice_id: invoice_id, color: data.response.color, status: 4});\r\n\r\n        },\r\n        error:function(){\r\n            $(obj).prop('disabled', false);\r\n            berlin3.common.displayToastr({type: \"error\", msg: \"Can not cancel invioce\"});\r\n            closeMessage();\r\n        }\r\n    });\r\n};\r\n\r\nberlin3.invoices.confirmDeleteCancelInvoice = function(obj) {\r\n\tvar invoice_id    = $(obj).attr('invoice_id');\r\n    var report_lines  = $(obj).attr('report_lines');\r\n    var licence_lines = $(obj).attr('licence_lines');\r\n    var task       = $(obj).attr('task')       || '';\r\n\r\n    if(!invoice_id) {\r\n        berlin3.common.displayToastr({ type: \"error\", msg: \"Can't proceed\"});\r\n        return false;\r\n    }\r\n\r\n    var taskComfirmMsg = '';\r\n    var taskButton     = '';\r\n\r\n    if(task == 'delete') {\r\n        taskComfirmMsg = 'Do you want to DELETE this invoice ?';\r\n        taskButton     = '<input type=\"button\" invoice_id=\"'+ invoice_id +'\" report_lines=\"'+ report_lines +'\" licence_lines=\"'+ licence_lines +'\" value=\"delete\" onclick=\"berlin3.invoices.deleteInvoice(this);\" />';\r\n    } else if(task == 'cancel') {\r\n        taskComfirmMsg = '';\r\n        taskButton     = '<input type=\"button\" invoice_id=\"'+ invoice_id +'\" value=\"Cancel Invoice\" onclick=\"berlin3.invoices.cancelInvoice(this);\" />';\r\n    }\r\n\r\n\r\n\tvar msg = '<div class=\"mb10\" style=\"text-align:center;font-size:1.4em;font-weight:bold;\">'+ taskComfirmMsg +'</div><div class=\"modalButtons\"><span class=\"right\">'+ taskButton +' <input type=\"button\" value=\"close\" onclick=\"closeMessage();\"/></span></div>';\r\n\tdisplayStaticMessage(msg, 300, 60);\r\n};\r\n\r\nberlin3.invoices.dispalyRelatedRoyaltyPeriodsOnDeleteCancelInvoice = function(obj) {\r\n\r\n    var invoice_id = $(obj).attr('invoice_id');\r\n    var royaltyPeriods = obj.royaltyPeriods;\r\n\r\n    var html = berlin3.common.parseRow('#invoices_templates #tpl_modal_on_delete_cancel_invoice_related_with_royaltyperiod', {\r\n        invoice_id: invoice_id,\r\n    }, undefined, true);\r\n    displayStaticMessage(html, 500, 400);\r\n\r\n    var rp_html = berlin3.common.listRows('#invoices_templates #tpl_related_royalty_period_row', royaltyPeriods);\r\n    $('#invoice_related_with_royaltyperiod_rows_' + invoice_id).html(rp_html);\r\n\r\n}\r\n\r\nberlin3.invoices.scrollRelatedRoyaltyPeriodOnDCModal = function(obj) {\r\n\r\n    if (berlin3.common.scrolledToBottom(obj) && !berlin3.common.isScrollLock(obj)) {\r\n\r\n        berlin3.common.scrollLock(obj);\r\n        var divId = '#' + $(obj).attr('id');\r\n        var start = $(divId + ' > div').size();\r\n\r\n        var invoice_id = $(obj).attr('invoice_id') || '';\r\n        if(!invoice_id) return false;\r\n\r\n        berlin3.common.waitOnScroll({ obj: $(divId) });\r\n\r\n        $.post('accounting.pl', {\r\n            section: 'invoices',\r\n            action: 'get_related_royalty_periods',\r\n            invoice_id: invoice_id,\r\n            start: start\r\n        }, function(data) {\r\n\r\n            var rp_html = berlin3.common.listRows('#invoices_templates #tpl_related_royalty_period_row', data.royaltyPeriods);\r\n            $('#invoice_related_with_royaltyperiod_rows_' + invoice_id).append(rp_html);\r\n            berlin3.common.scrollUnlock(obj);\r\n            berlin3.common.removeWaitOnScroll({ obj: $(obj) });\r\n\r\n        }, \"json\");\r\n    }\r\n\r\n}\r\n\r\nberlin3.invoices.invoiceCancelDeletePreChecking = function(obj) {\r\n\r\n    var invoice_id = $(obj).attr('invoice_id') || '';\r\n    var task       = $(obj).attr('task')       || '';\r\n\r\n    if(!invoice_id) {\r\n        berlin3.common.displayToastr({ type: \"error\", msg: \"Can't proceed\"});\r\n        return false;\r\n    }\r\n\r\n    var taskComfirmMsg = '';\r\n    var taskButton     = '';\r\n\r\n    $.ajax({\r\n        type: 'POST',\r\n        url: \"accounting.pl\",\r\n        data: {\r\n            section: 'invoices',\r\n            action: 'invoiceCancelDeletePreChecking',\r\n            invoice_id: invoice_id,\r\n        },\r\n        beforeSend:function(){\r\n            berlin3.common.loadWaitModal(300, 70);\r\n        },\r\n        success:function(data){\r\n\r\n            var external_table = data.external_table || '';\r\n            var report_lines   = data.report_lines   || '';\r\n            var licence_lines  = data.licence_lines  || '';\r\n            var royalty_lines  = data.royalty_lines  || '';\r\n\r\n            if(task == 'delete') {\r\n                taskComfirmMsg = 'Do you want to DELETE this invoice ?';\r\n                taskButton     = '<input type=\"button\" invoice_id=\"'+ invoice_id +'\" report_lines=\"'+ report_lines +'\" licence_lines=\"'+ licence_lines +'\" value=\"delete\" onclick=\"berlin3.invoices.deleteInvoice(this);\" />';\r\n            } else if(task == 'cancel') {\r\n                taskComfirmMsg = '';\r\n                taskButton     = '<input type=\"button\" invoice_id=\"'+ invoice_id +'\" value=\"Cancel Invoice\" onclick=\"berlin3.invoices.cancelInvoice(this);\" />';\r\n            }\r\n\r\n            if( ( external_table == 'accounts' || external_table == 'licence_account' ) && ('royaltyPeriods' in data) ) {\r\n                let inoviceRps = new berlin3.ui.InvoiceRoyaltyPeriods(invoice_id, data.royaltyPeriods);\r\n\t\t\t\tinoviceRps.render();\r\n                // obj.royaltyPeriods = data.royaltyPeriods;\r\n                // berlin3.invoices.dispalyRelatedRoyaltyPeriodsOnDeleteCancelInvoice(obj);\r\n\r\n            } else if( external_table == 'accounts' && report_lines > 0) {\r\n                var msg = '<div class=\"mb10\" style=\"text-align:center;font-size:1.4em;font-weight:bold;\">This Invoice is related to '+ report_lines +' Report Lines.<br/>'+ taskComfirmMsg +'</div><div class=\"modalButtons\"><span class=\"right\">'+ taskButton +' <input type=\"button\" value=\"No\" onclick=\"closeMessage();\"/></span></div>';\r\n                displayStaticMessage(msg, 300, 70);\r\n\r\n            } else if( external_table == 'licence_account' && licence_lines > 0) {\r\n                var msg = '<div class=\"mb10\" style=\"text-align:center;font-size:1.4em;font-weight:bold;\">This Invoice is related to '+ licence_lines +' Licence Lines.<br/>'+ taskComfirmMsg +'</div><div class=\"modalButtons\"><span class=\"right\">'+ taskButton +' <input type=\"button\" value=\"No\" onclick=\"closeMessage();\"/></span></div>';\r\n                displayStaticMessage(msg, 300, 70);\r\n\r\n            } else {\r\n                berlin3.invoices.confirmDeleteCancelInvoice(obj);\r\n            }\r\n\r\n        },\r\n        error:function(){\r\n            berlin3.common.displayToastr({type: \"error\", msg: \"Can't proceed\"});\r\n            closeMessage();\r\n        }\r\n    });\r\n\r\n\r\n};\r\n\r\nberlin3.invoices.artist_exchangerate_calculation = function(obj) {\r\n\tvar payment_id = $(obj).attr('key_val');\r\n\tvar amount = $('input[key=\"payment_id\"][key_val=\"' + payment_id + '\"][field=\"amount\"]').val();\r\n\tvar exchangerate = $('input[key=\"payment_id\"][key_val=\"' + payment_id + '\"][field=\"exchangerate\"]').val();\r\n\tvar sys_cur_val = Number(amount * exchangerate).toFixed(2);\r\n\t$('span.sys-cur-calculation-artist[payment_id=\"' + payment_id + '\"]').html(sys_cur_val);\r\n\tvar invoice_id = $('span.sys-cur-calculation-artist[payment_id=\"' + payment_id + '\"]').attr('invoice_id');\r\n\tberlin3.invoices.totalArtist(invoice_id);\r\n};\r\n\r\nberlin3.invoices.agent_exchangerate_calculation = function(obj) {\r\n\tvar payment_id = $(obj).attr('key_val');\r\n\tvar amount = $('input[key=\"payment_id\"][key_val=\"' + payment_id + '\"][field=\"amount\"]').val();\r\n\tvar exchangerate = $('input[key=\"payment_id\"][key_val=\"' + payment_id + '\"][field=\"exchangerate\"]').val();\r\n\tvar sys_cur_val = Number(amount * exchangerate).toFixed(2);\r\n\t$('span.sys-cur-calculation-agent[payment_id=\"' + payment_id + '\"]').html(sys_cur_val);\r\n\tvar invoice_id = $('span.sys-cur-calculation-agent[payment_id=\"' + payment_id + '\"]').attr('invoice_id');\r\n\tberlin3.invoices.totalAgent(invoice_id);\r\n};\r\n\r\nberlin3.invoices.totalArtist = function(invoice_id) {\r\n\tvar total_artist = 0;\r\n\t$('span.sys-cur-calculation-artist[invoice_id=\"' + invoice_id + '\"]').each(function(index, element){\r\n\t\ttotal_artist+= Number( $(element).html() );\r\n\t});\r\n\t$('span.total-artist[invoice_id=\"' + invoice_id + '\"]').html(BERLIN3.common.i18n_number(total_artist, 'en', true));\r\n};\r\n\r\nberlin3.invoices.totalAgent = function(invoice_id) {\r\n\tvar total_agent = 0;\r\n\t$('span.sys-cur-calculation-agent[invoice_id=\"' + invoice_id + '\"]').each(function(index, element){\r\n\t\ttotal_agent+= Number( $(element).html() );\r\n\t});\r\n\t$('span.total-agent[invoice_id=\"' + invoice_id + '\"]').html(BERLIN3.common.i18n_number(total_agent, 'en', true));\r\n};\r\n\r\nberlin3.invoices.saveField = function(obj) {\r\n\tvar key = $(obj).attr('key');\r\n\tvar keyVal = $(obj).attr('key_val');\r\n\tvar field = $(obj).attr('field');\r\n\tvar table = BERLIN3.common.TABLES[key];\r\n\tvar value = $(obj).val();\r\n\t$.post('modify.pl',{\r\n\t\tkey: key,\r\n\t\tkVal: keyVal,\r\n\t\tname: field,\r\n\t\tvalue: value,\r\n\t\ttable: table\r\n\t});\r\n};\r\n\r\nberlin3.invoices.addDatePicker = function(obj) {\r\n\tBERLIN3.common.pickDate(obj, obj);\r\n};\r\n\r\nberlin3.invoices.removePayment = function(obj) {\r\n\tvar payment_id = $(obj).attr('payment_id');\r\n\tvar invoice_id = $(obj).attr('invoice_id');\r\n\t$('.remove-payment[payment_id=\"'+ payment_id +'\"]').parent().parent().parent().remove();\r\n\tberlin3.common.colorRows('.artist-forwarding-list[invoice_id=\"' + invoice_id + '\"]');\r\n\tberlin3.invoices.totalArtist(invoice_id);\r\n\tberlin3.invoices.totalAgent(invoice_id);\r\n\t$.post('accounting.pl', {\r\n\t\tsection: 'invoices',\r\n\t\taction: 'delete_payment',\r\n\t\tpayment_id: payment_id\r\n\t});\r\n};\r\n\r\n\r\n\r\n\r\n\r\nberlin3.invoices.processPayment = function(payment) {\r\n\tvar pattern = 'option value=\"' + payment.currency_id + '\"';\r\n\tvar currencies_html = $('#invoices_templates #currency_list').html();\r\n\tcurrencies_html = currencies_html.replace(/<select>/, '<select key=\"payment_id\" key_val=\"' + payment.payment_id + '\" field=\"currency_id\" onchange=\"berlin3.invoices.msgHandler(\\'save_payment_field\\', this);\">');\r\n\tcurrencies_html = currencies_html.replace(pattern, pattern + ' selected=\"selected\"');\r\n\tpayment.currencies = currencies_html;\r\n\tpayment.sys_cur_val = Number(payment.amount * payment.exchangerate).toFixed(2);\r\n\treturn payment;\r\n};\r\n\r\nberlin3.invoices.onArtistFowardingRecipientDropdownClick = function(obj) {\r\n    var $obj = $(obj);\r\n    var invoice_id = $obj.attr('invoice_id');\r\n    let recepientInput = $obj.parent().prev('input');\r\n    recepientInput.val($obj.text());\r\n    // recepientInput.blur();\r\n    berlin3.invoices.msgHandler('save_payment_field', recepientInput.get(0));\r\n}\r\n\r\nberlin3.invoices.addArtistFowarding = function(obj) {\r\n    var invoice_id = $(obj).attr('invoice_id');\r\n    let cda = berlin3.invoices.CDA[invoice_id];\r\n    let recipient = '';\r\n    if(cda && cda.selectedArtist){\r\n        recipient = cda.selectedArtist.artist_name;\r\n    }\r\n    // console.log(` cda ${invoice_id}: `, cda);\r\n    // return false;\r\n\r\n\t$.post('accounting.pl', {\r\n\t\tsection: 'invoices',\r\n\t\taction: 'add_artist_payment_forward',\r\n\t\tinvoice_id: invoice_id,\r\n        recipient\r\n\t}, function(data) {\r\n\t\tvar payment = berlin3.invoices.processPayment(data.payment);\r\n\t\tvar payment_html = berlin3.common.parseRow('#invoices_templates #artist_forwarding_tpl', {...payment, cdaDropdownContent:berlin3.invoices.artistRecipientDropdownHTML(invoice_id)});\r\n\r\n\t\t$('.artist-forwarding-list[invoice_id=\"' + invoice_id + '\"]').append(payment_html);\r\n\t\tberlin3.common.colorRows('.artist-forwarding-list[invoice_id=\"' + invoice_id + '\"]');\r\n\t}, \"json\");\r\n};\r\n\r\nberlin3.invoices.addAgentFowarding = function(obj) {\r\n\tvar invoice_id = $(obj).attr('invoice_id');\r\n\t$.post('accounting.pl', {\r\n\t\tsection: 'invoices',\r\n\t\taction: 'add_agent_payment_forward',\r\n\t\tinvoice_id: invoice_id\r\n\t}, function(data) {\r\n\t\tvar payment = berlin3.invoices.processPayment(data.payment);\r\n\t\tvar payment_html = berlin3.common.parseRow('#invoices_templates #agent_forwarding_tpl', payment);\r\n\r\n\t\t$('.agent-forwarding-list[invoice_id=\"' + invoice_id + '\"]').append(payment_html);\r\n\t\tberlin3.common.colorRows('.agent-forwarding-list[invoice_id=\"' + invoice_id + '\"]');\r\n\t}, \"json\");\r\n};\r\n\r\nberlin3.invoices.getForwardingInvoiceLinesHTML = function(data) {\r\n    // console.log(data);\r\n    let invoicelines = data.invoicelines.map(row => {\r\n        //Row Total Calculation\r\n        const qty = row.qty ? Number(row.qty) : 1;\r\n        const computed_total = Number(row.price) * qty;\r\n        row.computed_total = BERLIN3.common.i18n_number(computed_total, 'en', true);\r\n\r\n        //VAT Calculation\r\n        let vat = '';\r\n        if(row.vat_type == '1'){\r\n            vat = data.invoice.vat_rate1 || '0.00';\r\n        }\r\n        else if(row.vat_type == '2'){\r\n            vat = data.invoice.vat_rate2 || '0.00';\r\n        }\r\n        else if(row.vat_type == '3' || row.vat_type == '0'){\r\n            vat = data.invoice.vat_rate3 || '0.00';\r\n        }\r\n        row.computed_vat = vat ? `${vat}%` : '';\r\n\r\n        return row;\r\n    });\r\n    // console.log('invoicelines: ', invoicelines);\r\n    \r\n    let invoiceStatusAll = data.invoice_status.map(row => {\r\n        row[1] = '#' + row[1];\r\n        return row; \r\n    });\r\n    let invoiceStatus = invoiceStatusAll.find(row => row.includes(data.invoice.status_color));\r\n    let fully_paid_on = data.invoice.payment_date;\r\n    fully_paid_on = fully_paid_on ? `Fully paid on ${fully_paid_on}` : '&nbsp;';\r\n\r\n\tvar rows_html = berlin3.common.listRows('#invoice_forwarding_invoice_lines_row_tpl', invoicelines);\r\n    var invoicelines_html = berlin3.common.parseRow('#invoice_forwarding_invoice_lines_div_tpl', {\r\n        invoice_id : data.invoice.invoice_id,\r\n        invoicelines : rows_html,\r\n        invoice_currency_iso : data.invoice.invoice_currency_iso,\r\n        client_currency_iso : data.invoice.client_currency_iso,\r\n        net_amount : BERLIN3.common.i18n_number(data.invoice.net_amount, 'en', true),\r\n        gross_amount : BERLIN3.common.i18n_number(data.invoice.gross_amount, 'en', true),\r\n        net_amount_default_currency : BERLIN3.common.i18n_number((data.invoice.net_amount / data.invoice.exchange_rate), 'en', true),\r\n        gross_amount_default_currency : BERLIN3.common.i18n_number((data.invoice.gross_amount / data.invoice.exchange_rate), 'en', true),\r\n        invoice_status_color: invoiceStatus[1],\r\n        invoice_status_description: i18nDict[invoiceStatus[0]],\r\n        fully_paid_on\r\n    });\r\n\r\n    return invoicelines_html;\r\n}\r\n\r\nberlin3.invoices.artistRecipientDropdownHTML = function(invoiceId) {\r\n    let cdaDropdownContent = '';\r\n    const cda = berlin3.invoices.CDA[invoiceId];\r\n    if(cda){\r\n        const artistNames = cda.artists.map(row => `<a href=\"#\" onclick=\"berlin3.invoices.onArtistFowardingRecipientDropdownClick(this)\">${row.artist_name}</a>`);\r\n        cdaDropdownContent = `<div class=\"dropdown-content\">` + artistNames.join('') +`</div>`;\r\n    }\r\n    return cdaDropdownContent;\r\n}\r\n\r\nberlin3.invoices.loadForwarding = function(divId, invoiceId, action) {\r\n\tBERLIN3.common.wait(divId);\r\n\r\n\t$.post('accounting.pl', {\r\n\t\tsection: 'invoices',\r\n\t\taction: action,\r\n\t\tinvoice_id: invoiceId\r\n\t}, function(data) {\r\n        let invoiceLinesHTML = berlin3.invoices.getForwardingInvoiceLinesHTML(data);\r\n        let agent_html = invoiceLinesHTML;\r\n        \r\n        if(data.calendar_date_artists){\r\n            let selectedArtist = data.calendar_date_artists.length === 1 ? data.calendar_date_artists[0] : null;\r\n            berlin3.invoices.CDA[invoiceId] = {selectedArtist, artists: data.calendar_date_artists};\r\n        }\r\n        let cdaDropdownContent = berlin3.invoices.artistRecipientDropdownHTML(invoiceId);\r\n        // console.log('berlin3.invoice.CDA: ', berlin3.invoices.CDA);\r\n\r\n\t\tvar artist_payments = data.artist_payments;\r\n\t\tvar len = artist_payments.length;\r\n\t\tfor (var i = 0; i < len; i++) {\r\n\t\t\tartist_payments[i] = berlin3.invoices.processPayment(artist_payments[i]);\r\n\t\t}\r\n\r\n\t\tvar artist_payments_html = berlin3.common.listRows('#invoices_templates #artist_forwarding_tpl', artist_payments);\r\n\r\n\t\tvar artist_html = berlin3.common.parseRow('#invoices_templates #artist_forwarding_div_tpl', {\r\n\t\t\tinvoice_id: invoiceId,\r\n\t\t\tartist_payments_html: artist_payments_html,\r\n            cdaDropdownContent,\r\n            ...data.invoice,\r\n            forward_completed_flag_checked_attr: (data.invoice.forward_completed_flag === 1 ? `checked=\"checked\"` : ''),\r\n\t\t});\r\n\t\t//$('#' + divId).html(artist_html);\r\n\r\n\r\n\t\tvar agent_payments = data.agent_payments;\r\n\t\tvar len = agent_payments.length;\r\n\t\tfor (var i = 0; i < len; i++) {\r\n\t\t\tagent_payments[i] = berlin3.invoices.processPayment(agent_payments[i]);\r\n\t\t}\r\n\r\n\t\tvar agent_payments_html = berlin3.common.listRows('#invoices_templates #agent_forwarding_tpl', agent_payments);\r\n\r\n\t\tvar agent_html000 = berlin3.common.parseRow('#invoices_templates #agent_forwarding_div_tpl', {\r\n\t\t\tinvoice_id: invoiceId,\r\n\t\t\tagent_payments_html: agent_payments_html\r\n\t\t});\r\n\t\t//$('#' + divId).append(agent_html);\r\n\r\n\r\n\t\tif (data.has_booking) {\r\n\t\t\tvar html = berlin3.common.parseRow('#invoice_forwarding_tpl', {\r\n\t\t\t\tartist_html: artist_html,\r\n\t\t\t\tagent_html: agent_html,\r\n\t\t\t\tcalendar_date_id: data.invoice.external_id,\r\n\t\t\t\tfirst_offer_notes: data.first_offer_notes\r\n\t\t\t});\r\n\t\t}\r\n\t\telse {\r\n\t\t\tvar html = berlin3.common.parseRow('#invoice_forwarding_tpl2', {\r\n\t\t\t\tartist_html: artist_html,\r\n\t\t\t\tagent_html: agent_html\r\n\t\t\t});\r\n\t\t}\r\n\t\t$('#' + divId).html(html);\r\n\r\n\t\tberlin3.common.colorRows('.invoice-lines-list[invoice_id=\"' + invoiceId + '\"]');\r\n\t\tberlin3.common.colorRows('.artist-forwarding-list[invoice_id=\"' + invoiceId + '\"]');\r\n\t\tberlin3.invoices.totalArtist(invoiceId);\r\n\r\n\t\tberlin3.common.colorRows('.agent-forwarding-list[invoice_id=\"' + invoiceId + '\"]');\r\n\t\tberlin3.invoices.totalAgent(invoiceId);\r\n\t}, \"json\");\r\n\r\n};\r\n\r\n\r\n\r\nberlin3.invoices.loadTaxTypeDeduction = function(obj) {\r\n\tvar invoice_id = $(obj).attr('invoice_id');\r\n\tdisplayMessage('accounting.pl?section=invoices&action=tax_type_list&invoice_id=' + invoice_id, 400, 190);\r\n};\r\n\r\n\r\nberlin3.invoices.saveFirstOfferNotes = function(obj) {\r\n\tvar calendar_date_id = $(obj).attr('calendar_date_id');\r\n\tvar first_offer_notes = $(obj).val();\r\n\t$.post('accounting.pl', {\r\n\t\tsection: 'invoices',\r\n\t\taction: 'save_first_offer_notes',\r\n\t\tcalendar_date_id: calendar_date_id,\r\n\t\tfirst_offer_notes: first_offer_notes\r\n\t});\r\n};\r\n\r\nvar invoice_tab_callback = function(){\r\n\tvar invoice_id = $($(accountingInvoices.getReferenceToDivElementByTitle(accountingInvoices.getTabTitle())).children()[0]).attr('invoice_id');\r\n\tvar id = $('div[id^=tabViewinvoice_tabview_' + invoice_id + ']:visible').attr('id');\r\n\tvar action = $('#' + id).attr('action');\r\n\r\n\tif (action == 'invoice_tab_forwarding') {\r\n\t\tberlin3.invoices.loadForwarding(id, invoice_id, action);\r\n\t\treturn;\r\n\t}\r\n\tBERLIN3.common.wait(id);\r\n\t$('#' + id).load('accounting.pl', {\r\n\t\tsection: 'invoices',\r\n\t\taction: action,\r\n\t\tinvoice_id: invoice_id\r\n\t});\r\n};\r\n\r\nberlin3.invoices.openInvoiceFlagChangeModal = function(obj) {\r\n    var invoice_id     = $(obj).attr(\"invoice_id\")     || '';\r\n\r\n    if(invoice_id == '') {\r\n        return false;\r\n    }\r\n\r\n    $.ajax({\r\n        type: 'POST',\r\n        url: \"accounting.pl\",\r\n        data: {\r\n            section: 'invoices',\r\n            action: 'openInvoiceFlagChangeModal',\r\n            invoice_id: invoice_id\r\n        },\r\n        beforeSend:function(){\r\n            berlin3.common.loadWaitModal(300, 130);\r\n        },\r\n        success:function(data){\r\n\r\n            var invoice       = data.invoice || {};\r\n            var countPayments = data.countPayments || 0;\r\n\r\n            if(!invoice.invoice_id) {\r\n                closeMessage();\r\n                return false;\r\n            }\r\n\r\n            var paid_flag            = invoice.paid_flag             || '0';\r\n            var cancelled_flag       = invoice.cancelled_flag        || '0';\r\n            var lock_flag            = invoice.lock_flag             || '0';\r\n\r\n            var invoice_date         = invoice.invoice_date          || '';\r\n            var invoice_ref          = invoice.invoice_ref           || '';\r\n            var amount               = invoice.gross_amount                || '0.00';\r\n            var payments             = invoice.payments              || '0.00';\r\n            var totalPaymentByExRate = payments.totalPaymentByExRate || '0.00';\r\n            var totalPayment         = payments.totalPayment         || '0.00';\r\n            var currency_iso         = invoice.currency_iso          || '';\r\n            var sys_currency_iso     = invoice.sys_currency_iso      || '';\r\n            var accounting_more_flag = invoice.accounting_more_flag  || '';\r\n            var external_table       = invoice.external_table        || '';\r\n            var invoice_project_id   = invoice.invoice_project_id    || '';\r\n\r\n            accounting_more_flag = accounting_more_flag && accounting_more_flag == '1' ? accounting_more_flag : '';\r\n\r\n            var displaySetFullyPaid       = accounting_more_flag && (paid_flag == '0' || paid_flag == '2') && cancelled_flag == '0' ? \"\" : \"dnone\";\r\n            var displaySetPartiallyPaid   = accounting_more_flag && (paid_flag == '0' || paid_flag == '2') && cancelled_flag == '0' ? \"\" : \"dnone\";\r\n            var displayDeletePaymentsOpen = accounting_more_flag && (paid_flag == '1' || paid_flag == '2') && cancelled_flag == '0' ? \"\" : \"dnone\";\r\n            var displayCancelInvoice      = accounting_more_flag && paid_flag  == '0' && cancelled_flag == '0' ? \"\" : \"dnone\";\r\n            var displaySetBadDept         = accounting_more_flag && paid_flag  == '0' && cancelled_flag == '0' && countPayments == 0 ? \"\" : \"dnone\";\r\n            var displayDeleteInvoice      = accounting_more_flag && paid_flag  == '0' && lock_flag == '0' ? \"\" : \"dnone\";\r\n            var displayCreateCreditNote   = cancelled_flag == '0' && external_table != 'accounts' ? \"\" : \"dnone\";\r\n\r\n            var displayArrFlt = [displaySetFullyPaid, displaySetPartiallyPaid, displayDeletePaymentsOpen, displayCreateCreditNote, displayCancelInvoice, displaySetBadDept, displayDeleteInvoice].filter( function (value) { return value == \"\"; } );\r\n\r\n            // var paidAmounts = totalPayment != '0.00' ? berlin3.common.formatMoney(totalPayment, 2, '', '', '.') +\" \"+ currency_iso +\" / \"+ berlin3.common.formatMoney(totalPaymentByExRate, 2, '', '', '.') +\" \"+ sys_currency_iso : \"No Payment\";\r\n\r\n            var paidAmounts = totalPayment != '0.00' ? berlin3.common.formatMoney(totalPaymentByExRate, 2, '', '', '.') +\" \"+ sys_currency_iso : \"No Payment\";\r\n\r\n            var html = berlin3.common.parseRow('#invoices_templates #tpl_invoiceFlagChangeModal', {\r\n                displaySetFullyPaid: displaySetFullyPaid, displaySetPartiallyPaid: displaySetPartiallyPaid, displayDeletePaymentsOpen: displayDeletePaymentsOpen,\r\n                displayCreateCreditNote: displayCreateCreditNote, displayCancelInvoice: displayCancelInvoice, displaySetBadDept: displaySetBadDept,\r\n                displayDeleteInvoice: displayDeleteInvoice, invoice_date: invoice_date, invoice_ref: invoice_ref, amount: amount, paidAmounts: paidAmounts,\r\n                currency_iso: currency_iso, invoice_id: invoice_id, sys_currency_iso: sys_currency_iso, lock_flag: lock_flag, invoice_project_id: invoice_project_id\r\n\r\n            }, undefined, true);\r\n            displayStaticMessage(html, 300, 130 + displayArrFlt.length*40);\r\n\r\n        },\r\n        error:function(){\r\n            closeMessage();\r\n        }\r\n    });\r\n};\r\n\r\nberlin3.invoices.enDisbleDivsOnLockFlag = function(obj) {\r\n\r\n    var invoice_id            = $(obj).attr(\"invoice_id\")           || '';\r\n    var lock_flag             = $(obj).attr(\"lock_flag\")            || '';\r\n    var accounting_more_flag  = $(obj).attr(\"accounting_more_flag\") || '';\r\n    var source                = $(obj).attr(\"source\")               || '';\r\n\r\n    if(invoice_id == '') {\r\n        return false;\r\n    }\r\n\r\n    var check_with_accounting_more_flag = 0;\r\n    if(source == 'paymentsTab') {\r\n        check_with_accounting_more_flag = 1;\r\n    }\r\n\r\n    var $tabDivId              = $(\"#invoice_tabview_\"+ invoice_id);\r\n    var $en_disble_on_lockflag = $tabDivId.find('.en_disble_on_lockflag');\r\n    var $en_disble_link_on_lockflag = $tabDivId.find('.en_disble_link_on_lockflag');\r\n\r\n    var $invoiceListLockedUnlockedImg = $(\"#accounting_invoices\").find(\"#invoices_table_container\").find(\"#invoiceListLockedUnlocked_\"+ invoice_id);\r\n\r\n    if(lock_flag == \"1\" || (check_with_accounting_more_flag && accounting_more_flag != '1') ) {\r\n        $en_disble_on_lockflag.attr('disabled', 'disabled').find(\"*\").attr('disabled', 'disabled').css({\r\n            \"pointer-events\": 'none'\r\n        });\r\n        $en_disble_on_lockflag.find(\"a.deleteRow\").hide();\r\n        $en_disble_on_lockflag.find(\"a.addRow\").hide();\r\n\r\n        $invoiceListLockedUnlockedImg.attr(\"src\", \"/images/newimg/locked.png\").attr('lock_flag', lock_flag);\r\n        \r\n        $en_disble_link_on_lockflag.css({\r\n            \"pointer-events\": 'none',\r\n            \"font-weight\": \"normal\"\r\n        });\r\n\r\n    } else {\r\n        $en_disble_on_lockflag.removeAttr('disabled').find(\"*\").removeAttr('disabled').css({\r\n            \"pointer-events\": 'auto'\r\n        });\r\n        $en_disble_on_lockflag.find(\"a.deleteRow\").show();\r\n        $en_disble_on_lockflag.find(\"a.addRow\").show();\r\n\r\n        $invoiceListLockedUnlockedImg.attr(\"src\", \"/images/newimg/unlocked.png\").attr('lock_flag', lock_flag);\r\n\r\n        $en_disble_link_on_lockflag.css({\r\n            \"pointer-events\": 'painted',\r\n            \"font-weight\": \"bold\"\r\n        })\r\n    }\r\n\r\n};\r\n\r\nberlin3.invoices.createInvoiceCreditNote = function(obj) {\r\n\r\n    var invoice_id = $(obj).attr(\"invoice_id\") || '';\r\n    if(invoice_id == '' || invoice_id == 'undefined') {\r\n        berlin3.common.displayToastr({type: \"error\", msg: \"Oups, Something wrong, please contact your details support\"});\r\n        return false;\r\n    }\r\n\r\n    var $createCreditNoteModal = $(\"#displayCreateCreditNoteModal_\"+ invoice_id);\r\n    var invoice_project_id = $createCreditNoteModal.find('select#invoice_project_id option:selected').val() || '';\r\n\r\n    $.ajax({\r\n        type: 'POST',\r\n        url: \"accounting.pl\",\r\n        data: {\r\n            section: 'invoices',\r\n            action: 'createInvoiceCreditNote',\r\n            invoice_id: invoice_id,\r\n            invoice_project_id: invoice_project_id\r\n        },\r\n        beforeSend:function(){\r\n            /*berlin3.common.displayToastr({type: \"info\", msg: \"Oups, Something wrong, please contact your details support\", timeOut: 5000, showDuration: 500, hideDuration: 1000});*/\r\n            $(obj).prop('disabled', true);\r\n        },\r\n        success:function(data){\r\n\r\n            var done          = data.done          || \"\";\r\n            var newInvoices   = data.newInvoices   || [];\r\n            var newInvoiceId  = data.newInvoiceId  || \"\";\r\n            var newInvoiceRef = data.newInvoiceRef || \"\";\r\n\r\n            if(!done) {\r\n                berlin3.common.displayToastr({type: \"error\", msg: \"Statements and Order Cannot be Credited. Please use Distirbution Orders for Price Adjustments OR Import an inverted Statement\"});\r\n                return false;\r\n            } else {\r\n                berlin3.common.displayToastr({type: \"success\", msg: \"Invoice credit note creating\"});\r\n\r\n                var parentId = '#invoices_table_container';\r\n                var templateId = '#invoices_templates #invoice_row_template';\r\n                newInvoices = berlin3.invoices._proprocessInvoices(newInvoices);\r\n                var html = berlin3.common.listRows(templateId, newInvoices);\r\n                $(parentId).prepend(html);\r\n                berlin3.common.colorRows(parentId);\r\n\r\n                berlin3.common.displayToastr({type: \"info\", msg: \"Opening new created invoice...\"});\r\n                var $newInvoice = $(\"<div />\", { id: \"#newInvoice_\"+ newInvoiceId, invoice_id: newInvoiceId, text: newInvoiceRef });\r\n                berlin3.invoices.openInvoice($newInvoice);\r\n            }\r\n            closeMessage();\r\n\r\n        },\r\n        error:function(){\r\n            berlin3.common.displayToastr({type: \"error\", msg: \"Create invoice credit note failed\"});\r\n            $(obj).prop('disabled', false);\r\n        }\r\n    });\r\n\r\n};\r\n\r\nberlin3.invoices.displayCreateCreditNoteModal = function(obj) {\r\n    var invoice_id          = $(obj).attr(\"invoice_id\")         || '';\r\n    var invoice_project_id  = $(obj).attr(\"invoice_project_id\") || '';\r\n\r\n    if(invoice_id == '') {\r\n        return false;\r\n    }\r\n\r\n    $.ajax({\r\n        type: 'POST',\r\n        url: \"accounting.pl\",\r\n        data: {\r\n            section: 'invoices',\r\n            action: 'displayCreateCreditNoteModal',\r\n            invoice_id: invoice_id\r\n        },\r\n        beforeSend:function(){\r\n            berlin3.common.loadWaitModal(300, 75);\r\n        },\r\n        success:function(data){\r\n\r\n            var invoiceProjects       = data.invoiceProjects || [];\r\n\r\n            if(!invoice_id) {\r\n                closeMessage();\r\n                return false;\r\n            }\r\n\r\n            var invoiceProjects = invoiceProjects.map(function(project) {\r\n               return {value: project.invoice_project_id, label: project.invoice_project_name, selected: project.invoice_project_id == invoice_project_id ? 'selected=\"selected\"' : \"\" };\r\n            });\r\n\r\n            var invioceProjectOptions = berlin3.common.listRows('#invoices_templates #tpl_option', invoiceProjects);\r\n\r\n            var html = berlin3.common.parseRow('#invoices_templates #tpl_displayCreateCreditNoteModal', {\r\n                invioceProjectOptions: invioceProjectOptions, invoice_id: invoice_id\r\n            }, undefined, true);\r\n            displayStaticMessage(html, 300, 75);\r\n\r\n            $('#displayCreateCreditNoteModal_'+ invoice_id +' .required').each(function(i, elm){\r\n                berlin3.common.mandatoryField(elm);\r\n            });\r\n\r\n        },\r\n        error:function(){\r\n            closeMessage();\r\n        }\r\n    });\r\n};\r\n\r\nberlin3.invoices.deleteInvoicePaymentsSetOpen = function(obj) {\r\n\r\n    var invoice_id = $(obj).attr(\"invoice_id\") || '';\r\n    if(invoice_id == '' || invoice_id == 'undefined') {\r\n        berlin3.common.displayToastr({type: \"error\", msg: \"Oups, Something wrong, please contact your details support\"});\r\n        return false;\r\n    }\r\n\r\n    $.ajax({\r\n        type: 'POST',\r\n        url: \"accounting.pl\",\r\n        data: {\r\n            section: 'invoices',\r\n            action: 'deleteInvoicePaymentsSetOpen',\r\n            invoice_id: invoice_id\r\n        },\r\n        beforeSend:function(){\r\n            berlin3.common.displayToastr({type: \"info\", msg: \"Deleting invoice's all payments and changing status to open...\", timeOut: 1000, showDuration: 100});\r\n            $(obj).prop('disabled', true);\r\n        },\r\n        success:function(data){\r\n\r\n            if(!data.done) {\r\n                berlin3.common.displayToastr({type: \"error\", msg: \"Failed to delete invoice payments and change status to open\"});\r\n                $(obj).prop('disabled', false);\r\n                return false;\r\n            } else {\r\n                berlin3.common.displayToastr({type: \"success\", msg: \"Deleted invoice payments and changed status to open\"});\r\n\r\n                berlin3.invoices.updateInvocieStatusDisplayElements({invoice_id: invoice_id, color: data.color, status: '1'});\r\n\r\n                var $paymentsTab = $(\"#payments_div_\"+ invoice_id);\r\n                var $paymentsTable = $paymentsTab.find('#payments_table-'+ invoice_id)\r\n                if($paymentsTable.exists()) {\r\n                    $paymentsTable.html(\"\");\r\n                }\r\n                $(obj).prop('disabled', false);\r\n                closeMessage();\r\n\r\n            }\r\n\r\n        },\r\n        error:function(){\r\n            berlin3.common.displayToastr({type: \"error\", msg: \"Failed to delete invoice payments and change status to open\"});\r\n            $(obj).prop('disabled', false);\r\n        }\r\n    });\r\n\r\n};\r\n\r\nberlin3.invoices.updateInvocieStatusDisplayElements = function(params) {\r\n\r\n    var invoice_id = params.invoice_id || '';\r\n    var color      = params.color      || '';\r\n    var status     = params.status     || '';\r\n\r\n    var $invoiceListTabStatus = $(\"#invoices_table_container\");\r\n    if($invoiceListTabStatus.exists()) {\r\n        $invoiceListTabStatus.find(\"#invoiceRow_\"+ invoice_id).find('.invoice-status-div').css({\r\n            'background-color': color\r\n        });\r\n    }\r\n\r\n    var $selectedInvoiceTab = $(\"#invoice_tabview_\"+ invoice_id);\r\n\r\n    $selectedInvoiceTab.find(\"div.invoice-status-div\").css({\r\n        'background-color': color\r\n    });\r\n\r\n    /*var $infoTabStatus = $selectedInvoiceTab.find(\"select#invoice_status_info_tab_\"+ invoice_id);\r\n    if($infoTabStatus.exists() && status != '') {\r\n        $infoTabStatus.find('option[value='+ status +']').attr('selected','selected');\r\n    }\r\n\r\n    var $paymentTabStatus = $selectedInvoiceTab.find(\"select#invoice_status_payment_tab_\"+ invoice_id);\r\n    if($infoTabStatus.exists()  && status != '') {\r\n        $paymentTabStatus.find('option[value='+ status +']').attr('selected','selected');\r\n    }*/\r\n\r\n};\r\n\r\nberlin3.invoices.setInvoiceToBadDept = function(obj) {\r\n\r\n    var invoice_id = $(obj).attr(\"invoice_id\") || '';\r\n    if(invoice_id == '' || invoice_id == 'undefined') {\r\n        berlin3.common.displayToastr({type: \"error\", msg: \"Oups, Something wrong, please contact your details support\"});\r\n        return false;\r\n    }\r\n\r\n    $.ajax({\r\n        type: 'POST',\r\n        url: \"accounting.pl\",\r\n        data: {\r\n            section: 'invoices',\r\n            action: 'setInvoiceToBadDept',\r\n            invoice_id: invoice_id\r\n        },\r\n        beforeSend:function(){\r\n            $(obj).prop('disabled', true);\r\n            berlin3.common.displayToastr({type: \"info\", msg: \"Setting to bad debt\", timeOut: 500, showDuration: 100, hideDuration: 100});\r\n        },\r\n        success:function(data){\r\n\r\n            $(obj).prop('disabled', false);\r\n            if(!data.done) {\r\n                berlin3.common.displayToastr({type: \"error\", msg: \"Failed to set to bad debt.\"});\r\n                return false;\r\n            } else {\r\n                berlin3.common.displayToastr({type: \"success\", msg: \"Successfully set to bad debt\"});\r\n                berlin3.invoices.updateInvocieStatusDisplayElements({ invoice_id: invoice_id, color: data.color });\r\n                closeMessage();\r\n            }\r\n\r\n        },\r\n        error:function(){\r\n            $(obj).prop('disabled', false);\r\n            berlin3.common.displayToastr({type: \"error\", msg: \"Failed to set to bad debt.\"});\r\n        }\r\n    });\r\n\r\n};\r\n\r\nberlin3.invoices.displayPaidModal = function(obj) {\r\n\r\n    var invoice_id    = $(obj).attr(\"invoice_id\")    || '';\r\n    var fullOrPartial = $(obj).attr(\"fullOrPartial\") || ''; // 3 = full paid and 2 = partial paid\r\n    var lock_flag     = $(obj).attr(\"lock_flag\")     || '';\r\n\r\n    var modalHeight = 315;\r\n\r\n    if(invoice_id == '' || invoice_id == 'undefined') {\r\n        berlin3.common.displayToastr({type: \"error\", msg: \"Oups, Something wrong, please contact your details support\"});\r\n        return false;\r\n    }\r\n\r\n    $.ajax({\r\n        type: 'POST',\r\n        url: \"accounting.pl\",\r\n        data: {\r\n            section: 'invoices',\r\n            action: 'getPaidModalInfo',\r\n            invoice_id: invoice_id\r\n        },\r\n        beforeSend:function(){\r\n            berlin3.common.displayToastr({type: \"info\", msg: \"Openning modal\", timeOut: 500, showDuration: 300, hideDuration: 300});\r\n            berlin3.common.loadWaitModal(300, modalHeight);\r\n        },\r\n        success:function(data){\r\n\r\n            var invoice       = data.invoice        || {};\r\n            var payments      = data.payments       || [];\r\n            var moneyAccounts = data.moneyAccounts  || [];\r\n            var today         = data.today          || '';\r\n\r\n            if(!invoice.invoice_id) {\r\n                closeMessage();\r\n                return false;\r\n            }\r\n\r\n            var invoice_date         = invoice.invoice_date         || '';\r\n            var invoice_ref          = invoice.invoice_ref          || '';\r\n            var amount               = invoice.amount               || '0.00';\r\n            var currency_iso         = invoice.currency_iso         || '';\r\n            var currency_id          = invoice.currency_id          || '';\r\n            var sys_currency         = invoice.sys_currency         || {};\r\n            var money_account_id     = invoice.money_account_id     || '';\r\n\r\n            var sys_currency_iso     = sys_currency.currency_iso    || '';\r\n            var sys_currency_exrate  = 1;\r\n            var sys_currency_id      = sys_currency.currency_id     || 1;\r\n\r\n            var displaySetFullyPaid       = fullOrPartial == \"3\" ? \"\" : \"dnone\";\r\n            var displaySetPartiallyPaid   = fullOrPartial == \"2\" ? \"\" : \"dnone\";\r\n\r\n            var moneyAccounts = moneyAccounts.map(function(money) {\r\n               return {value: money.money_account_id, label: money.money_account_name, selected: money.money_account_id == money_account_id ? 'selected=\"selected\"' : \"\" };\r\n            });\r\n\r\n            var displayPaymentList = 'dnone';\r\n            var displayOnePayment  = 'dnone';\r\n\r\n            var paymentsHtml         = '';\r\n            var totalPaymentByExRate = '0.00';\r\n            if(payments.length == 1) {\r\n\r\n                displayOnePayment = '';\r\n                // paymentsHtml      = berlin3.common.formatMoney(payments[0].amount, 2, '', '', '.') +\" \"+ payments[0].currency_iso +\" / \"+ berlin3.common.formatMoney(payments[0].paymentByExRate, 2, '', '', '.') +\" \"+ sys_currency_iso;\r\n\r\n                paymentsHtml      = berlin3.common.formatMoney(payments[0].paymentByExRate, 2, '', '', '.') +\" \"+ sys_currency_iso;\r\n\r\n            } else if(payments.length == 0) {\r\n\r\n                paymentsHtml      = \"No Payment\";\r\n                displayOnePayment = '';\r\n\r\n            } else if(payments.length > 1) {\r\n\r\n                var payments = payments.map(function(pay) {\r\n                   pay.sys_currency_iso = sys_currency_iso;\r\n                   return pay;\r\n                });\r\n                totalPaymentByExRate = payments.reduce(\r\n                    function(total, payment){ return parseFloat(total) + parseFloat(payment.paymentByExRate) }\r\n                , 0.00);\r\n                totalPaymentByExRate = berlin3.common.formatMoney(totalPaymentByExRate, 2, '', '', '.');\r\n                paymentsHtml         = berlin3.common.listRows('#invoices_templates #tpl_paidModalPaymentRow', payments);\r\n                displayPaymentList   = '';\r\n                modalHeight          = 325;\r\n            }\r\n\r\n            // already paid then display 0\r\n            //amount = payments.length == 0 ? invoice.amount : '0.00';\r\n            var gross_amount_cc = (payments.length > 0 || currency_iso != sys_currency_iso) ? '' : invoice.amount;\r\n\r\n            var displayExrate             = \"dnone\"; // cause currency is always sys_currency.\r\n\r\n            /** i have to seperate js code from this seelct field */\r\n            var pattern = 'option value=\"' + sys_currency_id + '\"';\r\n            var currencies_html = $('#invoices_templates #currency_list').html();\r\n            currencies_html = currencies_html.replace(/<select>/, '<select id=\"currency_id\" style=\"width: 53%;\" onchange=\"var selectedCur=$(\\'option:selected\\', this).val(); var exrate=$(\\'option:selected\\', this).attr(\\'exchange_rate\\'); var $exrateDiv = $(\\'#displayPaidModal_'+ invoice_id +'\\').find(\\'div#exRateFieldGourp\\'); var $exrateField = $(\\'#displayPaidModal_'+ invoice_id +'\\').find(\\'input#exchangerate\\'); $exrateField.val(exrate); if(selectedCur != \\''+ sys_currency_id +'\\'){$exrateDiv.removeClass(\\'dnone\\');}else{$exrateDiv.addClass(\\'dnone\\');} console.log(selectedCur, exrate, $exrateDiv, $exrateField);\">');\r\n            currencies_html = currencies_html.replace(pattern, pattern + ' selected=\"selected\"');\r\n\r\n\r\n            var moneyAccountOptions = berlin3.common.listRows('#invoices_templates #tpl_option', moneyAccounts);\r\n\r\n            var html = berlin3.common.parseRow('#invoices_templates #tpl_displayPaidModal', {\r\n                displaySetFullyPaid: displaySetFullyPaid, displaySetPartiallyPaid: displaySetPartiallyPaid, invoice_date: invoice_date, invoice_ref: invoice_ref,\r\n                amount: amount, currency_iso: currency_iso, invoice_id: invoice_id, paymentsHtml: paymentsHtml, today: today, gross_amount_cc: gross_amount_cc,\r\n                sys_currency_exrate: sys_currency_exrate, currencies_list: currencies_html, fullOrPartial: fullOrPartial, lock_flag: lock_flag,\r\n                displayPaymentList: displayPaymentList, moneyAccountOptions: moneyAccountOptions, displayOnePayment: displayOnePayment,\r\n                totalPaymentByExRate: totalPaymentByExRate, sys_currency_iso: sys_currency_iso, displayExrate: displayExrate\r\n\r\n            }, undefined, true);\r\n            displayStaticMessage(html, 300, modalHeight + (payments.length*25 > 100 ? 100 : payments.length*25));\r\n\r\n            $('#displayPaidModal_'+ invoice_id +' .required').each(function(i, elm){\r\n                berlin3.common.mandatoryField(elm);\r\n            });\r\n\r\n        },\r\n        error:function(){\r\n            berlin3.common.displayToastr({type: \"error\", msg: \"Failed to open modal\"});\r\n        }\r\n    });\r\n\r\n};\r\n\r\nberlin3.invoices.checkCurrencyRateLimit = function(obj) {\r\n\r\n    let invoice_id    = $(obj).attr(\"invoice_id\")    || '';\r\n    let fullOrPartial = $(obj).attr(\"fullOrPartial\") || ''; // 3 = full paid and 2 = partial paid\r\n\r\n    if(invoice_id == '' || invoice_id == 'undefined') {\r\n        berlin3.common.displayToastr({type: \"error\", msg: \"Oups, Something wrong, please contact your details support\"});\r\n        return false;\r\n    }\r\n\r\n    var $formDiv = $(\"#displayPaidModal_\"+ invoice_id);\r\n    var date             = $formDiv.find(\"#date\").val()                                   || \"\";\r\n    var amount           = $formDiv.find(\"#amount\").val()                                 || \"\";\r\n    var exchangerate     = $formDiv.find(\"#exchangerate\").val()                           || \"\";\r\n    var currency_id      = $formDiv.find('select#currency_id option:selected').val()      || '';\r\n    var money_account_id = $formDiv.find('select#money_account_id option:selected').val() || '';\r\n\r\n    if( !berlin3.invoices.checkPaidModalInfo({ date: date, amount: amount}) ) {\r\n        return false;\r\n    }\r\n\r\n    $.ajax({\r\n        type: 'POST',\r\n        url: \"accounting.pl\",\r\n        data: {\r\n            section: 'invoices',\r\n            action: 'checkCurrencyRateLimit',\r\n            invoice_id: invoice_id,\r\n            amount: amount,\r\n            exchangerate: exchangerate,\r\n        },\r\n        beforeSend:function(){\r\n            berlin3.common.displayToastr({type: \"info\", msg: \"Please wait...\", timeOut: 500, showDuration: 500, hideDuration: 500});\r\n            $(obj).prop('disabled', true);\r\n        },\r\n        success:function(data){\r\n            let ccrl = data.checkCurrencyRateLimit || {};\r\n            let system_currency = data.system_currency_iso || '';\r\n\r\n\r\n            let invoice_amount   = ccrl.invoice_amount || (0).toFixed(2);\r\n            let payment_amount   = ccrl.payment_amount || (0).toFixed(2);\r\n            let invoice_currency = ccrl.invoice_currency || '';\r\n            let passed           = ccrl.passed || 0;\r\n\r\n            if(passed) {\r\n                // let $div = $('<div></div>').attr('invoice_id', invoice_id).attr('fullOrPartial', fullOrPartial)\r\n                //             .attr('date', date).attr('amount', amount).attr('exchangerate', exchangerate).attr('currency_id', currency_id)\r\n                //             .attr('money_account_id', money_account_id);\r\n                // let msg = `\r\n                //     <p style=\"text-align: left;\">The Payments for this Invoice is more than 25% Off to the current Rate. Please doublecheck.<br/><br/>\r\n                //     Invoice Amount: ${invoice_amount} ${invoice_currency}<br/>\r\n                //     Payments: ${payment_amount} ${system_currency}</p>\r\n                // `;\r\n\r\n                // BERLIN3.common.confirm_box( msg, 'ok', 'cancel', 115, 480, berlin3.invoices.savePaidModalInfo(obj);, 'closeMessage();');\r\n\r\n                let formated_invoice_amount = berlin3.common.formatMoney(invoice_amount, 2, '', '', '.');\r\n                let formated_payment_amount = berlin3.common.formatMoney(payment_amount, 2, '', '', '.');\r\n\r\n\r\n                var msg = `\r\n                    <div class=\"mb10\">\r\n                    <font size=\"2\" style=\"font-weight:bold;\">\r\n                        The payment for this invoice is more than 25% off the current exchange rate. Please doublecheck!\r\n                        <br/><br/>\r\n                        Invoice Amount: ${formated_invoice_amount} ${invoice_currency}<br/>\r\n                        Payments: ${formated_payment_amount} ${system_currency}\r\n                    </font></div>\r\n\r\n                    <div style=\"text-align: right;\">\r\n                        <input type=\"button\" value=\"Cancel\" onclick=\"closeMessage();\"/>\r\n                        <input type=\"button\" value=\"Proceed anyway\" invoice_id=\"${invoice_id}\" fullOrPartial=\"${fullOrPartial}\" date=\"${date}\" amount=\"${amount}\" exchangerate=\"${exchangerate}\" currency_id=\"${currency_id}\" money_account_id=\"${money_account_id}\" onclick=\"berlin3.invoices.savePaidModalInfo(this);\" />\r\n                    </div>\r\n                `;\r\n                displayStaticMessage(msg, 400, 115);\r\n\r\n            } else {\r\n                $(obj).attr(\"date\", date);\r\n                $(obj).attr(\"amount\", amount);\r\n                $(obj).attr(\"exchangerate\", exchangerate);\r\n                $(obj).attr(\"currency_id\", currency_id);\r\n                $(obj).attr(\"money_account_id\", money_account_id);\r\n\r\n                berlin3.invoices.savePaidModalInfo(obj);\r\n            }\r\n\r\n        },\r\n        error:function(){\r\n            berlin3.common.displayToastr({type: \"error\", msg: \"Failed to add payment\"});\r\n        }\r\n    });\r\n\r\n    return false;\r\n};\r\n\r\nberlin3.invoices.checkPaidModalInfo = function(obj) {\r\n\r\n    let date             = $(obj).attr(\"date\")             || '';\r\n    let amount           = $(obj).attr(\"amount\")           || '';\r\n\r\n    if(isNaN(amount)) {\r\n        berlin3.common.displayToastr({type: \"error\", msg: \"please use . ( dot ) as decimal seperator\"});\r\n        return false;\r\n    }\r\n\r\n    // console.log(!date, amount == '', amount);\r\n    if( !date || amount == '') {\r\n        berlin3.common.displayToastr({type: \"error\", msg: \"Please fill the mandatory fields and submit again\"});\r\n        return false;\r\n    }\r\n\r\n    return true;\r\n};\r\n\r\nberlin3.invoices.savePaidModalInfo = function(obj) {\r\n\r\n    var invoice_id    = $(obj).attr(\"invoice_id\")    || '';\r\n    var fullOrPartial = $(obj).attr(\"fullOrPartial\") || ''; // 3 = full paid and 2 = partial paid\r\n\r\n    // if(invoice_id == '' || invoice_id == 'undefined') {\r\n    //     berlin3.common.displayToastr({type: \"error\", msg: \"Oups, Something wrong, please contact your details support\"});\r\n    //     return false;\r\n    // }\r\n    //\r\n    let date             = '';\r\n    let amount           = '';\r\n    let exchangerate     = '';\r\n    let currency_id      = '';\r\n    let money_account_id = '';\r\n\r\n    if(fullOrPartial == 2) { // partially paid\r\n        let $formDiv = $(\"#displayPaidModal_\"+ invoice_id);\r\n        date             = $formDiv.find(\"#date\").val()                                   || \"\";\r\n        amount           = $formDiv.find(\"#amount\").val()                                 || \"\";\r\n        exchangerate     = $formDiv.find(\"#exchangerate\").val()                           || \"\";\r\n        currency_id      = $formDiv.find('select#currency_id option:selected').val()      || '';\r\n        money_account_id = $formDiv.find('select#money_account_id option:selected').val() || '';\r\n\r\n        // console.log(!isNaN(amount), isNaN(amount), amount);\r\n        if( !berlin3.invoices.checkPaidModalInfo({ date: date, amount: amount}) ) {\r\n            return false;\r\n        }\r\n\r\n    } else { // fully paid\r\n\r\n        date             = $(obj).attr(\"date\")             || '';\r\n        amount           = $(obj).attr(\"amount\")           || '';\r\n        exchangerate     = $(obj).attr(\"exchangerate\")     || '';\r\n        currency_id      = $(obj).attr(\"currency_id\")      || '';\r\n        money_account_id = $(obj).attr(\"money_account_id\") || '';\r\n    }\r\n\r\n    $.ajax({\r\n        type: 'POST',\r\n        url: \"accounting.pl\",\r\n        data: {\r\n            section: 'invoices',\r\n            action: 'savePaidModalInfo',\r\n            invoice_id: invoice_id,\r\n            fullOrPartial: fullOrPartial,\r\n            date: date,\r\n            amount: amount,\r\n            exchangerate: exchangerate,\r\n            currency_id: currency_id,\r\n            debit_credit: 1,\r\n            money_account_id: money_account_id\r\n        },\r\n        beforeSend:function(){\r\n            berlin3.common.displayToastr({type: \"info\", msg: \"Adding payment...\", timeOut: 500, showDuration: 500, hideDuration: 500});\r\n            $(obj).prop('disabled', true);\r\n        },\r\n        success:function(data){\r\n\r\n            if(!data.done) {\r\n                berlin3.common.displayToastr({type: \"error\", msg: \"Failed to add payment\"});\r\n                return false;\r\n            } else {\r\n\r\n                berlin3.common.displayToastr({type: \"success\", msg: \"Successfully added payment\"});\r\n\r\n                BERLIN3.common.wait('accounting_costs_tab #costs_div');\r\n                closeMessage();\r\n                berlin3.invoices.updateInvocieStatusDisplayElements({invoice_id: invoice_id, color: data.color, status: fullOrPartial});\r\n\r\n                var $payments_list_div = $(\"#invoice_tabview_\"+ invoice_id).find('#payments_div_'+ invoice_id);\r\n                if($payments_list_div.exists()) {\r\n                    $payments_list_div.load('accounting.pl', {\r\n                        section: 'invoices',\r\n                        action: 'reloadPaymentList',\r\n                        invoice_id: invoice_id\r\n                    }, function() {\r\n\r\n                        berlin3.invoices.enDisbleDivsOnLockFlag(obj);\r\n                    });\r\n                }\r\n            }\r\n\r\n        },\r\n        error:function(){\r\n            berlin3.common.displayToastr({type: \"error\", msg: \"Failed to add payment\"});\r\n        }\r\n    });\r\n\r\n};\r\n\r\n// Forward icon tooltip\r\nberlin3.invoices.onInvoiceForwardingIconMouseHover = function(dom, event) {\r\n    if(!$(event.target).hasClass('forwarding-icon')){\r\n        return false;\r\n    }\r\n    \r\n    let obj = $(dom);\r\n    // let objTooltipText = obj.children('.tooltiptext');\r\n    let objTooltipText = $('.forwardingTooltipContainer');\r\n    let invoice_id = obj.attr('invoice_id');\r\n\r\n    const rowHeading = `<div class=\"hdiv\">\r\n        <span class=\"htext column\" style=\"width:15%;\">Date</span>\r\n        <span class=\"htext column\" style=\"width:38%;\">Recipient</span>\r\n        <span class=\"htext column\" style=\"width:25%;\">Notes</span>\r\n        <span class=\"htext rcolumn\" style=\"width:18%;\">Amount</span>\r\n    </div>`;\r\n\r\n    const rowTemplate = `<div class=\"row\" style=\"padding-top:3px;min-height:16px\" id=\"tooltipForwardingPaymentRow_{payment_id}\">\r\n            <span class=\"column\" style=\"width:15%;\">{date}</span>\r\n            <span class=\"column\" style=\"width:38%;\">{recipient}</span>\r\n            <span class=\"column\" style=\"width:33%;\">{notes}</span>\r\n            <span class=\"column\" style=\"width:11%;\">{amount}</span>\r\n        </div>`;\r\n        \r\n    objTooltipText.html(berlin3.common.wait());\r\n\r\n    var x = event.clientX,\r\n        y = event.clientY;\r\n    let top = (y + 1) + 'px';\r\n    let left = (x - objTooltipText.outerWidth() + 20) + 'px';\r\n    objTooltipText.css({top, left, display:'block', position:'fixed'});\r\n\r\n    let res = $.get('accounting.pl', {section: 'invoices', action: 'invoice_tab_forwarding', invoice_id}, function(data){\r\n        var html = `${rowHeading}<div class=\"h00\" id=\"tooltipForwardingPaymentRowContainer\">` + berlin3.common.listRows('', data.artist_payments, rowTemplate) + `</div>`;\r\n        objTooltipText.html(html);\r\n        berlin3.common.colorRows('#tooltipForwardingPaymentRowContainer');\r\n    });\r\n    // console.log('forwarding invoice_id: ', obj.attr('invoice_id'));\r\n\r\n    objTooltipText.data('isHide', 'yes');\r\n\r\n    objTooltipText.off('mouseover mouseout');\r\n    objTooltipText.on('mouseover', function(){\r\n        $(this).data('isHide', 'no');\r\n        $(this).css('display', 'block');\r\n    });\r\n    objTooltipText.on('mouseout', function(){\r\n        $(this).css('display', 'none');\r\n    });\r\n};\r\n\r\nberlin3.invoices.onInvoiceForwardingIconMouseout = function(dom, event) {\r\n    let objTooltipText = $('.forwardingTooltipContainer');    \r\n    setTimeout(() => {\r\n        if(objTooltipText.data('isHide') == 'yes'){\r\n            objTooltipText.css({display:'none'});\r\n        }  \r\n    }, 3000);    \r\n}\r\n\r\nberlin3.invoices.edicotSendInvoice = function(obj) {\r\n    \r\n    const invoice_id = obj.getAttribute('invoice_id') || '';\r\n    const order_id   = obj.getAttribute('order_id')   || '';\r\n    const shipped    = obj.getAttribute('shipped')    || '';\r\n    \r\n    // if(!invoice_id || !order_id || shipped != 'shipped') {\r\n    if( !invoice_id ) {\r\n        berlin3.common.displayToastr({ type: 'error', msg: `data missing` });\r\n        return;\r\n    }\r\n\r\n    berlin3.common.makeBtnLoading(obj);\r\n\r\n    let ids = [ { order_id, invoice_id } ];\r\n\r\n    berlin3.ajax\r\n    .post('distribution.pl', {\r\n        section: 'orders',\r\n        action: \"send_invoices_to_edi\",\r\n        ids: JSON.stringify(ids)\r\n    })\r\n    .then(res => res.json()).then(data => {\r\n        let { sent  } = data;\r\n\r\n        berlin3.common.releaseBtnLoading(obj);\r\n\r\n        if(sent) {\r\n            obj.style.display = 'none';\r\n            berlin3.common.displayToastr({ type: 'success', msg: `${window?.i18nDistribution?.edi_invoices_sent_successfully}` });\r\n        }\r\n\r\n    });\r\n    \r\n\r\n};\r\n\r\n// Forward icon tooltip END\r\n\r\n//////////////////////////  event handler //////////////////////////////////////////////////////\r\nberlin3.invoices.msgHandler = function(msg, obj) {\r\n\tswitch(msg) {\r\n\t\tcase 'pick_date':\r\n\t\t\tberlin3.invoices.addDatePicker(obj);\r\n\t\t\tbreak;\r\n\t\tcase 'str_filter_invoice':\r\n\t\t\tif (berlin3.common.isInputChanged(obj)) {\r\n\t\t\t\tberlin3.invoices.filter_invoice(obj);\r\n\t\t\t}\r\n\t\t\tbreak;\r\n\t\tcase 'save_payment_field':\r\n\t\t\tberlin3.invoices.saveField(obj);\r\n\t\t\tbreak;\r\n\t\tcase 'artist_exchangerate_calculation':\r\n\t\t\tberlin3.invoices.artist_exchangerate_calculation(obj);\r\n\t\t\tbreak;\r\n\t\tcase 'agent_exchangerate_calculation':\r\n\t\t\tberlin3.invoices.agent_exchangerate_calculation(obj);\r\n\t\t\tbreak;\r\n\t\tcase 'save_first_offer_notes':\r\n\t\t\tberlin3.invoices.saveFirstOfferNotes(obj);\r\n\t\t\tbreak;\r\n\r\n\t}\r\n};\r\n\r\n$('#accounting_invoices').click(function(event){\r\n\tvar domObj = event.target;\r\n\tif ($(domObj).is('.open-invoice')) {\r\n\t\tberlin3.invoices.openInvoice(domObj);\r\n\t}\r\n\telse if ($(domObj).is('.add-payment')) {\r\n\t\tberlin3.invoices.editInvoice(domObj);\r\n\t}\r\n\telse if ($(domObj).is('.print-invoice')) {\r\n\t\tberlin3.invoices.printInvoice(domObj);\r\n\t}\r\n\telse if ($(domObj).is('.delete-invoice')) {\r\n\t\tberlin3.invoices.invoiceCancelDeletePreChecking(domObj);\r\n\t}\r\n\telse if ($(domObj).is('.tax-deduction')) {\r\n\t\tberlin3.invoices.loadTaxTypeDeduction(domObj);\r\n\t}\r\n\telse if ($(domObj).is('.add-artist-forwarding')) {\r\n\t\tberlin3.invoices.addArtistFowarding(domObj);\r\n\t}\r\n\telse if ($(domObj).is('.add-agent-forwarding')) {\r\n\t\tberlin3.invoices.addAgentFowarding(domObj);\r\n\t}\r\n\telse if ($(domObj).is('.remove-payment')) {\r\n\t\tberlin3.invoices.removePayment(domObj);\r\n\t}\r\n    else if ($(domObj).is('.invoice-email')) {\r\n        berlin3.common.accounting.displayPaypalPaymentMsgModal(domObj);\r\n\t}\r\n\r\n});\r\n\r\n$('#accounting_invoices').on('click', 'input.refresh-invoice-overview', function(evt) {\r\n\tlet invoice_id = $(evt.target).attr('invoice_id');\r\n\tlet divId = `tabViewinvoice_tabview_${invoice_id}_0`;\r\n\tBERLIN3.common.wait(divId);\r\n\t$(`#${divId}`).load('accounting.pl', {\r\n\t\tsection: 'invoices',\r\n\t\taction: 'invoice_tab_invoice_info',\r\n\t\tinvoice_id: invoice_id\r\n\t});\r\n});\r\n\r\n$('#accounting_invoices').on('click', 'input#refresh_invoice_list', function(evt) {\r\n\tBERLIN3.common.wait('invoices_table_container');\r\n\tberlin3.invoices.loadInvoices();\r\n});\r\n\r\n$('#accounting_invoices').on('click', 'input.go-to-order', function(evt) {\r\n\tlet $btn = $(evt.target);\r\n\tlet order_id = $btn.attr('order_id');\r\n\t$.post('distribution.pl', {\r\n\t\tsection: 'orders',\r\n\t\taction: 'get_order',\r\n\t\torder_id: order_id\r\n\t}, function(data) {\r\n\t\tberlin3.common.openOrder(data.order);\r\n\t});\r\n});\r\n\r\n///////////////////////// init ////////////////////////////////////////////////////////\r\n(function() {\r\n\tberlin3.common.compressHtml($('#invoices_templates').get(0));\r\n\tBERLIN3.common.wait('invoices_table_container');\r\n\tvar invoice_type = '';\r\n\tif (invoice_type == 'contact_related_invoices') {\r\n\t\tvar company_name = '';\r\n\t\tvar first_name = '';\r\n\t\tvar last_name = '';\r\n\r\n\t\tif (company_name) {\r\n\t\t\t$('#search_invoices').val(company_name);\r\n\t\t}\r\n\t\telse {\r\n\t\t\t$('#search_invoices').val(first_name + ' ' + last_name);\r\n\t\t}\r\n\r\n\t\t$.post('accounting.pl', {\r\n\t\t\tsection: 'invoices',\r\n\t\t\taction: 'contact_invoices',\r\n\t\t\tcontact_id: ''\r\n\t\t}, function(invoices){\r\n\t\t\tberlin3.invoices.renderInvoices(invoices);\r\n\t\t}, \"json\");\r\n\t}\r\n\telse if (invoice_type == 'booking_invoices') {\r\n\t\t$.post('accounting.pl', {\r\n\t\t\tsection: 'invoices',\r\n\t\t\taction: 'booking_invoices',\r\n\t\t\tcalendar_date_id: ''\r\n\t\t}, function(invoices){\r\n\t\t\tberlin3.invoices.renderInvoices(invoices);\r\n\t\t}, \"json\");\r\n\t}\r\n\telse {\r\n\t\tberlin3.invoices.loadInvoices();\r\n\t}\r\n\t$('#search_invoices').focus();\r\n    $('#invoice_table_header').find('#invoice_statuses').multipleSelect({ width: '90%'});\r\n})();\r\n</script>\r\n"
          },
          "redirectURL": "",
          "headersSize": 531,
          "bodySize": 20370
        },
        "cache": {},
        "timings": {
          "blocked": 0,
          "dns": 0,
          "connect": 0,
          "ssl": 0,
          "send": 0,
          "wait": 690,
          "receive": 228
        },
        "time": 918,
        "_securityState": "secure",
        "serverIPAddress": "79.125.7.197",
        "connection": "443",
        "pageref": "page_2"
      },
      {
        "startedDateTime": "2023-08-02T17:02:12.379+06:00",
        "request": {
          "bodySize": 0,
          "method": "GET",
          "url": "https://dev.berlin3.com/designcheck/accounting.pl?section=invoices&action=invoice_detail&invoice_id=575&rndval=1690974132379",
          "httpVersion": "HTTP/1.1",
          "headers": [
            {
              "name": "Host",
              "value": "dev.berlin3.com"
            },
            {
              "name": "User-Agent",
              "value": "Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/115.0"
            },
            {
              "name": "Accept",
              "value": "*/*"
            },
            {
              "name": "Accept-Language",
              "value": "en-US,en;q=0.5"
            },
            {
              "name": "Accept-Encoding",
              "value": "gzip, deflate, br"
            },
            {
              "name": "Referer",
              "value": "https://dev.berlin3.com/designcheck/index.pl?start=1"
            },
            {
              "name": "Connection",
              "value": "keep-alive"
            },
            {
              "name": "Cookie",
              "value": "DISKO::AUTH_berlin3=geralt:2023-08-02-08-05-30:2023-08-04-08-05-30::e60a2e76975475a2a5584c7f616a3df2; mainWindow=width%3A990%2Cheight%3A620%2CxPos%3A0%2CyPos%3A0%2CzIndex%3A%2CactiveTabId%3AAccounting%2Cstate%3Aundefined; WindowSettings=width%3A990%2Cheight%3A600%2CxPos%3A2%2CyPos%3A2%2CzIndex%3A%2CactiveTabId%3ABookingSettingsTab%2Cstate%3Aundefined; WindowAccounting=width%3A990%2Cheight%3A600%2CxPos%3A2%2CyPos%3A2%2CzIndex%3A%2CactiveTabId%3AAccInvoicesTab%2Cstate%3Aundefined; WindowBooking=width%3A990%2Cheight%3A600%2CxPos%3A2%2CyPos%3A2%2CzIndex%3A%2CactiveTabId%3ABookCalendarTab%2Cstate%3Aundefined; WindowLabel=width%3A990%2Cheight%3A600%2CxPos%3A2%2CyPos%3A2%2CzIndex%3A%2CactiveTabId%3ALabelRoyaltyTab%2Cstate%3Aundefined; WindowDistribution=width%3A990%2Cheight%3A600%2CxPos%3A2%2CyPos%3A2%2CzIndex%3A%2CactiveTabId%3ADistAccountsTab%2Cstate%3Aundefined; WindowContacts=width%3A990%2Cheight%3A600%2CxPos%3A2%2CyPos%3A2%2CzIndex%3A%2CactiveTabId%3AGenContactsTab%2Cstate%3Aundefined; chatbox_minimized=Support%7CSupport; _ga=GA1.2.2001653648.1668753357; _ga_4GJL8L77LJ=GS1.1.1683275798.7.0.1683275798.0.0.0; _ga_BM42RTS79Q=GS1.2.1690175692.1.1.1690176135.0.0.0; CGISESSID=d13ec288b68da2ce5a3b6408ced3df7a"
            },
            {
              "name": "Sec-Fetch-Dest",
              "value": "empty"
            },
            {
              "name": "Sec-Fetch-Mode",
              "value": "cors"
            },
            {
              "name": "Sec-Fetch-Site",
              "value": "same-origin"
            }
          ],
          "cookies": [
            {
              "name": "DISKO::AUTH_berlin3",
              "value": "geralt:2023-08-02-08-05-30:2023-08-04-08-05-30::e60a2e76975475a2a5584c7f616a3df2"
            },
            {
              "name": "mainWindow",
              "value": "width:990,height:620,xPos:0,yPos:0,zIndex:,activeTabId:Accounting,state:undefined"
            },
            {
              "name": "WindowSettings",
              "value": "width:990,height:600,xPos:2,yPos:2,zIndex:,activeTabId:BookingSettingsTab,state:undefined"
            },
            {
              "name": "WindowAccounting",
              "value": "width:990,height:600,xPos:2,yPos:2,zIndex:,activeTabId:AccInvoicesTab,state:undefined"
            },
            {
              "name": "WindowBooking",
              "value": "width:990,height:600,xPos:2,yPos:2,zIndex:,activeTabId:BookCalendarTab,state:undefined"
            },
            {
              "name": "WindowLabel",
              "value": "width:990,height:600,xPos:2,yPos:2,zIndex:,activeTabId:LabelRoyaltyTab,state:undefined"
            },
            {
              "name": "WindowDistribution",
              "value": "width:990,height:600,xPos:2,yPos:2,zIndex:,activeTabId:DistAccountsTab,state:undefined"
            },
            {
              "name": "WindowContacts",
              "value": "width:990,height:600,xPos:2,yPos:2,zIndex:,activeTabId:GenContactsTab,state:undefined"
            },
            {
              "name": "chatbox_minimized",
              "value": "Support|Support"
            },
            {
              "name": "_ga",
              "value": "GA1.2.2001653648.1668753357"
            },
            {
              "name": "_ga_4GJL8L77LJ",
              "value": "GS1.1.1683275798.7.0.1683275798.0.0.0"
            },
            {
              "name": "_ga_BM42RTS79Q",
              "value": "GS1.2.1690175692.1.1.1690176135.0.0.0"
            },
            {
              "name": "CGISESSID",
              "value": "d13ec288b68da2ce5a3b6408ced3df7a"
            }
          ],
          "queryString": [
            {
              "name": "section",
              "value": "invoices"
            },
            {
              "name": "action",
              "value": "invoice_detail"
            },
            {
              "name": "invoice_id",
              "value": "575"
            },
            {
              "name": "rndval",
              "value": "1690974132379"
            }
          ],
          "headersSize": 1697
        },
        "response": {
          "status": 200,
          "statusText": "OK",
          "httpVersion": "HTTP/1.1",
          "headers": [
            {
              "name": "Date",
              "value": "Wed, 02 Aug 2023 11:02:12 GMT"
            },
            {
              "name": "Server",
              "value": "Apache/2.4.52 (Ubuntu) OpenSSL/3.0.2 mod_perl/2.0.12 Perl/v5.34.0"
            },
            {
              "name": "Set-Cookie",
              "value": "DISKO::AUTH_berlin3=geralt:2023-08-02-08-05-30:2023-08-04-08-05-30::e60a2e76975475a2a5584c7f616a3df2; expires=Fri, 04 Aug 2023 11:02:12 GMT; path=/designcheck/; domain=.berlin3.com"
            },
            {
              "name": "Vary",
              "value": "Accept-Encoding"
            },
            {
              "name": "Content-Encoding",
              "value": "gzip"
            },
            {
              "name": "Access-Control-Allow-Credentials",
              "value": "true"
            },
            {
              "name": "Content-Length",
              "value": "524"
            },
            {
              "name": "Keep-Alive",
              "value": "timeout=30, max=97"
            },
            {
              "name": "Connection",
              "value": "Keep-Alive"
            },
            {
              "name": "Content-Type",
              "value": "text/html; charset=utf-8"
            }
          ],
          "cookies": [
            {
              "name": "DISKO::AUTH_berlin3",
              "value": "geralt:2023-08-02-08-05-30:2023-08-04-08-05-30::e60a2e76975475a2a5584c7f616a3df2"
            }
          ],
          "content": {
            "mimeType": "text/html; charset=utf-8",
            "size": 1640,
            "text": "\r\n<div id=\"invoice_tabview_575\" invoice_id=\"575\">\r\n<!--############################################## INVOICE INFO ############################################-->\r\n    <div class=\"DHTMLSuite_aTab\" action=\"invoice_tab_invoice_info\">\r\n            \r\n    </div>\r\n<!--############################################## INVOICE LINES ############################################-->        \r\n    <div class=\"DHTMLSuite_aTab\" action=\"invoice_tab_invoice_lines\">\r\n        \r\n    </div>\r\n<!--############################################## PAYMENTS ############################################-->        \r\n    <div class=\"DHTMLSuite_aTab\" action=\"invoice_tab_payments\">\r\n        \r\n    </div>\r\n<!--############################################## ACCOUNTING ############################################-->        \r\n    <div class=\"DHTMLSuite_aTab\" action=\"invoice_tab_forwarding\">\r\n    \r\n    </div>   \t\r\n</div>\r\n\r\n<script type=\"text/javascript\">\r\nvar tabs = [\r\n\t'Overview',\r\n\t'Invoice Lines',\r\n\t'Payments'\r\n];\r\nvar tabbuttons = [\r\n\tfalse,\r\n\tfalse,\r\n\tfalse\r\n];\r\n\r\n\r\ntabs[tabs.length] = 'forwarding';\r\ntabbuttons[tabbuttons.length] = false;\r\n\r\nvar invoice_575 = new DHTMLSuite.tabView();\r\ninvoice_575.setParentId('invoice_tabview_575');\r\ninvoice_575.setTabTitles(tabs);\r\ninvoice_575.setCloseButtons(tabbuttons);\r\ninvoice_575.setIndexActiveTab(0);\r\ninvoice_575.setMaximumTabs(20);\r\ninvoice_575.setHeight(470);\r\ninvoice_575.init();\r\n\r\ninvoice_575.setCallbackOnTabSwitch('invoice_tab_callback');\r\ninvoice_575.dynamicContentObj.loadContent('tabViewinvoice_tabview_575_0','accounting.pl?section=invoices&action=invoice_tab_invoice_info&invoice_id=575');\r\n\r\n</script>"
          },
          "redirectURL": "",
          "headersSize": 529,
          "bodySize": 1053
        },
        "cache": {},
        "timings": {
          "blocked": 225,
          "dns": 0,
          "connect": 0,
          "ssl": 0,
          "send": 0,
          "wait": 403,
          "receive": 0
        },
        "time": 628,
        "_securityState": "secure",
        "serverIPAddress": "79.125.7.197",
        "connection": "443",
        "pageref": "page_2"
      },
      {
        "startedDateTime": "2023-08-02T17:02:12.382+06:00",
        "request": {
          "bodySize": 36,
          "method": "POST",
          "url": "https://dev.berlin3.com/designcheck/accounting.pl",
          "httpVersion": "HTTP/1.1",
          "headers": [
            {
              "name": "Host",
              "value": "dev.berlin3.com"
            },
            {
              "name": "User-Agent",
              "value": "Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/115.0"
            },
            {
              "name": "Accept",
              "value": "application/json, text/javascript, */*; q=0.01"
            },
            {
              "name": "Accept-Language",
              "value": "en-US,en;q=0.5"
            },
            {
              "name": "Accept-Encoding",
              "value": "gzip, deflate, br"
            },
            {
              "name": "Referer",
              "value": "https://dev.berlin3.com/designcheck/index.pl?start=1"
            },
            {
              "name": "Content-Type",
              "value": "application/x-www-form-urlencoded"
            },
            {
              "name": "X-Requested-With",
              "value": "XMLHttpRequest"
            },
            {
              "name": "Content-Length",
              "value": "36"
            },
            {
              "name": "Origin",
              "value": "https://dev.berlin3.com"
            },
            {
              "name": "Connection",
              "value": "keep-alive"
            },
            {
              "name": "Cookie",
              "value": "DISKO::AUTH_berlin3=geralt:2023-08-02-08-05-30:2023-08-04-08-05-30::e60a2e76975475a2a5584c7f616a3df2; mainWindow=width%3A990%2Cheight%3A620%2CxPos%3A0%2CyPos%3A0%2CzIndex%3A%2CactiveTabId%3AAccounting%2Cstate%3Aundefined; WindowSettings=width%3A990%2Cheight%3A600%2CxPos%3A2%2CyPos%3A2%2CzIndex%3A%2CactiveTabId%3ABookingSettingsTab%2Cstate%3Aundefined; WindowAccounting=width%3A990%2Cheight%3A600%2CxPos%3A2%2CyPos%3A2%2CzIndex%3A%2CactiveTabId%3AAccInvoicesTab%2Cstate%3Aundefined; WindowBooking=width%3A990%2Cheight%3A600%2CxPos%3A2%2CyPos%3A2%2CzIndex%3A%2CactiveTabId%3ABookCalendarTab%2Cstate%3Aundefined; WindowLabel=width%3A990%2Cheight%3A600%2CxPos%3A2%2CyPos%3A2%2CzIndex%3A%2CactiveTabId%3ALabelRoyaltyTab%2Cstate%3Aundefined; WindowDistribution=width%3A990%2Cheight%3A600%2CxPos%3A2%2CyPos%3A2%2CzIndex%3A%2CactiveTabId%3ADistAccountsTab%2Cstate%3Aundefined; WindowContacts=width%3A990%2Cheight%3A600%2CxPos%3A2%2CyPos%3A2%2CzIndex%3A%2CactiveTabId%3AGenContactsTab%2Cstate%3Aundefined; chatbox_minimized=Support%7CSupport; _ga=GA1.2.2001653648.1668753357; _ga_4GJL8L77LJ=GS1.1.1683275798.7.0.1683275798.0.0.0; _ga_BM42RTS79Q=GS1.2.1690175692.1.1.1690176135.0.0.0; CGISESSID=d13ec288b68da2ce5a3b6408ced3df7a"
            },
            {
              "name": "Sec-Fetch-Dest",
              "value": "empty"
            },
            {
              "name": "Sec-Fetch-Mode",
              "value": "cors"
            },
            {
              "name": "Sec-Fetch-Site",
              "value": "same-origin"
            }
          ],
          "cookies": [
            {
              "name": "DISKO::AUTH_berlin3",
              "value": "geralt:2023-08-02-08-05-30:2023-08-04-08-05-30::e60a2e76975475a2a5584c7f616a3df2"
            },
            {
              "name": "mainWindow",
              "value": "width:990,height:620,xPos:0,yPos:0,zIndex:,activeTabId:Accounting,state:undefined"
            },
            {
              "name": "WindowSettings",
              "value": "width:990,height:600,xPos:2,yPos:2,zIndex:,activeTabId:BookingSettingsTab,state:undefined"
            },
            {
              "name": "WindowAccounting",
              "value": "width:990,height:600,xPos:2,yPos:2,zIndex:,activeTabId:AccInvoicesTab,state:undefined"
            },
            {
              "name": "WindowBooking",
              "value": "width:990,height:600,xPos:2,yPos:2,zIndex:,activeTabId:BookCalendarTab,state:undefined"
            },
            {
              "name": "WindowLabel",
              "value": "width:990,height:600,xPos:2,yPos:2,zIndex:,activeTabId:LabelRoyaltyTab,state:undefined"
            },
            {
              "name": "WindowDistribution",
              "value": "width:990,height:600,xPos:2,yPos:2,zIndex:,activeTabId:DistAccountsTab,state:undefined"
            },
            {
              "name": "WindowContacts",
              "value": "width:990,height:600,xPos:2,yPos:2,zIndex:,activeTabId:GenContactsTab,state:undefined"
            },
            {
              "name": "chatbox_minimized",
              "value": "Support|Support"
            },
            {
              "name": "_ga",
              "value": "GA1.2.2001653648.1668753357"
            },
            {
              "name": "_ga_4GJL8L77LJ",
              "value": "GS1.1.1683275798.7.0.1683275798.0.0.0"
            },
            {
              "name": "_ga_BM42RTS79Q",
              "value": "GS1.2.1690175692.1.1.1690176135.0.0.0"
            },
            {
              "name": "CGISESSID",
              "value": "d13ec288b68da2ce5a3b6408ced3df7a"
            }
          ],
          "queryString": [],
          "headersSize": 1802,
          "postData": {
            "mimeType": "application/x-www-form-urlencoded",
            "params": [
              {
                "name": "section",
                "value": "invoices"
              },
              {
                "name": "action",
                "value": "all_invoices"
              }
            ],
            "text": "section=invoices&action=all_invoices"
          }
        },
        "response": {
          "status": 200,
          "statusText": "OK",
          "httpVersion": "HTTP/1.1",
          "headers": [
            {
              "name": "Date",
              "value": "Wed, 02 Aug 2023 11:02:12 GMT"
            },
            {
              "name": "Server",
              "value": "Apache/2.4.52 (Ubuntu) OpenSSL/3.0.2 mod_perl/2.0.12 Perl/v5.34.0"
            },
            {
              "name": "Set-Cookie",
              "value": "DISKO::AUTH_berlin3=geralt:2023-08-02-08-05-30:2023-08-04-08-05-30::e60a2e76975475a2a5584c7f616a3df2; expires=Fri, 04 Aug 2023 11:02:12 GMT; path=/designcheck/; domain=.berlin3.com"
            },
            {
              "name": "Access-Control-Allow-Credentials",
              "value": "true"
            },
            {
              "name": "Keep-Alive",
              "value": "timeout=30, max=100"
            },
            {
              "name": "Connection",
              "value": "Keep-Alive"
            },
            {
              "name": "Transfer-Encoding",
              "value": "chunked"
            },
            {
              "name": "Content-Type",
              "value": "application/json; charset=utf-8"
            }
          ],
          "cookies": [
            {
              "name": "DISKO::AUTH_berlin3",
              "value": "geralt:2023-08-02-08-05-30:2023-08-04-08-05-30::e60a2e76975475a2a5584c7f616a3df2"
            }
          ],
          "content": {
            "mimeType": "application/json; charset=utf-8",
            "size": 16669,
            "text": "[{\"last_name\":null,\"company_name\":\"Aggregator Of Music\",\"invoice_id\":575,\"cancelled_flag\":null,\"invoice_contact_email\":null,\"color\":\"#fffe00\",\"paypal_email\":null,\"due_days\":10,\"lock_flag\":null,\"contact_id\":86020,\"currency_iso\":\"NZD\",\"company_legalname\":null,\"first_name\":null,\"subject\":\"physical - phys 2023/M8\",\"artist_invoice_forward_count\":0,\"name\":\"Aggregator Of Music\",\"invoice_project_name\":\"Details Label\",\"invoice_date\":\"2023-08-02\",\"end_of_month_flag\":null,\"paid_flag\":null,\"invoice_ref\":\"details-2023-0087\",\"gross_amount_cc\":\"1165.78\"},{\"paid_flag\":null,\"invoice_ref\":\"MMI 2023 0012\",\"end_of_month_flag\":null,\"invoice_date\":\"2023-08-01\",\"invoice_project_name\":\"Magical Melodies Invoices\",\"name\":\"big fat demo agency\",\"artist_invoice_forward_count\":0,\"gross_amount_cc\":\"657.58\",\"due_days\":0,\"paypal_email\":null,\"color\":\"#fd5b2c\",\"invoice_contact_email\":\"simo@berlin3.com\",\"cancelled_flag\":null,\"invoice_id\":573,\"last_name\":null,\"company_name\":\"big fat demo agency\",\"subject\":\"digital - Digital Weasel News 2023/M8 | digital - Digital Weasel News 2023/M10\",\"first_name\":null,\"company_legalname\":\"big fat demo agency\",\"lock_flag\":null,\"contact_id\":91056,\"currency_iso\":\"GAL\"},{\"gross_amount_cc\":\"14631.87\",\"invoice_project_name\":\"Details Label\",\"name\":\"Aggregator Of Music\",\"artist_invoice_forward_count\":0,\"paid_flag\":null,\"invoice_ref\":\"details-2023-0086\",\"end_of_month_flag\":null,\"invoice_date\":\"2023-07-28\",\"company_legalname\":null,\"lock_flag\":null,\"currency_iso\":\"NZD\",\"contact_id\":86020,\"subject\":\"physical - phys 2023/M11\",\"first_name\":null,\"cancelled_flag\":null,\"invoice_id\":570,\"last_name\":null,\"company_name\":\"Aggregator Of Music\",\"due_days\":10,\"paypal_email\":null,\"color\":\"#fffe00\",\"invoice_contact_email\":null},{\"subject\":\"physical - phys 2023/M11 | physical - phys 2023/M11\",\"first_name\":null,\"lock_flag\":null,\"contact_id\":86020,\"currency_iso\":\"NZD\",\"company_legalname\":null,\"color\":\"#666666\",\"invoice_contact_email\":null,\"paypal_email\":null,\"due_days\":10,\"last_name\":null,\"company_name\":\"Aggregator Of Music\",\"cancelled_flag\":1,\"invoice_id\":569,\"gross_amount_cc\":\"29263.74\",\"paid_flag\":null,\"invoice_ref\":\"details-2023-0085\",\"invoice_date\":\"2023-07-28\",\"end_of_month_flag\":null,\"artist_invoice_forward_count\":0,\"name\":\"Aggregator Of Music\",\"invoice_project_name\":\"Details Label\"},{\"gross_amount_cc\":\"29263.74\",\"invoice_date\":\"2023-07-28\",\"end_of_month_flag\":null,\"invoice_ref\":\"details-2023-0084\",\"paid_flag\":null,\"artist_invoice_forward_count\":0,\"invoice_project_name\":\"Details Label\",\"name\":\"Aggregator Of Music\",\"first_name\":null,\"subject\":\"physical - phys 2023/M11 | physical - phys 2023/M11\",\"currency_iso\":\"NZD\",\"lock_flag\":null,\"contact_id\":86020,\"company_legalname\":null,\"color\":\"#666666\",\"invoice_contact_email\":null,\"due_days\":10,\"paypal_email\":null,\"last_name\":null,\"company_name\":\"Aggregator Of Music\",\"cancelled_flag\":1,\"invoice_id\":568},{\"artist_invoice_forward_count\":0,\"invoice_project_name\":\"Details Label\",\"name\":\"Aggregator Of Music\",\"paid_flag\":null,\"invoice_ref\":\"details-2023-0083\",\"invoice_date\":\"2023-07-28\",\"end_of_month_flag\":null,\"gross_amount_cc\":\"14631.87\",\"company_name\":\"Aggregator Of Music\",\"last_name\":null,\"invoice_id\":567,\"cancelled_flag\":1,\"invoice_contact_email\":null,\"color\":\"#666666\",\"due_days\":10,\"paypal_email\":null,\"contact_id\":86020,\"lock_flag\":null,\"currency_iso\":\"NZD\",\"company_legalname\":null,\"subject\":\"physical - phys 2023/M11\",\"first_name\":null},{\"gross_amount_cc\":\"29263.74\",\"artist_invoice_forward_count\":0,\"name\":\"Aggregator Of Music\",\"invoice_project_name\":\"Details Label\",\"end_of_month_flag\":null,\"invoice_date\":\"2023-07-28\",\"paid_flag\":null,\"invoice_ref\":\"details-2023-0082\",\"currency_iso\":\"NZD\",\"lock_flag\":null,\"contact_id\":86020,\"company_legalname\":null,\"first_name\":null,\"subject\":\"physical - phys 2023/M11 | physical - phys 2023/M11\",\"last_name\":null,\"company_name\":\"Aggregator Of Music\",\"cancelled_flag\":1,\"invoice_id\":566,\"color\":\"#666666\",\"invoice_contact_email\":null,\"due_days\":10,\"paypal_email\":null},{\"gross_amount_cc\":\"4130.74\",\"artist_invoice_forward_count\":0,\"invoice_project_name\":\"Details Label\",\"name\":\"\",\"invoice_date\":\"2023-07-28\",\"end_of_month_flag\":null,\"paid_flag\":null,\"invoice_ref\":\"details-2023-0081\",\"contact_id\":null,\"lock_flag\":null,\"currency_iso\":\"EUR\",\"company_legalname\":null,\"first_name\":null,\"subject\":\"digital - My Distributor 2022/M7\",\"last_name\":null,\"company_name\":null,\"cancelled_flag\":null,\"invoice_id\":565,\"invoice_contact_email\":null,\"color\":\"#fffe00\",\"paypal_email\":null,\"due_days\":10},{\"paypal_email\":null,\"due_days\":1,\"invoice_contact_email\":\"ruzicka.j.zbynek@gmail.com\",\"color\":\"#ca0005\",\"invoice_id\":564,\"cancelled_flag\":null,\"last_name\":\"RÅ¯Å¾iÄka\",\"company_name\":null,\"first_name\":\"ZbynÄk\",\"subject\":\"huog\",\"company_legalname\":null,\"contact_id\":86719,\"lock_flag\":null,\"currency_iso\":\"EUR\",\"end_of_month_flag\":null,\"invoice_date\":\"2023-07-17\",\"paid_flag\":null,\"invoice_ref\":\"details-2023-0080\",\"name\":\"ZbynÄk RÅ¯Å¾iÄka\",\"invoice_project_name\":\"Details Label\",\"artist_invoice_forward_count\":0,\"gross_amount_cc\":\"555.00\"},{\"gross_amount_cc\":\"112158.22\",\"artist_invoice_forward_count\":0,\"name\":\"big fat demo agency\",\"invoice_project_name\":\"Magical Melodies Invoices\",\"invoice_ref\":\"MMI 2023 0011\",\"paid_flag\":null,\"end_of_month_flag\":null,\"invoice_date\":\"2023-06-21\",\"contact_id\":91056,\"lock_flag\":null,\"currency_iso\":\"GAL\",\"company_legalname\":\"big fat demo agency\",\"subject\":\"digital - Digital Weasel News 2023/M4 | digital - Digital Weasel News 2023/M4\",\"first_name\":null,\"company_name\":\"big fat demo agency\",\"last_name\":null,\"cancelled_flag\":null,\"invoice_id\":563,\"color\":\"#ca0005\",\"invoice_contact_email\":\"simo@berlin3.com\",\"paypal_email\":null,\"due_days\":0},{\"gross_amount_cc\":\"56079.11\",\"invoice_ref\":\"MMI 2023 0010\",\"paid_flag\":null,\"end_of_month_flag\":null,\"invoice_date\":\"2023-06-21\",\"name\":\"big fat demo agency\",\"invoice_project_name\":\"Magical Melodies Invoices\",\"artist_invoice_forward_count\":0,\"subject\":\"digital - Digital Weasel News 2023/M3\",\"first_name\":null,\"company_legalname\":\"big fat demo agency\",\"lock_flag\":null,\"currency_iso\":\"GAL\",\"contact_id\":91056,\"due_days\":0,\"paypal_email\":null,\"color\":\"#ca0005\",\"invoice_contact_email\":\"simo@berlin3.com\",\"cancelled_flag\":null,\"invoice_id\":562,\"last_name\":null,\"company_name\":\"big fat demo agency\"},{\"gross_amount_cc\":\"221.00\",\"end_of_month_flag\":null,\"invoice_date\":\"2023-06-21\",\"invoice_ref\":\"details-2023-0079\",\"paid_flag\":null,\"name\":\"Aleksandra Skvarc\",\"invoice_project_name\":\"Details Label\",\"artist_invoice_forward_count\":0,\"first_name\":\"Aleksandra\",\"subject\":\"Invoice Order #1944 (ice)\",\"company_legalname\":null,\"currency_iso\":\"EUR\",\"lock_flag\":null,\"contact_id\":86681,\"paypal_email\":null,\"due_days\":null,\"color\":\"#666666\",\"invoice_contact_email\":\"tbc\",\"invoice_id\":561,\"cancelled_flag\":1,\"last_name\":\"Skvarc\",\"company_name\":null},{\"gross_amount_cc\":\"1.00\",\"end_of_month_flag\":null,\"invoice_date\":\"2023-06-14\",\"paid_flag\":1,\"invoice_ref\":\"details-2023-0078\",\"name\":\"fgdjdfgj\",\"invoice_project_name\":\"Details Label\",\"artist_invoice_forward_count\":0,\"first_name\":null,\"subject\":\"2023-06-30 / Anakin Skywalkers / test fields / fdgjdfgj\",\"company_legalname\":\"fgdjdfgj\",\"lock_flag\":null,\"contact_id\":93549,\"currency_iso\":\"EUR\",\"due_days\":9,\"paypal_email\":null,\"invoice_contact_email\":\"\",\"color\":\"#07f300\",\"invoice_id\":556,\"cancelled_flag\":null,\"last_name\":null,\"company_name\":\"fdgj\"},{\"subject\":\"2023-06-30 / Anakin Skywalkers / test fields / fdgjdfgj\",\"first_name\":null,\"company_legalname\":\"fgdjdfgj\",\"currency_iso\":\"EUR\",\"lock_flag\":null,\"contact_id\":93549,\"due_days\":10,\"paypal_email\":null,\"invoice_contact_email\":\"\",\"color\":\"#07f300\",\"cancelled_flag\":null,\"invoice_id\":555,\"company_name\":\"fdgj\",\"last_name\":null,\"gross_amount_cc\":\"666.00\",\"invoice_ref\":\"details-2023-0077\",\"paid_flag\":1,\"invoice_date\":\"2023-06-14\",\"end_of_month_flag\":null,\"invoice_project_name\":\"Details Label\",\"name\":\"fgdjdfgj\",\"artist_invoice_forward_count\":0},{\"currency_iso\":\"GAL\",\"lock_flag\":1,\"contact_id\":null,\"company_legalname\":null,\"first_name\":null,\"subject\":\"Invoice Order #1939 (gas)\",\"last_name\":null,\"company_name\":null,\"invoice_id\":554,\"cancelled_flag\":null,\"invoice_contact_email\":null,\"color\":\"#ca0005\",\"paypal_email\":null,\"due_days\":null,\"gross_amount_cc\":\"7646265.90\",\"artist_invoice_forward_count\":0,\"name\":\"\",\"invoice_project_name\":\"Magical Melodies Invoices\",\"invoice_date\":\"2023-06-06\",\"end_of_month_flag\":null,\"invoice_ref\":\"MMI 2023 0009\",\"paid_flag\":null},{\"gross_amount_cc\":\"499.50\",\"artist_invoice_forward_count\":0,\"name\":\"ICH\",\"invoice_project_name\":\"DJ XYZ\",\"paid_flag\":null,\"invoice_ref\":\"DF-XYZ-2023-010\",\"invoice_date\":\"2023-06-05\",\"end_of_month_flag\":null,\"lock_flag\":0,\"currency_iso\":\"EUR\",\"contact_id\":93542,\"company_legalname\":\"ICH\",\"subject\":\"2023-06-07 / Anakin Skywalkers / staging test / Europa-Center / berlin / Germany\",\"first_name\":null,\"company_name\":\"neue staging company\",\"last_name\":null,\"cancelled_flag\":null,\"invoice_id\":553,\"color\":\"#ca0005\",\"invoice_contact_email\":\"sgsdg\",\"paypal_email\":null,\"due_days\":10},{\"subject\":\"Invoice Order #1938 (gas)\",\"first_name\":null,\"currency_iso\":\"GAL\",\"lock_flag\":null,\"contact_id\":null,\"company_legalname\":null,\"invoice_contact_email\":null,\"color\":\"#ca0005\",\"due_days\":null,\"paypal_email\":null,\"last_name\":null,\"company_name\":null,\"cancelled_flag\":null,\"invoice_id\":552,\"gross_amount_cc\":\"0.00\",\"paid_flag\":null,\"invoice_ref\":\"MMI 2023 0008\",\"invoice_date\":\"2023-06-02\",\"end_of_month_flag\":null,\"artist_invoice_forward_count\":0,\"invoice_project_name\":\"Magical Melodies Invoices\",\"name\":\"\"},{\"gross_amount_cc\":\"0.00\",\"invoice_date\":\"2023-06-01\",\"end_of_month_flag\":null,\"paid_flag\":null,\"invoice_ref\":\"MMI 2023 0007\",\"artist_invoice_forward_count\":0,\"name\":\"\",\"invoice_project_name\":\"Magical Melodies Invoices\",\"first_name\":null,\"subject\":\"Invoice Order #1933 (Gas)\",\"currency_iso\":\"GAL\",\"lock_flag\":null,\"contact_id\":null,\"company_legalname\":null,\"color\":\"#ca0005\",\"invoice_contact_email\":null,\"paypal_email\":null,\"due_days\":null,\"last_name\":null,\"company_name\":null,\"invoice_id\":549,\"cancelled_flag\":null},{\"invoice_contact_email\":null,\"color\":\"#ca0005\",\"due_days\":null,\"paypal_email\":null,\"last_name\":null,\"company_name\":null,\"cancelled_flag\":null,\"invoice_id\":548,\"subject\":\"Invoice Order #1932 (Edgar MacGyver )\",\"first_name\":null,\"currency_iso\":\"GAL\",\"lock_flag\":null,\"contact_id\":null,\"company_legalname\":null,\"paid_flag\":null,\"invoice_ref\":\"MMI 2023 0006\",\"invoice_date\":\"2023-06-01\",\"end_of_month_flag\":null,\"artist_invoice_forward_count\":0,\"name\":\"\",\"invoice_project_name\":\"Magical Melodies Invoices\",\"gross_amount_cc\":\"0.00\"},{\"currency_iso\":\"GAL\",\"lock_flag\":null,\"contact_id\":null,\"company_legalname\":null,\"subject\":\"Invoice Order #1931 (Randy Skiles )\",\"first_name\":null,\"last_name\":null,\"company_name\":null,\"cancelled_flag\":null,\"invoice_id\":547,\"color\":\"#ca0005\",\"invoice_contact_email\":null,\"paypal_email\":null,\"due_days\":null,\"gross_amount_cc\":\"0.00\",\"artist_invoice_forward_count\":0,\"name\":\"\",\"invoice_project_name\":\"Magical Melodies Invoices\",\"invoice_ref\":\"MMI 2023 0005\",\"paid_flag\":null,\"end_of_month_flag\":null,\"invoice_date\":\"2023-06-01\"},{\"invoice_project_name\":\"Magical Melodies Invoices\",\"name\":\"\",\"artist_invoice_forward_count\":0,\"paid_flag\":null,\"invoice_ref\":\"MMI 2023 0004\",\"end_of_month_flag\":null,\"invoice_date\":\"2023-06-01\",\"gross_amount_cc\":\"0.00\",\"invoice_id\":546,\"cancelled_flag\":null,\"last_name\":null,\"company_name\":null,\"paypal_email\":null,\"due_days\":null,\"invoice_contact_email\":null,\"color\":\"#ca0005\",\"company_legalname\":null,\"currency_iso\":\"GAL\",\"lock_flag\":null,\"contact_id\":null,\"subject\":\"Invoice Order #1929 (Jerome Kesslr )\",\"first_name\":null},{\"artist_invoice_forward_count\":0,\"name\":\"\",\"invoice_project_name\":\"Magical Melodies Invoices\",\"invoice_ref\":\"MMI 2023 0003\",\"paid_flag\":null,\"end_of_month_flag\":null,\"invoice_date\":\"2023-05-31\",\"gross_amount_cc\":\"64.00\",\"last_name\":null,\"company_name\":null,\"invoice_id\":545,\"cancelled_flag\":null,\"invoice_contact_email\":null,\"color\":\"#ca0005\",\"paypal_email\":null,\"due_days\":null,\"contact_id\":null,\"lock_flag\":null,\"currency_iso\":\"GAL\",\"company_legalname\":null,\"subject\":\"Invoice Order #1928 (Malcolm Emard )\",\"first_name\":null},{\"invoice_ref\":\"MMI 2023 0002\",\"paid_flag\":null,\"invoice_date\":\"2023-05-31\",\"end_of_month_flag\":null,\"artist_invoice_forward_count\":0,\"name\":\"\",\"invoice_project_name\":\"Magical Melodies Invoices\",\"gross_amount_cc\":\"1032.00\",\"color\":\"#ca0005\",\"invoice_contact_email\":null,\"paypal_email\":null,\"due_days\":null,\"last_name\":null,\"company_name\":null,\"invoice_id\":544,\"cancelled_flag\":null,\"subject\":\"Invoice Order #1927 (Glen Bashirian )\",\"first_name\":null,\"contact_id\":null,\"lock_flag\":null,\"currency_iso\":\"GAL\",\"company_legalname\":null},{\"subject\":\"Invoice Order #1925 (Tommie Hauck )\",\"first_name\":null,\"lock_flag\":null,\"contact_id\":null,\"currency_iso\":\"GAL\",\"company_legalname\":null,\"invoice_contact_email\":null,\"color\":\"#ca0005\",\"due_days\":null,\"paypal_email\":null,\"company_name\":null,\"last_name\":null,\"cancelled_flag\":null,\"invoice_id\":543,\"gross_amount_cc\":\"391625.00\",\"paid_flag\":null,\"invoice_ref\":\"MMI 2023 0001\",\"end_of_month_flag\":null,\"invoice_date\":\"2023-05-31\",\"artist_invoice_forward_count\":0,\"invoice_project_name\":\"Magical Melodies Invoices\",\"name\":\"\"},{\"invoice_ref\":\"details-2023-0076\",\"paid_flag\":null,\"end_of_month_flag\":null,\"invoice_date\":\"2023-05-31\",\"name\":\"Test\",\"invoice_project_name\":\"Details UK\",\"artist_invoice_forward_count\":0,\"gross_amount_cc\":\"27283.00\",\"paypal_email\":null,\"due_days\":-4,\"invoice_contact_email\":\"\",\"color\":\"#ca0005\",\"invoice_id\":541,\"cancelled_flag\":null,\"last_name\":null,\"company_name\":\"Test\",\"subject\":\"2023-05-04 / Adi Gallia / SA / Sacré-Coeur / Paris / France\",\"first_name\":null,\"company_legalname\":\"Test\",\"contact_id\":93538,\"lock_flag\":0,\"currency_iso\":\"EUR\"},{\"first_name\":null,\"subject\":\"2023-05-04 / Adi Gallia / SA / Sacré-Coeur / Paris / France\",\"company_legalname\":\"Test\",\"lock_flag\":null,\"contact_id\":93538,\"currency_iso\":\"EUR\",\"paypal_email\":null,\"due_days\":20,\"color\":\"#ca0005\",\"invoice_contact_email\":\"\",\"invoice_id\":538,\"cancelled_flag\":null,\"last_name\":null,\"company_name\":\"Test\",\"gross_amount_cc\":\"0.00\",\"invoice_date\":\"2023-05-25\",\"end_of_month_flag\":null,\"invoice_ref\":\"details-2023-0075\",\"paid_flag\":null,\"invoice_project_name\":\"Details Label\",\"name\":\"Test\",\"artist_invoice_forward_count\":0},{\"invoice_project_name\":\"Details Label\",\"name\":\" - copy\",\"artist_invoice_forward_count\":0,\"paid_flag\":null,\"invoice_ref\":\"details-2023-0074\",\"invoice_date\":\"2023-05-25\",\"end_of_month_flag\":null,\"gross_amount_cc\":\"0.00\",\"cancelled_flag\":null,\"invoice_id\":537,\"last_name\":null,\"company_name\":\"!!! SQL KILL META - copy !\",\"paypal_email\":null,\"due_days\":10,\"color\":\"#ca0005\",\"invoice_contact_email\":\"dfsg\",\"company_legalname\":\" - copy\",\"contact_id\":91007,\"lock_flag\":null,\"currency_iso\":\"EUR\",\"subject\":\"2023-05-02 / Anakin Skywalkers / test / ://about blank Club / Berlin / Germany\",\"first_name\":null},{\"invoice_contact_email\":\"\",\"color\":\"#ca0005\",\"due_days\":-11,\"paypal_email\":null,\"last_name\":null,\"company_name\":\"Test\",\"invoice_id\":533,\"cancelled_flag\":null,\"first_name\":null,\"subject\":\"2023-05-04 / Adi Gallia / SA / Sacré-Coeur / Paris / France\",\"lock_flag\":1,\"contact_id\":93538,\"currency_iso\":\"EUR\",\"company_legalname\":\"Test\",\"end_of_month_flag\":null,\"invoice_date\":\"2023-05-24\",\"paid_flag\":null,\"invoice_ref\":\"RS 0008\",\"artist_invoice_forward_count\":0,\"invoice_project_name\":\"Royalty Statements UK\",\"name\":\"Test\",\"gross_amount_cc\":\"1335.00\"},{\"paid_flag\":null,\"invoice_ref\":\"RS 0007\",\"end_of_month_flag\":null,\"invoice_date\":\"2023-05-24\",\"artist_invoice_forward_count\":0,\"invoice_project_name\":\"Royalty Statements UK\",\"name\":\"Test\",\"gross_amount_cc\":\"0.00\",\"color\":\"#ca0005\",\"invoice_contact_email\":\"\",\"due_days\":14,\"paypal_email\":null,\"last_name\":null,\"company_name\":\"Test\",\"invoice_id\":532,\"cancelled_flag\":null,\"subject\":\"2023-05-04 / Adi Gallia / SA / Sacré-Coeur / Paris / France\",\"first_name\":null,\"contact_id\":93538,\"lock_flag\":1,\"currency_iso\":\"EUR\",\"company_legalname\":\"Test\"},{\"company_legalname\":\" - copy\",\"contact_id\":91007,\"lock_flag\":null,\"currency_iso\":\"EUR\",\"subject\":\"Credit Note for invoice DF-XYZ-2023-008: 2023-05-02 / Anakin Skywalkers / test / ://about blank Club / Berlin / Germany\",\"first_name\":null,\"cancelled_flag\":null,\"invoice_id\":531,\"last_name\":null,\"company_name\":\"!!! SQL KILL META - copy !\",\"due_days\":-29,\"paypal_email\":null,\"invoice_contact_email\":\"dfsg\",\"color\":\"#ca0005\",\"gross_amount_cc\":\"-356.31\",\"invoice_project_name\":\"DJ XYZ\",\"name\":\" - copy\",\"artist_invoice_forward_count\":0,\"paid_flag\":null,\"invoice_ref\":\"DF-XYZ-2023-009\",\"invoice_date\":\"2023-05-24\",\"end_of_month_flag\":null}]"
          },
          "redirectURL": "",
          "headersSize": 497,
          "bodySize": 17166
        },
        "cache": {},
        "timings": {
          "blocked": 455,
          "dns": 0,
          "connect": 222,
          "ssl": 231,
          "send": 0,
          "wait": 967,
          "receive": 222
        },
        "time": 2097,
        "_securityState": "secure",
        "serverIPAddress": "79.125.7.197",
        "connection": "443",
        "pageref": "page_2"
      },
      {
        "startedDateTime": "2023-08-02T17:02:13.031+06:00",
        "request": {
          "bodySize": 0,
          "method": "GET",
          "url": "https://dev.berlin3.com/designcheck/accounting.pl?section=invoices&action=invoice_tab_invoice_info&invoice_id=575&rndval=1690974133023",
          "httpVersion": "HTTP/1.1",
          "headers": [
            {
              "name": "Host",
              "value": "dev.berlin3.com"
            },
            {
              "name": "User-Agent",
              "value": "Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/115.0"
            },
            {
              "name": "Accept",
              "value": "*/*"
            },
            {
              "name": "Accept-Language",
              "value": "en-US,en;q=0.5"
            },
            {
              "name": "Accept-Encoding",
              "value": "gzip, deflate, br"
            },
            {
              "name": "Referer",
              "value": "https://dev.berlin3.com/designcheck/index.pl?start=1"
            },
            {
              "name": "Connection",
              "value": "keep-alive"
            },
            {
              "name": "Cookie",
              "value": "DISKO::AUTH_berlin3=geralt:2023-08-02-08-05-30:2023-08-04-08-05-30::e60a2e76975475a2a5584c7f616a3df2; mainWindow=width%3A990%2Cheight%3A620%2CxPos%3A0%2CyPos%3A0%2CzIndex%3A%2CactiveTabId%3AAccounting%2Cstate%3Aundefined; WindowSettings=width%3A990%2Cheight%3A600%2CxPos%3A2%2CyPos%3A2%2CzIndex%3A%2CactiveTabId%3ABookingSettingsTab%2Cstate%3Aundefined; WindowAccounting=width%3A990%2Cheight%3A600%2CxPos%3A2%2CyPos%3A2%2CzIndex%3A%2CactiveTabId%3AAccInvoicesTab%2Cstate%3Aundefined; WindowBooking=width%3A990%2Cheight%3A600%2CxPos%3A2%2CyPos%3A2%2CzIndex%3A%2CactiveTabId%3ABookCalendarTab%2Cstate%3Aundefined; WindowLabel=width%3A990%2Cheight%3A600%2CxPos%3A2%2CyPos%3A2%2CzIndex%3A%2CactiveTabId%3ALabelRoyaltyTab%2Cstate%3Aundefined; WindowDistribution=width%3A990%2Cheight%3A600%2CxPos%3A2%2CyPos%3A2%2CzIndex%3A%2CactiveTabId%3ADistAccountsTab%2Cstate%3Aundefined; WindowContacts=width%3A990%2Cheight%3A600%2CxPos%3A2%2CyPos%3A2%2CzIndex%3A%2CactiveTabId%3AGenContactsTab%2Cstate%3Aundefined; chatbox_minimized=Support%7CSupport; _ga=GA1.2.2001653648.1668753357; _ga_4GJL8L77LJ=GS1.1.1683275798.7.0.1683275798.0.0.0; _ga_BM42RTS79Q=GS1.2.1690175692.1.1.1690176135.0.0.0; CGISESSID=d13ec288b68da2ce5a3b6408ced3df7a"
            },
            {
              "name": "Sec-Fetch-Dest",
              "value": "empty"
            },
            {
              "name": "Sec-Fetch-Mode",
              "value": "cors"
            },
            {
              "name": "Sec-Fetch-Site",
              "value": "same-origin"
            }
          ],
          "cookies": [
            {
              "name": "DISKO::AUTH_berlin3",
              "value": "geralt:2023-08-02-08-05-30:2023-08-04-08-05-30::e60a2e76975475a2a5584c7f616a3df2"
            },
            {
              "name": "mainWindow",
              "value": "width:990,height:620,xPos:0,yPos:0,zIndex:,activeTabId:Accounting,state:undefined"
            },
            {
              "name": "WindowSettings",
              "value": "width:990,height:600,xPos:2,yPos:2,zIndex:,activeTabId:BookingSettingsTab,state:undefined"
            },
            {
              "name": "WindowAccounting",
              "value": "width:990,height:600,xPos:2,yPos:2,zIndex:,activeTabId:AccInvoicesTab,state:undefined"
            },
            {
              "name": "WindowBooking",
              "value": "width:990,height:600,xPos:2,yPos:2,zIndex:,activeTabId:BookCalendarTab,state:undefined"
            },
            {
              "name": "WindowLabel",
              "value": "width:990,height:600,xPos:2,yPos:2,zIndex:,activeTabId:LabelRoyaltyTab,state:undefined"
            },
            {
              "name": "WindowDistribution",
              "value": "width:990,height:600,xPos:2,yPos:2,zIndex:,activeTabId:DistAccountsTab,state:undefined"
            },
            {
              "name": "WindowContacts",
              "value": "width:990,height:600,xPos:2,yPos:2,zIndex:,activeTabId:GenContactsTab,state:undefined"
            },
            {
              "name": "chatbox_minimized",
              "value": "Support|Support"
            },
            {
              "name": "_ga",
              "value": "GA1.2.2001653648.1668753357"
            },
            {
              "name": "_ga_4GJL8L77LJ",
              "value": "GS1.1.1683275798.7.0.1683275798.0.0.0"
            },
            {
              "name": "_ga_BM42RTS79Q",
              "value": "GS1.2.1690175692.1.1.1690176135.0.0.0"
            },
            {
              "name": "CGISESSID",
              "value": "d13ec288b68da2ce5a3b6408ced3df7a"
            }
          ],
          "queryString": [
            {
              "name": "section",
              "value": "invoices"
            },
            {
              "name": "action",
              "value": "invoice_tab_invoice_info"
            },
            {
              "name": "invoice_id",
              "value": "575"
            },
            {
              "name": "rndval",
              "value": "1690974133023"
            }
          ],
          "headersSize": 1707
        },
        "response": {
          "status": 200,
          "statusText": "OK",
          "httpVersion": "HTTP/1.1",
          "headers": [
            {
              "name": "Date",
              "value": "Wed, 02 Aug 2023 11:02:13 GMT"
            },
            {
              "name": "Server",
              "value": "Apache/2.4.52 (Ubuntu) OpenSSL/3.0.2 mod_perl/2.0.12 Perl/v5.34.0"
            },
            {
              "name": "Set-Cookie",
              "value": "DISKO::AUTH_berlin3=geralt:2023-08-02-08-05-30:2023-08-04-08-05-30::e60a2e76975475a2a5584c7f616a3df2; expires=Fri, 04 Aug 2023 11:02:13 GMT; path=/designcheck/; domain=.berlin3.com"
            },
            {
              "name": "Vary",
              "value": "Accept-Encoding"
            },
            {
              "name": "Content-Encoding",
              "value": "gzip"
            },
            {
              "name": "Access-Control-Allow-Credentials",
              "value": "true"
            },
            {
              "name": "Content-Length",
              "value": "7631"
            },
            {
              "name": "Keep-Alive",
              "value": "timeout=30, max=96"
            },
            {
              "name": "Connection",
              "value": "Keep-Alive"
            },
            {
              "name": "Content-Type",
              "value": "text/html; charset=utf-8"
            }
          ],
          "cookies": [
            {
              "name": "DISKO::AUTH_berlin3",
              "value": "geralt:2023-08-02-08-05-30:2023-08-04-08-05-30::e60a2e76975475a2a5584c7f616a3df2"
            }
          ],
          "content": {
            "mimeType": "text/html; charset=utf-8",
            "size": 35341,
            "text": "\r\n<div class=\"fl w60\">\r\n\t<!--##################################### invoice contact ######################################### -->\r\n\t<div class=\"wb\">\r\n\t\t<table id=\"invoice_contact_header-575\" class=\"MainTableHead\">\r\n\t\t\t<tbody>\r\n\t\t\t\t<tr>\r\n\t\t\t\t\t<td class=\"tda\">Invoice Contact</td>\r\n\t\t\t\t</tr>\r\n\t\t\t</tbody>\r\n\t\t</table>\r\n\t</div>\r\n\t<!--##################################### invoice address ######################################### -->\r\n\t<div class=\"modalTable\">\r\n\t\t<div class=\"fl w60\">\r\n\t\t\t<div class=\"h90 mt5\" id=\"inv_address_container_div_575\">\r\n\t\t\t\t\r\n<div class=\"h90 mt5\" id=\"inv_address_container_div_575\">\r\n\t<div id=\"inv_address_div_575\" style=\"height: 87px; padding-left: 5px; background:#fff; display: block;\" ><span style=\"font-weight: bold;\"><a href=\"#\" style=\"\" onclick=\"active_contact('Aggregator Of Music',86020,'company');\" id=\"inv_name_575\">Aggregator Of Music</a></span><div id=\"inv_add_575\" onclick=\"document.getElementById('inv_address_div_575').style.display = 'none';document.getElementById('invoice_address_575').style.display = 'block';\">Old Mill Road 177<br />EG3 HT4 London<br />United Kingdom</div></div>\r\n\t\r\n\t<textarea id=\"invoice_address_575\" class=\"textarea h80\" onblur=\"BERLIN3.common.modify('invoice_id','575','invoice_address','invoices','2023-08-02 11:02:10',this);var re = /([^\\n]+)\\n?([\\w\\W]+)/;var matches = re.exec(this.value);if(matches!=null){document.getElementById('inv_name_575').innerHTML = matches[1];document.getElementById('inv_add_575').innerHTML = matches[2].replace(/\\n/g,'<br />');if(this.value != this.getAttribute('oldval')) {BERLIN3.accounting_invoices.check_invoice_address(matches[1],'575');}}document.getElementById('inv_address_div_575').style.display = 'block';this.style.display = 'none';\" style=\"display:none;\">Aggregator Of Music\nOld Mill Road 177\nEG3 HT4 London\nUnited Kingdom</textarea>\r\n</div>\r\n\r\n\t\t\t</div>\r\n\t\t\t<span class=\"right\" style=\"margin-right:-10px;\">\r\n\t\t\t\t<span class=\"en_disble_on_lockflag\"><a href=\"#\" onclick=\"contactRelationWidget('invoices','invoice_id','575','contact_id','both','custom_invoice','inv_address_container_div_575','set_item_contact');return false\" style=\"position:absolute;top:5px;\" class=\"\"><img src=\"/images/newimg/Search.png\" class=\"\" /></a></span>\r\n\t\t\t\t<a href=\"#\" style=\"position:absolute;top:25px;\" invoice_id=\"575\" paypal_email=\"\" email=\"\" onclick=\"berlin3.common.accounting.displayPaypalPaymentMsgModal(this);\"><img src=\"/images/newimg/Mail.png\" ></a>\r\n\t\t\t</span>\r\n\t\t</div>\r\n\t\t<!--##################################### vat,tax,debitor ######################################### -->\r\n\t\t<div class=\"fr en_disble_on_lockflag\">\r\n\t\t\t<table id=\"invoice_vat_tax-575\">\r\n\t\t\t\t<tbody>\r\n\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t<td class=\"tda\">VAT ID</td>\r\n\t\t\t\t\t\t<td class=\"tdb\"><input id=\"vat_no_575\" type=\"text\" value=\"GB12345678\" invoice_id=\"575\" contact_id=\"86020\" email1=\"\" onblur=\"this.value=this.value.replace(/[^A-Za-z0-9]/g,'');this.value=this.value.replace(/^\\D{4}/,'');berlin3.common.vat_no.update(this);\" callback=\"berlin3.common.vat_no.check\" item_id=\"86020\" ref_id=\"575\" ref_div_id=\"check_valid_vat_no_bt_575\" email=\"\" ref=\"invoice\" /></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t<td>Debitor No</td>\r\n\t\t\t\t\t\t<td><input id=\"debitor_no_575\" type=\"text\" value=\"\" onblur=\"BERLIN3.common.modify('contact_id','86020','debitor_no','contacts','2021-10-12 13:56:23',this);\"/></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t<td>Local Tax No</td>\r\n\t\t\t\t\t\t<td><input id=\"tax_no_575\" type=\"text\" value=\"\" onblur=\"BERLIN3.common.modify('contact_id','86020','tax_no','contacts','2021-10-12 13:56:23',this);\"/></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t\t\r\n\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t<td>&nbsp;</td>\r\n\t\t\t\t\t\t<td colspan=\"\" align=\"\">\r\n\t\t\t\t\t\t\t<span id=\"check_valid_vat_no_bt_575\">\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\r\n\r\n\t\t\t\t\t\t\t\t\t<!-- <input type=\"button\" value=\"Vat Invalid\" onclick=\"BERLIN3.accounting_invoices.email_vat_invalid('');\" style=\"background-color: #ff0000; color: #000;\"/> -->\r\n\r\n\t\t\t\t\t\t\t\t\t<input value=\"VAT ID is invalid\" type=\"button\" item_id=\"86020\" vat_no=\"GB12345678\" valid_vat_no=\"0\" email=\"\" onclick=\"berlin3.common.vat_no.view_vies( this );\" style=\"background-color: red; color: white;\">\r\n\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t</td>\r\n\t\t\t\t\t</tr>\r\n\t\r\n\t\t\t\t\t\r\n\t\t\t\t</tbody>\r\n\t\t\t</table>\r\n\t\t</div>\r\n\t</div>\r\n\t<!--##################################### invoice subject ######################################### -->\r\n\t<div class=\"w100 mt5 mb5\">\r\n\r\n\t\t<!-- IF label invoice -->\r\n\t\t\r\n\t\t<div style=\"float:right;width:33%;\">\r\n\t\t\t<div class=\"hdiv\">\r\n\t\t\t\t<span class=\"htext fchild\">Royalty Dates</span>\r\n\t\t\t</div>\r\n\t\t\t<div class=\"h00\" style=\"height:150px;padding:0px 5px;\">\r\n\t\t\t\t<div>\r\n\t\t\t\t\t<span class=\"column\">adjust Sales Period:</span>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div>\r\n\t\t\t\t\t<span class=\"column\">\r\n\t\t\t\t\t\t<input type=\"text\" class=\"box\" value=\"\" table=\"invoices\" column=\"royalty_date1\" key_value=\"575\" last_modified=\"2023-08-02 11:02:10\" callback=\"berlin3.common.modify\" onclick=\"berlin3.common.openCalendar(this, this);\" />\r\n\t\t\t\t\t</span>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div>\r\n\t\t\t\t\t<span class=\"column\">adjust Payment Period:</span>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div>\r\n\t\t\t\t\t<span class=\"column\">\r\n\t\t\t\t\t\t<input type=\"text\" class=\"box\" value=\"\" table=\"invoices\" column=\"royalty_date2\" key_value=\"575\" last_modified=\"2023-08-02 11:02:10\" callback=\"berlin3.common.modify\" onclick=\"berlin3.common.openCalendar(this, this);\" />\r\n\t\t\t\t\t</span>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div>\r\n\t\t\t\t\t<span class=\"column\">\r\n\t\t\t\t\t\t<input type=\"button\" id=\"adjust_royalty_dates_575\" value=\"Perform\" extra='{}' item_id=\"575\" ok_handler=\"closeMessage\" ok_msg=\"\" label=\"The update is in progress. This may take a short moment.\" ok_btn_label=\"Ok\" close_btn_label=\"Cancel\" onclick=\"BERLIN3.accounting_invoices.check_adjusted_royalty_dates(this);\" />\r\n\t\t\t\t\t\t<br/>\r\n\t\t\t\t\t\t<br/>\r\n\r\n\t\t\t\t\t\t\r\n\r\n\t\t\t\t\t</span>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\r\n\t\t<div style=\"width:65%;\">\r\n\t\t\t\r\n\r\n\t\t\t<!--###################### Placed these 2 boxes depends on condition ###################### -->\r\n\r\n\t\t\t<!--##################################### subject ######################################### -->\r\n\t\t\t<div class=\"wb\">\r\n\t\t\t\t<table id=\"invoice_subject-575\" class=\"MainTableHead\">\r\n\t\t\t\t\t<tbody>\r\n\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t<td class=\"tda\">Subject</td>\r\n\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t</tbody>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t\t<div class=\"h40\">\r\n\t\t\t\t<textarea id=\"subject_575\" class=\"textarea h30\" onblur=\"BERLIN3.common.modify('invoice_id','575','subject','invoices','2023-08-02 11:02:10',this);\">physical - phys 2023/M8</textarea>\r\n\t\t\t</div>\r\n\r\n\t\t\t<!--##################################### invoice note ######################################### -->\r\n\t\t\t<div class=\"wb mt5\">\r\n\t\t\t\t<table id=\"internal_notes-575\" class=\"MainTableHead\">\r\n\t\t\t\t\t<tbody>\r\n\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t<td class=\"tda\">Notes</td>\r\n\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t</tbody>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t\t<div class=\"h85\">\r\n\t\t\t\t\r\n\t\t\t\t<textarea id=\"notes_575\" class=\"textarea h75\" onblur=\"BERLIN3.common.modify('invoice_id','575','notes','invoices','2023-08-02 11:02:10',this);\"></textarea>\r\n\t\t\t\t\r\n\t\t\t</div>\r\n\r\n\t\t\t<!-- IF label invoice -->\r\n\t\t\t\r\n\t\t</div>\r\n\t\t\r\n\r\n\t</div>\r\n\r\n\t<div class=\"fl w50\">\r\n\r\n\t\t<!--##################################### leading text ######################################### -->\r\n\t\t<div class=\"wb\">\r\n\t\t\t<table id=\"lt_tt_table-575\" class=\"MainTableHead\">\r\n\t\t\t\t<tbody>\r\n\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t<td class=\"tda\">Leading Text</td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</tbody>\r\n\t\t\t</table>\r\n\t\t</div>\r\n\t\t<div class=\"h140\">\r\n\t\t\t<textarea id=\"leading_text_575\" class=\"textarea h130\" onblur=\"BERLIN3.common.modify('invoice_id','575','leading_text','invoices','2023-08-02 11:02:10',this);\"></textarea>\r\n\t\t</div>\r\n\r\n\t</div>\r\n\r\n\t<div class=\"fr w50\">\r\n\r\n\t\t<!--##################################### trailing text ######################################### -->\r\n\t\t<div class=\"wb\">\r\n\t\t\t<table id=\"lt_tt_table-575\" class=\"MainTableHead\">\r\n\t\t\t\t<tbody>\r\n\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t<td class=\"tda\">Trailing Text</td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</tbody>\r\n\t\t\t</table>\r\n\t\t</div>\r\n\t\t<div class=\"h140\">\r\n\t\t\t<textarea id=\"trailing_text_575\" class=\"textarea h130\" onblur=\"BERLIN3.common.modify('invoice_id','575','trailing_text','invoices','2023-08-02 11:02:10',this);\"></textarea>\r\n\t\t</div>\r\n\r\n\t</div>\r\n\r\n</div>\r\n\r\n<div class=\"fr w40\">\r\n\t<!--##################################### mandatory infos ######################################### -->\r\n\t<div class=\"mb10\">\r\n\t\t<div class=\"wb\">\r\n\t\t\t<table id=\"mandatory_info_header-575\" class=\"MainTableHead\">\r\n\t\t\t\t<tbody>\r\n\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t<td class=\"tda\">Mandatory Info</td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</tbody>\r\n\t\t\t</table>\r\n\t\t</div>\r\n\t\t<div class=\"modalTable mb10 h00\">\r\n\t\t\t<table id=\"manadatory_info-575\" style=\"width:100%;\">\r\n\t\t\t\t<tbody>\r\n\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t<td align=\"right\" class=\"tda\" width=\"24%\">Project</td>\r\n\t\t\t\t\t\t<td class=\"tdb\">\r\n\t\t\t\t\t\t\t<select id=\"invoice_project_575\" class=\"box en_disble_on_lockflag\" invoice_id=\"575\" onchange=\"BERLIN3.accounting_invoices.changeInvoiceProject(this);\" style=\"width: 50%;\">\r\n\t\t\t\t\t\t\t\t<option></option>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t<option value=\"1\" payment_method=\"4\" money_account=\"2\"  invoice_ref=\"details-#yyyy#-#nr#\" country=\"Germany\" vat_rate1=\"19.00\" vat_rate2=\"6.00\" selected=\"selected\">Details Label</option>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t<option value=\"227\" payment_method=\"\" money_account=\"\"  invoice_ref=\"\" country=\"\" vat_rate1=\"\" vat_rate2=\"\" >Details Label COPY</option>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t<option value=\"206\" payment_method=\"1\" money_account=\"1\"  invoice_ref=\"details-#yyyy#-#nr#\" country=\"Germany\" vat_rate1=\"19.00\" vat_rate2=\"7.00\" >Details Order</option>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t<option value=\"204\" payment_method=\"1\" money_account=\"1\"  invoice_ref=\"details-#yyyy#-#nr#\" country=\"Germany\" vat_rate1=\"19.00\" vat_rate2=\"7.00\" >Details UK</option>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t<option value=\"211\" payment_method=\"\" money_account=\"2\"  invoice_ref=\"DF-XYZ-#yyyy#-#nr3#\" country=\"Germany\" vat_rate1=\"19.00\" vat_rate2=\"7.00\" >DJ XYZ</option>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t<option value=\"100\" payment_method=\"1\" money_account=\"2\"  invoice_ref=\"RE #yyyy# - #nr#\" country=\"Germany\" vat_rate1=\"19.00\" vat_rate2=\"7.00\" >Invoice Including Barcode</option>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t<option value=\"226\" payment_method=\"9\" money_account=\"1\"  invoice_ref=\"MMI #yyyy# #nr4#\" country=\"United Kingdom\" vat_rate1=\"\" vat_rate2=\"\" >Magical Melodies Invoices</option>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t<option value=\"225\" payment_method=\"\" money_account=\"\"  invoice_ref=\"\" country=\"\" vat_rate1=\"\" vat_rate2=\"\" >New Royalty Project</option>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t<option value=\"2\" payment_method=\"1\" money_account=\"2\"  invoice_ref=\"RS #nr4#\" country=\"France\" vat_rate1=\"19.00\" vat_rate2=\"7.00\" >Royalty Statements changed </option>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t<option value=\"20\" payment_method=\"5\" money_account=\"1\"  invoice_ref=\"K7 #nr4#\" country=\"Germany\" vat_rate1=\"19.00\" vat_rate2=\"7.00\" >Royalty Statements K7</option>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t<option value=\"205\" payment_method=\"1\" money_account=\"20\"  invoice_ref=\"RS #nr4#\" country=\"France\" vat_rate1=\"19.00\" vat_rate2=\"7.00\" >Royalty Statements UK</option>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t<option value=\"203\" payment_method=\"4\" money_account=\"1\"  invoice_ref=\"RS #nr4#\" country=\"Germany\" vat_rate1=\"19.00\" vat_rate2=\"7.00\" >Royalty Statements2</option>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t<option value=\"215\" payment_method=\"\" money_account=\"2\"  invoice_ref=\"\" country=\"\" vat_rate1=\"\" vat_rate2=\"\" >TEST </option>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t<option value=\"217\" payment_method=\"1\" money_account=\"1\"  invoice_ref=\"\" country=\"Germany\" vat_rate1=\"\" vat_rate2=\"\" >test</option>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t<option value=\"216\" payment_method=\"\" money_account=\"\"  invoice_ref=\"\" country=\"\" vat_rate1=\"\" vat_rate2=\"\" >TEST 2</option>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t</select>\r\n\t\t\t\t\t\t\t<input id=\"display_correction_575\" class=\"box en_disble_on_lockflag\" type=\"checkbox\" key_value=\"575\" column=\"display_correction\" table=\"invoices\" last_modified=\"2023-08-02 11:02:10\" onclick=\"berlin3.common.modify(this);\"  /> Correction\r\n\t\t\t\t\t\t</td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t<td align=\"right\">Currency</td>\r\n\t\t\t\t\t\t<td>\r\n\t\t\t\t\t\t\t<select id=\"currency_575\" class=\"en_disble_on_lockflag\" onchange=\"BERLIN3.accounting_invoices.changeCurrency(this);\">\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t<option value=\"11\" exchange_rate=\"1.4553\" currency_iso=\"CAD\" >CAD</option>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t<option value=\"12\" exchange_rate=\"0.9554\" currency_iso=\"CHF\" >CHF</option>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t<option value=\"10\" exchange_rate=\"7.4527\" currency_iso=\"DKK\" >DKK</option>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t<option value=\"1\" exchange_rate=\"1\" currency_iso=\"EUR\" >EUR</option>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t<option value=\"23\" exchange_rate=\"100\" currency_iso=\"GAL\" >GAL</option>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t<option value=\"3\" exchange_rate=\"0.8556\" currency_iso=\"GBP\" >GBP</option>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t<option value=\"14\" exchange_rate=\"8.5865\" currency_iso=\"HKD\" >HKD</option>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t<option value=\"18\" exchange_rate=\"4.0717\" currency_iso=\"ILS\" >ILS</option>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t<option value=\"17\" exchange_rate=\"90.501\" currency_iso=\"INR\" >INR</option>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t<option value=\"4\" exchange_rate=\"153.35\" currency_iso=\"JPY\" >JPY</option>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t<option value=\"7\" exchange_rate=\"18.3975\" currency_iso=\"MXN\" >MXN</option>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t<option value=\"9\" exchange_rate=\"11.168\" currency_iso=\"NOK\" >NOK</option>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t<option value=\"6\" exchange_rate=\"1.7855\" currency_iso=\"NZD\" selected=\"selected\">NZD</option>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t<option value=\"19\" exchange_rate=\"73.4773\" currency_iso=\"RUR\" >RUR</option>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t<option value=\"8\" exchange_rate=\"11.5545\" currency_iso=\"SEK\" >SEK</option>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t<option value=\"13\" exchange_rate=\"1.4653\" currency_iso=\"SGD\" >SGD</option>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t<option value=\"21\" exchange_rate=\"29.6771\" currency_iso=\"TRY\" >TRY</option>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t<option value=\"15\" exchange_rate=\"35.661\" currency_iso=\"TWD\" >TWD</option>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t<option value=\"2\" exchange_rate=\"1.101\" currency_iso=\"USD\" >USD</option>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t<option value=\"22\" exchange_rate=\"26765\" currency_iso=\"VND\" >VND</option>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t<option value=\"16\" exchange_rate=\"19.4309\" currency_iso=\"ZAR\" >ZAR</option>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t</select>\r\n\t\t\t\t\t\t</td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t<td align=\"right\">User</td>\r\n\t\t\t\t\t\t<td>\r\n\t\t\t\t\t\t\t<select id=\"invoice_user-575\" class=\"en_disble_on_lockflag\" onchange=\"BERLIN3.common.modify('invoice_id','575','invoice_user_id','invoices','2023-08-02 11:02:10',this);\">\r\n\t\t\t\t\t\t\t\t<option></option>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t<option value=\"231\" >aa</option>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t<option value=\"44\" >aki2</option>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t<option value=\"159\" >Anika</option>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t<option value=\"81\" >foysal</option>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t<option value=\"217\" >geralt</option>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t<option value=\"110\" >hannes</option>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t<option value=\"118\" >jim</option>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t<option value=\"156\" >lucie</option>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t<option value=\"106\" >noman</option>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t<option value=\"157\" >peta</option>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t<option value=\"232\" >RESTRICTED</option>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t<option value=\"124\" >safiqul</option>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t<option value=\"107\" >samir</option>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t<option value=\"233\" >Selenium</option>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t<option value=\"219\" >silja</option>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t<option value=\"114\" >Simo</option>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t<option value=\"168\" >solid</option>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t<option value=\"160\" >strom</option>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t<option value=\"80\" >syedi</option>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t</select>\r\n\t\t\t\t\t\t</td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t<td align=\"right\"><a href=\"#\" onclick=\"BERLIN3.accounting_invoices.generateInvoiceRef('575');\">Invoice No. </a></td>\r\n\t\t\t\t\t\t<td><input id=\"invoice_ref_575\" type=\"text\" class=\"text en_disble_on_lockflag\" value=\"details-2023-0087\" onblur=\"BERLIN3.common.modify('invoice_id','575','invoice_ref','invoices','2023-08-02 11:02:10',this);onchange_invoice_number('575',this.value)\" />\r\n\t\t\t\t\t\t</td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t<td align=\"right\">Invoice Date</td>\r\n\t\t\t\t\t\t<td><input id=\"invoice_date_575\" type=\"text\" class=\"en_disble_on_lockflag\" value=\"2023-08-02\" onfocus=\"pickDay(this,this);callback_code = 'BERLIN3.common.modify(\\'invoice_id\\',\\'575\\',\\'invoice_date\\',\\'invoices\\',\\'2023-08-02 11:02:10\\',document.getElementById(\\'invoice_date_575\\'))';\" onblur=\"if(this.value != this.getAttribute('oldval')) {BERLIN3.accounting_invoices.update_status_color('575');}\" /></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t<td align=\"right\">Language</td>\r\n\t\t\t\t\t\t<td>\r\n\t\t\t\t\t\t\t<select id=\"invoice_language_575\" onchange=\"BERLIN3.common.modify('invoice_id','575','invoice_language','invoices','2023-08-02 11:02:10',this);\">\r\n\t\t\t\t\t\t\t\t<option></option>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t<option value=\"en\" >English</option>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t<option value=\"de\" >German</option>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t<option value=\"fr\" >French</option>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t<option value=\"it\" >Italian</option>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t<option value=\"es\" >Spanish</option>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t<option value=\"pt\" >Portuguese</option>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t<option value=\"pl\" >Polish</option>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t</select>\r\n\t\t\t\t\t\t</td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t<td align=\"right\">Performance Date</td>\r\n\t\t\t\t\t\t<td><input id=\"performance_date_575\" type=\"text\"  value=\"\" onfocus=\"callback_code = 'BERLIN3.common.modify(\\'invoice_id\\',\\'575\\',\\'performance_date\\',\\'invoices\\',\\'2023-08-02 11:02:10\\',document.getElementById(\\'performance_date_575\\'))';pickDay(this,this);\" style=\"width: 37%;\" /></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t<td align=\"right\">Performance Place</td>\r\n\t\t\t\t\t\t<td>\r\n\t\t\t\t\t\t\t<input id=\"performance_country_575\" type=\"text\" class=\"text\" value=\"\" onblur=\"BERLIN3.common.modify('invoice_id','575','performance_country','invoices','2023-08-02 11:02:10',this);\" style=\"width: 37%;\" />\r\n\t\t\t\t\t\t\t&nbsp;&nbsp;\r\n\t\t\t\t\t\t\t<span>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t<a href=\"javascript:void(0);\" id=\"choose_vat_territory_575\" key_value=\"575\" column=\"vat_territory\" table=\"invoices\" last_modified=\"2023-08-02 11:02:10\" class=\"en_disble_link_on_lockflag\">VAT Territory</a>\r\n\r\n\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t&nbsp;\r\n\t\t\t\t\t\t\t<span id=\"vat_territory_container_575\">\r\n\t\t\t\t\t\t\t\t<input id=\"vat_territory_575\" type=\"text\" class=\"text en_disble_on_lockflag\" value=\"\" onblur=\"BERLIN3.common.modify('invoice_id','575','vat_territory','invoices','2023-08-02 11:02:10',this);\" style=\"width: 25%;\" />\r\n\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t</td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</tbody>\r\n\t\t\t</table>\r\n\t\t</div>\r\n\t</div>\r\n\t<!--##################################### payment terms ######################################### -->\r\n\t<div class=\"mb10\">\r\n\t\t<div class=\"wb\">\r\n\t\t\t<table id=\"payment_term_header-575\" class=\"MainTableHead\">\r\n\t\t\t\t<tbody>\r\n\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t<td class=\"tda\">Payment Terms</td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</tbody>\r\n\t\t\t</table>\r\n\t\t</div>\r\n\t\t<div class=\"modalTable mb10 h95\">\r\n\t\t\t<table id=\"payment_term-575\" class=\"fullWidth fixedLayout en_disble_on_lockflag\">\r\n\t\t\t\t<tbody>\r\n\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t<td align=\"right\" class=\"tda\" width=\"30%\">Due Days</td>\r\n\t\t\t\t\t\t<td class=\"tdb\" width=\"70%\"><input id=\"due_days_575\" type=\"text\" class=\"stext stext\" onblur=\"calculate_payment_date_and_save($(this).val(), '575');if(this.value != this.getAttribute('oldval')){BERLIN3.accounting_invoices.update_status_color('575');}\" value=\"10\" size=\"4\" maxlength=\"3\" />\r\n\t\t\t\t\t\t\t<input id=\"end_of_month_flag_575\" type=\"checkbox\" onclick=\"this.value = this.checked ? 1 : 0;BERLIN3.common.modify('invoice_id','575','end_of_month_flag','invoices','2023-08-02 11:02:10',this);BERLIN3.accounting_invoices.update_status_color('575');\"  /> End Of Month\r\n\t\t\t\t\t\t\t&nbsp;&nbsp;\r\n\t\t\t\t\t\t\t<a href=\"#\" onclick=\"BERLIN3.common.pickDate(this, $('#payment_date_575').get(0));\"><img src=\"/images/newimg/Calendar.png\" /></a>\r\n\t\t\t\t\t\t\t&nbsp;&nbsp;\r\n\t\t\t\t\t\t\t<span id=\"payment_date_575\" inv-date=\"2023-08-02\" action=\"callback\" callback=\"calculate_due_days_and_save('575')\"></span>\r\n\t\t\t\t\t\t</td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t<td align=\"right\">Discount</td>\r\n\t\t\t\t\t\t<td><input id=\"discount_days_575\" type=\"text\" class=\"text stext\" value=\"\" onblur=\"BERLIN3.common.modify('invoice_id','575','discount_days','invoices','2023-08-02 11:02:10',this);\" /> days <input id=\"discount_percent_575\" type=\"text\" class=\"text stext\" value=\"\" onblur=\"BERLIN3.common.modify('invoice_id','575','discount_percent','invoices','2023-08-02 11:02:10',this);\"  /> %</td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t<td align=\"right\">Payment Method</td>\r\n\t\t\t\t\t\t<td>\r\n\r\n\t\t\t\t\t\t\t<select id=\"payment_method_575\" onblur=\"BERLIN3.common.modify('invoice_id','575','payment_method_id','invoices','2023-08-02 11:02:10',this);\">\r\n\t\t\t\t\t\t\t\t<option value=\"\"></option>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t<option value=\"1\" >Wire Transfer</option>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t<option value=\"2\" >Credit Card</option>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t<option value=\"3\" >Direct Debit</option>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t<option value=\"4\" selected=\"selected\">Paypal</option>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t<option value=\"5\" >Cash</option>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t<option value=\"6\" >Invoice</option>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t<option value=\"7\" >Cheque</option>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t<option value=\"8\" >Prepayment</option>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t<option value=\"9\" >Barter Deal</option>\r\n\t\t\t\t\t\t\t\t\r\n\r\n\t\t\t\t\t\t\t</select>\r\n\t\t\t\t\t\t</td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t<td align=\"right\">Money Account</td>\r\n\t\t\t\t\t\t<td>\r\n\t\t\t\t\t\t\t<select id=\"money_account_575\" onblur=\"BERLIN3.common.modify('invoice_id','575','money_account_id','invoices','2023-08-02 11:02:10',this);\" >\r\n\t\t\t\t\t\t\t\t<option value=\"\"></option>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t<option value=\"1\" >a&bbc</option>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t<option value=\"2\" selected=\"selected\">EBL</option>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t</select>\r\n\t\t\t\t\t\t</td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</tbody>\r\n\t\t\t</table>\r\n\t\t</div>\r\n\t</div>\r\n\t<!--##################################### invoice summary ######################################### -->\r\n\t<div id=\"invoice_totals_box_575\">\r\n\t\t<div class=\"hdiv\">\r\n\t\t\t<span class=\"htext fchild\" style=\"width:90%;\">Invoice Totals</span>\r\n\t\t</div>\r\n\t\t<div class=\"h00\" style=\"height:70px;padding-left:3px;\" id=\"invoice_totals_575\">\r\n\t\t\t\r\n\t\t\t<div style=\"margin-top: 3px;\">\r\n\t\t\t\t<span class=\"column\" style=\"width: 70%;\">Net Amount</span>\r\n\t\t\t\t<span class=\"rcolumn\" style=\"width:28%;\">1,165.78 NZD</span>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t\t<div style=\"margin-top: 3px;\">\r\n\t\t\t\t<span class=\"column\" style=\"width: 70%;\">Gross Amount</span>\r\n\t\t\t\t<span class=\"rcolumn\" style=\"width:28%;\">1,165.78 NZD</span>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t\t<div style=\"margin-top: 3px;\">\r\n\t\t\t\t<span class=\"column\" style=\"width: 70%;\">Exchange Rate</span>\r\n\t\t\t\t<span class=\"rcolumn\" style=\"width:28%;\">1.785500 NZD</span>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t\t<div style=\"margin-top: 3px;\">\r\n\t\t\t\t<span class=\"column\" style=\"width: 70%;\">Net System Curr</span>\r\n\t\t\t\t<span class=\"rcolumn\" style=\"width:28%;\">652.92 EUR</span>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t</div>\r\n\t</div>\r\n\t\r\n\t<div style=\"padding-top: 10px; float: right;text-align:right;\">\r\n\t\t\r\n\r\n\t\t<span>\r\n\t\t\t<a href=\"javascript:void(0);\"><img id=\"invoiceOverViewLockedUnlocked_575\" src=\"/images/newimg/unlocked.png\" invoice_id=\"575\" lock_flag=\"\" callback=\"berlin3.invoices.enDisbleDivsOnLockFlag\" onclick=\"berlin3.invoices.lockUnlockInvoice(this);\" /></a>\r\n\t\t</span>\r\n\r\n\t\t<span style=\"padding: 0 7px;\" >\r\n\t\t\t<a href=\"javascript:void(0)\"><img src=\"/images/newimg/Edit.png\" onclick=\"berlin3.invoices.openInvoiceFlagChangeModal(this);\" invoice_id=\"575\" /></a>\r\n\t\t</span>\r\n\r\n\t\t<span>\r\n\t\t\t<a href=\"javascript:void(0);\" onclick1=\"window.open('accounting.pl?section=invoices&action=print_invoice&invoice_id=575','_blank','menubar=yes,scrollbars=yes');\"><img src=\"/images/newimg/Printer.png\" onclick=\"berlin3.invoices.printInvoice(this);\" lockedUnlockedObj=\"#invoiceOverViewLockedUnlocked_575\" invoice_id=\"575\" lock_flag=\"\" /></a>\r\n\t\t</span>\r\n\r\n\t\t<span style=\"padding-left: 5px; display: inline; vertical-align: middle;\">\r\n\t\t\t<div style=\"width:10px;height:10px;background-color:#fffe00;border:1px solid #000;display:inline-block;\" invoice_id=\"575\" class=\"invoice-status-div\"></div>\r\n\t\t</span>\r\n\r\n\t\t\r\n\t</div>\r\n\t<div style=\"padding-top:10px;\">\r\n\t\t<span>\r\n\t\t\t<input type=\"button\" class=\"refresh-invoice-overview\" value=\"Refresh\" invoice_id=\"575\" />\r\n\t\t</span>\r\n\t\t\r\n\t\t\r\n\t</div>\r\n</div>\r\n\r\n<script type=\"text/javascript\">\r\n (function(){\r\n\r\n\t $('#invoice_tabview_575 :input').attr('oldval',function(index,attr){\r\n\t\t return this.value;\r\n\t });\r\n })();\r\n BERLIN3.accounting_invoices.changeInvoiceProject = function(obj){\r\n \t var index = obj.selectedIndex;\r\n\t var invoice_project_id = obj[index].value;\r\n\t var payment_method_id = obj[index].getAttribute('payment_method');\r\n\t var money_account_id = obj[index].getAttribute('money_account');\r\n\t var vat_rate1 = obj[index].getAttribute('vat_rate1') || 0;\r\n\t var vat_rate2 = obj[index].getAttribute('vat_rate2') || 0;\r\n\t var proj_country = obj[index].getAttribute('country') || '';\r\n\t var contact_country = 'United Kingdom';\r\n\t var payObj = document.getElementById('payment_method_575');\r\n\t var moneyObj = document.getElementById('money_account_575');\r\n\t var length = payObj.length;\r\n\t for(var i=0;i<length;i++){\r\n\t\t if(payObj[i].value == payment_method_id){\r\n\t\t\t payObj[i].selected = true;\r\n\t\t\t break;\r\n\t\t }\r\n\t }\r\n\t length = moneyObj.length;\r\n\t for(var i=0;i<length;i++){\r\n\t\t if(moneyObj[i].value == money_account_id){\r\n\t\t\t moneyObj[i].selected = true;\r\n\t\t\t break;\r\n\t\t }\r\n\t }\r\n\t let invoice_id = $(obj).attr('invoice_id');\r\n\t let params = {\r\n\t\t section: 'invoices',\r\n\t\t action: 'change_invoice_project',\r\n\t\t invoice_id: invoice_id,\r\n\t\t invoice_project_id: invoice_project_id,\r\n\t\t payment_method_id: payment_method_id,\r\n\t\t money_account_id: money_account_id,\r\n\t\t vat_rate1: vat_rate1,\r\n\t\t vat_rate2: vat_rate2,\r\n\t\t vat_rate3: ''\r\n\t };\r\n\r\n\t //var params = 'modify_type=record&table=invoices&kVal=575';\r\n\t //params+='&invoice_project_id='+invoice_project_id;\r\n\t //params+='&payment_method_id='+payment_method_id;\r\n\t //params+='&money_account_id='+money_account_id;\r\n\r\n\t if (proj_country.toLowerCase() == contact_country.toLowerCase()){\r\n\t\t //params+='&vat_handling=1';\r\n\t\t params.vat_handling = 1;\r\n\t }\r\n\t else {\r\n\t\t params.vat_handling = 3;\r\n\t\t params.tax_type_id_deduction = '';\r\n\t\t //params+='&vat_handling=3&tax_type_id_deduction=0';\r\n\t }\r\n\t //params+='&vat_rate1='+vat_rate1+'&vat_rate2='+vat_rate2+'&vat_rate3=0';\r\n\t //DHTMLSuite.ajax.sendRequest('modify.pl',params);\r\n\r\n\r\n\t $.post('accounting.pl', params, function(data) {\r\n\t\t let invoice = data.invoice;\r\n\t\t let tabIndex = accountingInvoices.getTabIndexByTitle(data.prev_invoice_ref);\r\n\t\t accountingInvoices.deleteTab(undefined, tabIndex);\r\n\t\t $('#invoiceRow_' + invoice_id).find('span a.open-invoice').text(invoice.invoice_ref);\r\n\t\t BERLIN3.common.activateInvoice(invoice.invoice_ref, invoice.invoice_id);\r\n\t }, 'json');\r\n };\r\n BERLIN3.accounting_invoices.changeCurrency = function(obj){\r\n\t var index = obj.selectedIndex;\r\n\t var currency_id = obj[index].value;\r\n\t var exchange_rate = obj[index].getAttribute('exchange_rate');\r\n\t var currency_iso = obj[index].getAttribute('currency_iso');\r\n\t let curr1 = document.getElementById('currency1_575');\r\n\t let curr2 = document.getElementById('currency2_575');\r\n\t let curr3 = document.getElementById('currency3_575');\r\n\t if (curr1 != null) {\r\n\t\t curr1.innerHTML = currency_iso;\r\n\t }\r\n\t if (curr2 != null) {\r\n\t\t curr2.innerHTML = currency_iso;\r\n\t }\r\n\t if (curr3 != null) {\r\n\t\t curr3.innerHTML = currency_iso;\r\n\t }\r\n\t var params = 'modify_type=record&table=invoices&kVal=575';\r\n\t params+='&currency_id='+currency_id;\r\n\t params+='&exchange_rate='+exchange_rate;\r\n\t DHTMLSuite.ajax.sendRequest('modify.pl',params);\r\n };\r\n\r\n BERLIN3.accounting_invoices.generateInvoiceRef = function(invoice_id){\r\n     var $invoice_no = $('#invoice_ref_' + invoice_id);\r\n\t var invoice_ref_val = $invoice_no.val();\r\n\t if (invoice_ref_val == ''){\r\n\t\t var $invoice_project = $('#invoice_project_' + invoice_id + ' option:selected');\r\n\t\t var invoice_project_id = $invoice_project.val();\r\n\t\t if (!invoice_project_id) {\r\n\t\t\t return;\r\n\t\t }\r\n\t\t var str = $invoice_project.attr('invoice_ref');\r\n\t\t var dateObj = new Date();\r\n\t\t var year = dateObj.getFullYear();\r\n\t\t var month = dateObj.getMonth()+1;\r\n\t\t month = (month < 10 ? ('0'+month) : month);\r\n\t\t var invoice_ref_key = (str.replace(/#yyyy#/g,year)).replace(/#mm#/g,month);\r\n\r\n\t\t $.post('accounting.pl', {\r\n\t\t\t section: 'invoices',\r\n\t\t\t action: 'generate_invoice_ref',\r\n\t\t\t invoice_id: invoice_id,\r\n\t\t\t invoice_project_id: invoice_project_id,\r\n\t\t\t invoice_ref_key: invoice_ref_key\r\n\t\t }, function(data){\r\n\t\t\t $invoice_no.val(data.invoice_ref);\r\n\t\t }, \"json\");\r\n\t }\r\n };\r\n\r\n BERLIN3.accounting_invoices.contact_id = '';\r\n BERLIN3.accounting_invoices.name = '';\r\n BERLIN3.accounting_invoices.type = '';\r\n BERLIN3.accounting_invoices.check_invoice_address = function(name,invoice_id){\r\n\t var data = Jemplate.JSON.parse(Jemplate.Ajax.get('accounting.pl?section=invoices&action=check_invoice_address_name&name='+name+'&invoice_id='+invoice_id));\r\n\t var obj = document.getElementById('inv_name_'+invoice_id);\r\n\t if(data.link == 1){\r\n\t\t obj.style.fontWeight = 'bold';\r\n\t\t BERLIN3.accounting_invoices.contact_id = data.contact_id;\r\n\t\t BERLIN3.accounting_invoices.name = name;\r\n\t\t BERLIN3.accounting_invoices.type = data.type;\r\n\t\t obj.onclick = function(){\r\n\t\t\t active_contact(BERLIN3.accounting_invoices.name,BERLIN3.accounting_invoices.contact_id,BERLIN3.accounting_invoices.type);\r\n\t\t };\r\n\t }else{\r\n\t\t obj.style.fontWeight = 'normal';\r\n\t\t obj.onclick = function(){};\r\n\t }\r\n\r\n };\r\n\r\n BERLIN3.accounting_invoices.check_vat_id = function(obj){\r\n\t var contact_id = $(obj).attr('contact_id');\r\n\t var invoice_id = $(obj).attr('invoice_id');\r\n\t var email1 = $(obj).attr('email1');\r\n\t var vat_no =  $(obj).val();\r\n\t $.post('contacts.pl', {\r\n\t\t section: '',\r\n\t\t action: 'check_vat_id',\r\n\t\t vat_no:  vat_no,\r\n\t\t invoice_id: invoice_id,\r\n\t\t contact_id: contact_id,\r\n\t\t type: \"invoice\"\r\n\t }, function(data){\r\n\t\t if(data.valid==1) {\r\n\t\t\t $(\"span#check_valid_vat_no_bt_\"+ invoice_id).html('<input type=\"button\" value=\"Vat Valid\" onclick=\"BERLIN3.accounting_invoices.check_valid_vat_no(\\''+vat_no+'\\', \\''+invoice_id+'\\');\"/>');\r\n\t\t } else {\r\n\t\t\t $(\"span#check_valid_vat_no_bt_\"+ invoice_id).html('<input type=\"button\" value=\"Vat Invalid\" onclick=\"BERLIN3.accounting_invoices.email_vat_invalid(\\''+email1+'\\');\" style=\"background-color: #ff0000; color: #000;\"/>');\r\n\t\t }\r\n\t }, \"json\");\r\n };\r\n\r\n BERLIN3.accounting_invoices.check_valid_vat_no = function(vat_no, invoice_id){\r\n\t $.post('accounting.pl', {\r\n\t\t section: 'invoices',\r\n\t\t action: 'check_valid_vat_no',\r\n\t\t vat_no:  vat_no,\r\n\t\t invoice_id: invoice_id\r\n\t }, function(data){\r\n\t\t if(data.valid==1) {\r\n\t\t\t /*information = data.informations;\r\n\t\t\t\tOpenWindow=window.open(\"\", \"check_valid_vat_no\", \"toolbar=yes,scrollbars=yes,menubar=yes\");\r\n\t\t\t\tOpenWindow.document.write(\"</html><title>VAT Number Check</title><body><h1>VAT Number is Valid</h1><table><tr><td>VAT Number: </td><td>\"+vat_no+\"</td></tr><tr><td>Name: </td><td>\"+information.name+\"</td></tr><tr><td>Address: </td><td>\"+information.address+\"</td></tr></table></body></html>\");\r\n\t\t\t\tOpenWindow.document.close();*/\r\n\t\t\t window.open(data.vat_url);\r\n\t\t }\r\n\t }, \"json\");\r\n };\r\n\r\n BERLIN3.accounting_invoices.email_vat_invalid = function(email){\r\n\t window.location.href = 'mailto:'+ email +'?subject=' + encodeURIComponent('Re: VAT') + '&body=';\r\n };\r\n\r\n $(\"textarea#leading_text_575\").autocomplete({\r\n\t source: \"accounting.pl?section=invoices&action=leading_text_autocom_list\",\r\n\t open: function(event, ui) { $(\".ui-autocomplete\").css(\"z-index\", 10000); },\r\n\t close: function(event, ui) { $(\".ui-autocomplete\").css(\"z-index\", 1); }\r\n });\r\n\r\n $(\"textarea#trailing_text_575\").autocomplete({\r\n\t source: \"accounting.pl?section=invoices&action=trailing_text_autocom_list\",\r\n\t open: function(event, ui) { $(\".ui-autocomplete\").css(\"z-index\", 10000); },\r\n\t close: function(event, ui) { $(\".ui-autocomplete\").css(\"z-index\", 1); }\r\n });\r\n\r\n var calculate_due_days_and_save = function(invoice_id) {\r\n\t var payment_date = $('#payment_date_' + invoice_id).val();\r\n\t var invoice_date = $('#payment_date_' + invoice_id).attr('inv-date');\r\n\r\n\t var due_days = berlin3.dateDiff(payment_date, invoice_date);\r\n\t var due_days_date = berlin3.addDay(invoice_date, due_days);\r\n\r\n\t $('#due_days_' + invoice_id).val(due_days);\r\n\t $('#payment_date_' + invoice_id).html(due_days_date);\r\n\r\n\t $.post('modify.pl', {\r\n\t\t modify_type: 'record',\r\n\t\t table: BERLIN3.common.TABLES['invoice_id'],\r\n\t\t kVal: invoice_id,\r\n\t\t due_days: due_days\r\n\t });\r\n };\r\n\r\n var calculate_payment_date_and_save = function(due_days, invoice_id) {\r\n\t /*var payment_date = berlin3.addDay(berlin3.today(), due_days);\r\n\t\t$('#payment_date_' + invoice_id).val(payment_date);\r\n\t\t$('#payment_date_' + invoice_id).html(payment_date);*/\r\n\t $.post('modify.pl', {\r\n\t\t modify_type: 'record',\r\n\t\t table: BERLIN3.common.TABLES['invoice_id'],\r\n\t\t kVal: invoice_id,\r\n\t\t //payment_date: payment_date,\r\n\t\t due_days: due_days\r\n\t });\r\n };\r\n\r\n var onchange_invoice_number =function(invoice_id,invoice_num){\r\n\t $('#invoices_table_container a[invoice_id='+invoice_id+']').text(invoice_num);\r\n\t var $img = $('div.tabActive[parentrefid=accounting_invoices] span').find('img');\r\n\t $('div.tabActive[parentrefid=accounting_invoices] span').text(invoice_num+'\\xa0\\xa0\\xa0\\xa0\\xa0\\xa0');\r\n\t $('div.tabActive[parentrefid=accounting_invoices] span').append($img);\r\n }\r\n\r\n $(document).ready(function(){\r\n\t var invoice_date = $('#payment_date_575').attr('inv-date');\r\n\t var due_days = $('#due_days_575').val();\r\n\t var due_days_date = berlin3.addDay(invoice_date, due_days);\r\n\t $('#payment_date_575').html(due_days_date);\r\n\r\n     berlin3.invoices.enDisbleDivsOnLockFlag($(\"<div></div>\").attr('invoice_id', \"575\").attr('lock_flag', \"\"));\r\n\r\n     var manadatoryInfoBox = document.querySelector(`#manadatory_info-575`);\r\n\t var cvtLinkElm = manadatoryInfoBox.querySelector(`#choose_vat_territory_575`);\r\n\t cvtLinkElm &&\r\n     cvtLinkElm.addEventListener(\"click\", berlin3.ui.chooseVatTerritoryModal);\r\n });\r\n\r\n\r\n (function() {\r\n\tlet invoice_id = '575';\r\n\r\n\r\n\tBERLIN3.accounting_invoices.check_adjusted_royalty_dates = function(obj) {\r\n    \r\n\t    let invoice_id = $(obj).attr('item_id') || '';\r\n\t    \r\n\t    if(!invoice_id) {\r\n\t        return;\r\n\t    }\r\n\t    \r\n\t\t$.post('accounting.pl', {\r\n\t\t\tsection: 'invoices',\r\n\t\t\taction: 'check_and_adjust_roylaty_dates',\r\n\t\t\tinvoice_id: invoice_id\r\n\t \t}, function(data) {\r\n\t\t\tif (data.status == 'permission') {\r\n\t\t\t\tdisplayStaticMessage(data.html, 400, 220);\r\n\t\t\t\tberlin3.common.compressHtml($('#DHTMLSuite_modalBox_contentDiv #modal_page').get(0));\r\n\t\t\t\tberlin3.common.colorRows('#DHTMLSuite_modalBox_contentDiv #modal_statements');\r\n\r\n\t\t\t\t// $('#DHTMLSuite_modalBox_contentDiv #modal_proceed').click(function(evt) {\r\n\t\t\t\t// \tvar invoice_id = $(evt.target).attr('invoice_id');\r\n\t\t\t\t// \t$.post('accounting.pl', {\r\n\t\t\t\t// \t\tsection: 'invoices',\r\n\t\t\t\t// \t\taction: 'adjust_royalty_dates',\r\n\t\t\t\t// \t\tinvoice_id: invoice_id\r\n\t\t\t\t// \t});\r\n\t\t\t\t// \tcloseMessage();\r\n\t\t\t // \t});\r\n\t\t \t} \r\n\t\t \telse {\r\n\t\t \t\tberlin3.common.open_delete_confirm_modal(obj);\r\n\t\t \t}\r\n\t \t});\r\n\r\n\t };\r\n\r\n\r\n\tBERLIN3.accounting_invoices.adjust_royalty_dates = function(msg, obj) {\r\n    \r\n\t    let invoice_id = $(obj).attr('item_id') || '';\r\n\t    \r\n\t    if(!invoice_id) {\r\n\t        return;\r\n\t    }\r\n\t    closeMessage();\r\n\t    \r\n\t\t$.post('accounting.pl', {\r\n\t\t\tsection: 'invoices',\r\n\t\t\taction: 'adjust_royalty_dates',\r\n\t\t\tinvoice_id: invoice_id\r\n\t \t}, function(data) {\r\n\t \t});\r\n\r\n\t};\r\n\t// berlin3.common.compressHtml(document.getElementById(`invoice_totals_box_${invoice_id}`));\r\n\t// berlin3.ui.colorRows(document.getElementById(`invoice_totals_${invoice_id}`));\r\n\r\n })();\r\n\r\n</script>\r\n"
          },
          "redirectURL": "",
          "headersSize": 530,
          "bodySize": 8161
        },
        "cache": {},
        "timings": {
          "blocked": -1,
          "dns": 0,
          "connect": 0,
          "ssl": 0,
          "send": 0,
          "wait": 685,
          "receive": 0
        },
        "time": 685,
        "_securityState": "secure",
        "serverIPAddress": "79.125.7.197",
        "connection": "443",
        "pageref": "page_2"
      },
      {
        "startedDateTime": "2023-08-02T17:02:15.756+06:00",
        "request": {
          "bodySize": 64,
          "method": "POST",
          "url": "https://dev.berlin3.com/designcheck/accounting.pl",
          "httpVersion": "HTTP/1.1",
          "headers": [
            {
              "name": "Host",
              "value": "dev.berlin3.com"
            },
            {
              "name": "User-Agent",
              "value": "Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/115.0"
            },
            {
              "name": "Accept",
              "value": "text/html, */*; q=0.01"
            },
            {
              "name": "Accept-Language",
              "value": "en-US,en;q=0.5"
            },
            {
              "name": "Accept-Encoding",
              "value": "gzip, deflate, br"
            },
            {
              "name": "Referer",
              "value": "https://dev.berlin3.com/designcheck/index.pl?start=1"
            },
            {
              "name": "Content-Type",
              "value": "application/x-www-form-urlencoded"
            },
            {
              "name": "X-Requested-With",
              "value": "XMLHttpRequest"
            },
            {
              "name": "Content-Length",
              "value": "64"
            },
            {
              "name": "Origin",
              "value": "https://dev.berlin3.com"
            },
            {
              "name": "Connection",
              "value": "keep-alive"
            },
            {
              "name": "Cookie",
              "value": "DISKO::AUTH_berlin3=geralt:2023-08-02-08-05-30:2023-08-04-08-05-30::e60a2e76975475a2a5584c7f616a3df2; mainWindow=width%3A990%2Cheight%3A620%2CxPos%3A0%2CyPos%3A0%2CzIndex%3A%2CactiveTabId%3AAccounting%2Cstate%3Aundefined; WindowSettings=width%3A990%2Cheight%3A600%2CxPos%3A2%2CyPos%3A2%2CzIndex%3A%2CactiveTabId%3ABookingSettingsTab%2Cstate%3Aundefined; WindowAccounting=width%3A990%2Cheight%3A600%2CxPos%3A2%2CyPos%3A2%2CzIndex%3A%2CactiveTabId%3AAccInvoicesTab%2Cstate%3Aundefined; WindowBooking=width%3A990%2Cheight%3A600%2CxPos%3A2%2CyPos%3A2%2CzIndex%3A%2CactiveTabId%3ABookCalendarTab%2Cstate%3Aundefined; WindowLabel=width%3A990%2Cheight%3A600%2CxPos%3A2%2CyPos%3A2%2CzIndex%3A%2CactiveTabId%3ALabelRoyaltyTab%2Cstate%3Aundefined; WindowDistribution=width%3A990%2Cheight%3A600%2CxPos%3A2%2CyPos%3A2%2CzIndex%3A%2CactiveTabId%3ADistAccountsTab%2Cstate%3Aundefined; WindowContacts=width%3A990%2Cheight%3A600%2CxPos%3A2%2CyPos%3A2%2CzIndex%3A%2CactiveTabId%3AGenContactsTab%2Cstate%3Aundefined; chatbox_minimized=Support%7CSupport; _ga=GA1.2.2001653648.1668753357; _ga_4GJL8L77LJ=GS1.1.1683275798.7.0.1683275798.0.0.0; _ga_BM42RTS79Q=GS1.2.1690175692.1.1.1690176135.0.0.0; CGISESSID=d13ec288b68da2ce5a3b6408ced3df7a"
            },
            {
              "name": "Sec-Fetch-Dest",
              "value": "empty"
            },
            {
              "name": "Sec-Fetch-Mode",
              "value": "cors"
            },
            {
              "name": "Sec-Fetch-Site",
              "value": "same-origin"
            }
          ],
          "cookies": [
            {
              "name": "DISKO::AUTH_berlin3",
              "value": "geralt:2023-08-02-08-05-30:2023-08-04-08-05-30::e60a2e76975475a2a5584c7f616a3df2"
            },
            {
              "name": "mainWindow",
              "value": "width:990,height:620,xPos:0,yPos:0,zIndex:,activeTabId:Accounting,state:undefined"
            },
            {
              "name": "WindowSettings",
              "value": "width:990,height:600,xPos:2,yPos:2,zIndex:,activeTabId:BookingSettingsTab,state:undefined"
            },
            {
              "name": "WindowAccounting",
              "value": "width:990,height:600,xPos:2,yPos:2,zIndex:,activeTabId:AccInvoicesTab,state:undefined"
            },
            {
              "name": "WindowBooking",
              "value": "width:990,height:600,xPos:2,yPos:2,zIndex:,activeTabId:BookCalendarTab,state:undefined"
            },
            {
              "name": "WindowLabel",
              "value": "width:990,height:600,xPos:2,yPos:2,zIndex:,activeTabId:LabelRoyaltyTab,state:undefined"
            },
            {
              "name": "WindowDistribution",
              "value": "width:990,height:600,xPos:2,yPos:2,zIndex:,activeTabId:DistAccountsTab,state:undefined"
            },
            {
              "name": "WindowContacts",
              "value": "width:990,height:600,xPos:2,yPos:2,zIndex:,activeTabId:GenContactsTab,state:undefined"
            },
            {
              "name": "chatbox_minimized",
              "value": "Support|Support"
            },
            {
              "name": "_ga",
              "value": "GA1.2.2001653648.1668753357"
            },
            {
              "name": "_ga_4GJL8L77LJ",
              "value": "GS1.1.1683275798.7.0.1683275798.0.0.0"
            },
            {
              "name": "_ga_BM42RTS79Q",
              "value": "GS1.2.1690175692.1.1.1690176135.0.0.0"
            },
            {
              "name": "CGISESSID",
              "value": "d13ec288b68da2ce5a3b6408ced3df7a"
            }
          ],
          "queryString": [],
          "headersSize": 1778,
          "postData": {
            "mimeType": "application/x-www-form-urlencoded",
            "params": [
              {
                "name": "section",
                "value": "invoices"
              },
              {
                "name": "action",
                "value": "invoice_tab_invoice_lines"
              },
              {
                "name": "invoice_id",
                "value": "575"
              }
            ],
            "text": "section=invoices&action=invoice_tab_invoice_lines&invoice_id=575"
          }
        },
        "response": {
          "status": 200,
          "statusText": "OK",
          "httpVersion": "HTTP/1.1",
          "headers": [
            {
              "name": "Date",
              "value": "Wed, 02 Aug 2023 11:02:15 GMT"
            },
            {
              "name": "Server",
              "value": "Apache/2.4.52 (Ubuntu) OpenSSL/3.0.2 mod_perl/2.0.12 Perl/v5.34.0"
            },
            {
              "name": "Set-Cookie",
              "value": "DISKO::AUTH_berlin3=geralt:2023-08-02-08-05-30:2023-08-04-08-05-30::e60a2e76975475a2a5584c7f616a3df2; expires=Fri, 04 Aug 2023 11:02:15 GMT; path=/designcheck/; domain=.berlin3.com"
            },
            {
              "name": "Vary",
              "value": "Accept-Encoding"
            },
            {
              "name": "Content-Encoding",
              "value": "gzip"
            },
            {
              "name": "Access-Control-Allow-Credentials",
              "value": "true"
            },
            {
              "name": "Content-Length",
              "value": "2851"
            },
            {
              "name": "Keep-Alive",
              "value": "timeout=30, max=79"
            },
            {
              "name": "Connection",
              "value": "Keep-Alive"
            },
            {
              "name": "Content-Type",
              "value": "text/html; charset=utf-8"
            }
          ],
          "cookies": [
            {
              "name": "DISKO::AUTH_berlin3",
              "value": "geralt:2023-08-02-08-05-30:2023-08-04-08-05-30::e60a2e76975475a2a5584c7f616a3df2"
            }
          ],
          "content": {
            "mimeType": "text/html; charset=utf-8",
            "size": 10676,
            "text": "\r\n<div class=\"wb\">\r\n  <table id=\"invoceline_header-575\" class=\"MainTableHead\">\r\n    <tr>\r\n      <td width=\"6%\" class=\"tda\">QTY</td>\r\n      <td width=\"22%\" class=\"tdb\">Article No</td>\r\n      <td width=\"42%\" class=\"tdc\">Description</td>\r\n      <td width=\"15%\" align=\"left\" class=\"tdd\">Price</td>                                   \r\n      <td width=\"7%\" align=\"right\" class=\"tdf\">Amount</td>\r\n      <td width=\"10%\" align=\"left\" class=\"tdg\" style=\"padding-left: 15px;\">VAT</td>\r\n      <td width=\"2%\" align=\"right\" class=\"tdh en_disble_on_lockflag\"><a href=\"#\" onclick=\"dynConObj.loadContent('invoicelines_div_575','accounting.pl?section=invoices&action=save_inoviceline&invoice_id=575&vat_type=1');\" class=\"addRow\"><img src=\"/images/newimg/Plus.png\" /></a></td>\r\n    </tr>\r\n  </table>\r\n</div>\r\n<div id=\"invoicelines_div_575\" class=\"h320 mb5\">\r\n  <table id=\"invoicelines_table-575\" class=\"MainTable\">\r\n    \r\n    \r\n    \r\n    <tr id=\"invoicline_row_3977\" class=\"odd en_disble_on_lockflag\">\r\n\t  <!-- only for statement invoicelines -->\t\t\r\n\t  \r\n\t  <td width=\"5%\" class=\"tda\"><input id=\"qty_3977\" type=\"text\" class=\"text stext disabled\" value=\"\" style=\"text-align:right;\" disabled=\"disabled\" /></td>\r\n      <td width=\"5%\" class=\"tdb\"><input id=\"booking_type_3977\" type=\"text\" class=\"disabled\" value=\"\" disabled=\"disabled\" /></td>\r\n      <td width=\"40%\" align=\"left\" class=\"tdc\"><textarea id=\"text_3977\" type=\"text\" class=\"text disabled\" style=\"width: 97%;height:15px;\" disabled=\"disabled\">Physical Sales M8/2023 (231 units)</textarea></td>\r\n      \r\n      <td width=\"10%\" align=\"left\" class=\"tdd\"><input id=\"price_3977\" type=\"text\" value=\"1165.78\" class=\"text mtext disabled\" style=\"text-align:right;\" disabled=\"disabled\" /></td>\r\n\r\n      \r\n      <!-- <td width=\"10%\" class=\"tda\"></td> -->\r\n      <!-- <td width=\"40%\" class=\"tdb\">Physical Sales M8/2023 (231 units)</td> -->\r\n      <!-- <td width=\"10%\" class=\"tdc\" align=\"right\">0</td> -->\r\n      <!-- <td width=\"10%\" class=\"tdd\" align=\"right\"></td> -->\r\n      <!-- <td width=\"10%\" class=\"tde\" align=\"right\">1,165.78 NZD</td> -->\r\n      <!-- <td width=\"15%\" class=\"tdf\" align=\"right\">1,165.78 NZD</td> -->\r\n\r\n\t     \r\n\r\n\t                             \r\n      <td width=\"10%\" align=\"right\" class=\"tdf\"><input id=\"total_3977\" type=\"text\" class=\"text mtext \"  value=\"1,165.78\" style=\"text-align:right; border: medium none; background-color: #ddd;\" readonly=\"readonly\" /></td>\r\n\r\n      <td width=\"6%\" align=\"left\" class=\"tdg\">\r\n        <select id=\"vat_type_575\" class=\"box\" style=\"width: 100%;\" onchange=\"BERLIN3.common.modify('invoiceline_id','3977','vat_type','invoicelines','0000-00-00 00:00:00',this);\">\r\n\t\t  <option></option>\r\n\t\t  <option value=\"1\" selected=\"selected\">19.00%</option>\r\n\t\t  <option value=\"2\" >6.00%</option>\r\n\t\t  <option value=\"3\" >0.00%</option>\r\n\t\t</select>\r\n      </td>\r\n\r\n      <td width=\"3%\" align=\"right\" class=\"tdh\"><a href=\"#\" onclick=\"deleteRowFromTable('invoicline_row_3977','invoicelines_table-575','accounting.pl','section=invoices&action=remove_invoiceline&invoiceline_id=3977');\" class=\"deleteRow\"><img src=\"/images/newimg/Cancel.png\" /></a></td>\r\n      \r\n    </tr>\t\r\n    \r\n  </table>\r\n</div>\r\n<div style=\"position:relative;margin: 5px 0px;\">\r\n  <div class=\"h90 en_disble_on_lockflag\" style=\"position:absolute;top:0;left:0;width:250px;display:none\" id=\"vat_rate_box_575\">\r\n    <table id=\"vat_rate_table-575\" style=\"width:100%;\" class=\"MainTable\">\r\n      <tr>\r\n        <td class=\"tda\" width=\"35%\">Vat Rate 1 = </td>\r\n        <td class=\"tdb\"><input id=\"vat_rate1_575\" type=\"text\" class=\"text stext\" value=\"19.00\" key_value=\"575\" column=\"vat_rate1\" table=\"invoices\" last_modified=\"2023-08-02 11:02:10\" style=\"text-align:right;\" /> %</td>                        \r\n        <td align=\"right\" class=\"tdc\"><span id=\"vat1_amount_cc_575\">0.00</span> NZD</td>\r\n      </tr>\r\n      <tr>\r\n        <td width=\"35%\">Vat Rate 2 = </td>\r\n        <td><input id=\"vat_rate2_575\" type=\"text\" class=\"text stext\" value=\"6.00\" key_value=\"575\" column=\"vat_rate2\" table=\"invoices\" last_modified=\"2023-08-02 11:02:10\" style=\"text-align:right;\" /> %</td>                        \r\n        <td align=\"right\"><span id=\"vat2_amount_cc_575\">0.00</span> NZD</td>\r\n      </tr>\r\n\t  <!--      <tr>\r\n\t\t\t\t<td width=\"35%\">Vat Rate 3 = </td>\r\n\t\t\t\t<td><span style=\"display:block;width:50px;text-align:right;\"> %</span></td>\r\n\t\t\t\t<td align=\"right\"></td>\r\n      </tr>                        -->\r\n    </table>\r\n  </div>\r\n  \r\n\r\n  <div id=\"invoice_vat_option_div_575\" class=\"h00 en_disble_on_lockflag\" style=\"height:90px;width:250px;margin-left:310px;\">\r\n\t<div style=\"padding: 3px;\">\r\n\t  <span class=\"column\" style=\"width:50%;\">\r\n\t\t<input type=\"radio\" name=\"vat_option_575\" value=\"1\" />&nbsp;VAT on top\r\n\t  </span>\r\n\t  <span class=\"column\" style=\"width:50%;\">\r\n\t\t<input type=\"radio\" name=\"vat_option_575\" value=\"2\" />&nbsp;Including VAT\r\n\t  </span>\r\n\t</div>\r\n\t<div style=\"padding: 3px;\">\r\n\t  <span class=\"column\" style=\"width:50%;\">\r\n\t\t<input type=\"radio\" name=\"vat_option_575\" value=\"3\" />&nbsp;No VAT\r\n\t  </span>\r\n\t  \r\n\t</div>\r\n\t<div style=\"padding: 3px;\">\r\n\t  <span class=\"column\" style=\"width:100%;display:inline\">\r\n\t\tWithholding Tax&nbsp;&nbsp;\r\n\t\t<select id=\"tax_deduction_575\" class=\"box\" style=\"width: 130px;\">\r\n\t\t  <option></option>\r\n\t\t  \r\n\t\t  <option value=\"1\">7% VAT</option>\r\n\t\t  \r\n\t\t  <option value=\"25\">French Taxes</option>\r\n\t\t  \r\n\t\t  <option value=\"3\">German Foreign Artist Tax -15% </option>\r\n\t\t  \r\n\t\t  <option value=\"24\">KSK</option>\r\n\t\t  \r\n\t\t  <option value=\"27\">Neue Tax Group</option>\r\n\t\t  \r\n\t\t  <option value=\"29\">Simo</option>\r\n\t\t  \r\n\t\t  <option value=\"30\">strom</option>\r\n\t\t  \r\n\t\t  <option value=\"26\">Test mit 2 Sätzen</option>\r\n\t\t  \r\n\t\t  <option value=\"28\">Update Test Group</option>\r\n\t\t  \r\n\t\t</select>\r\n\t  </span>\t\t\t\r\n\t</div>\r\n  </div>\r\n  \r\n  <div class=\"h90\" style=\"position:absolute;top:0;right:0;width:360px;padding: 0px 10px;\">\r\n\t\r\n\t<div style=\"margin-top:3px;\">\r\n\t\t<span class=\"column\" style=\"width: 70%;\">Net Amount</span>\r\n\t\t<span class=\"rcolumn\" style=\"width:28%;\">1,165.78 NZD</span>\r\n\t</div>\r\n\t\r\n\t<div style=\"margin-top:3px;\">\r\n\t\t<span class=\"column\" style=\"width: 70%;\">Gross Amount</span>\r\n\t\t<span class=\"rcolumn\" style=\"width:28%;\">1,165.78 NZD</span>\r\n\t</div>\r\n\t\r\n\t<div style=\"margin-top:3px;\">\r\n\t\t<span class=\"column\" style=\"width: 70%;\">Exchange Rate</span>\r\n\t\t<span class=\"rcolumn\" style=\"width:28%;\">1.785500 NZD</span>\r\n\t</div>\r\n\t\r\n\t<div style=\"margin-top:3px;\">\r\n\t\t<span class=\"column\" style=\"width: 70%;\">Net System Curr</span>\r\n\t\t<span class=\"rcolumn\" style=\"width:28%;\">652.92 EUR</span>\r\n\t</div>\r\n\t\r\n  </div>            \t\r\n</div>      \t        \r\n<div>\t\r\n  <span class=\"right\">\r\n\t<span>\r\n\t  <a href=\"javascript:void(0);\"><img id=\"invoiceLinesLockedUnlocked_575\" src=\"/images/newimg/unlocked.png\" invoice_id=\"575\" lock_flag=\"\" callback=\"berlin3.invoices.enDisbleDivsOnLockFlag\" onclick=\"berlin3.invoices.lockUnlockInvoice(this);\" /></a>\r\n\t</span>\r\n\r\n\t<span style=\"padding: 0 7px;\" >\r\n\t  <a href=\"javascript:void(0)\"><img src=\"/images/newimg/Edit.png\" onclick=\"berlin3.invoices.openInvoiceFlagChangeModal(this);\" invoice_id=\"575\" /></a>\r\n\t</span>\r\n\r\n    <span style=\"\">\r\n      <a href=\"javascript:void(0);\" onclick1=\"window.open('accounting.pl?section=invoices&action=print_invoice&invoice_id=575','_blank','menubar=yes,scrollbars=yes');\"><img src=\"/images/newimg/Printer.png\" onclick=\"berlin3.invoices.printInvoice(this);\" lockedUnlockedObj=\"#invoiceLinesLockedUnlocked_575\" invoice_id=\"575\" lock_flag=\"\" /></a>\r\n    </span>\r\n\r\n    <span style=\"padding-left: 5px; padding-right:20px; display: inline; vertical-align: middle;\">\r\n      <div style=\"width:10px;height:10px;background-color:#fffe00;border:1px solid #000;display:inline-block;\" invoice_id=\"575\" class=\"invoice-status-div\"></div>\r\n    </span>\r\n\r\n    <input type=\"button\" id=\"update_invoice_calculaiton_575\" value=\"Refresh\" />\r\n  </span>\r\n</div>\r\n\r\n<script type=\"text/javascript\">\r\n(function() {\r\n\tlet invoice_id = '575';\r\n\tlet vat_handling = '3';\r\n\tlet tax_type_id_deduction = '';\r\n\tlet vatDivId = 'invoice_vat_option_div_' + invoice_id;\r\n\tberlin3.common.compressHtml(document.getElementById(vatDivId));\r\n\r\n\tlet modify_vat_handling_tax = function(vat_handling, tax_type_id_deduction) {\r\n\t\tBERLIN3.common.wait('tabViewinvoice_tabview_' + invoice_id + '_1');\r\n\t\t$.post('accounting.pl', {\r\n\t\t\tsection: 'invoices',\r\n\t\t\taction: 'change_tax_type_deduction',\r\n\t\t\tinvoice_id: invoice_id,\r\n\t\t\tvat_handling: vat_handling,\r\n\t\t\ttax_type_id_deduction: tax_type_id_deduction\r\n\t\t}, function(data) {\r\n\t\t\t$('#tabViewinvoice_tabview_' + invoice_id + '_1').load('accounting.pl', {\r\n\t\t\t\tsection: 'invoices',\r\n\t\t\t\taction: 'invoice_tab_invoice_lines',\r\n\t\t\t\tinvoice_id: invoice_id\r\n\t\t\t});\r\n\t\t});\r\n\t};\r\n\t\r\n\t$('input[name=\"vat_option_' + invoice_id + '\"][value=\"'+ vat_handling +'\"]').prop(\"checked\", true);\t\r\n\t$('#tax_deduction_' + invoice_id).val(tax_type_id_deduction);\r\n\r\n\r\n\t$('#invoice_tabview_' + invoice_id + ' :input').attr('oldval',function(index,attr){\r\n\t\treturn this.value;\r\n\t});\r\n\r\n\t$('input.invoiceline-text-' + invoice_id).autocomplete({\r\n\t\tsource: \"accounting.pl?section=invoices&action=invoiceline_autocom_list\",\r\n\t\topen: function(event, ui) { $(\".ui-autocomplete\").css(\"z-index\", 10000); },\r\n\t\tclose: function(event, ui) { $(\".ui-autocomplete\").css(\"z-index\", 1); }\r\n\t});\r\n\r\n\r\n\t$('input[name=\"vat_option_' + invoice_id + '\"]').click(function() {\t\t\r\n\t\tvat_handling = $(this).val();\r\n\t\tmodify_vat_handling_tax(vat_handling, undefined);\r\n\t});\t\t\r\n\r\n\t$('#tax_deduction_' + invoice_id).change(function() {\t\t\r\n\t\ttax_type_id_deduction = $(this).val();\r\n\t\tmodify_vat_handling_tax(vat_handling, tax_type_id_deduction);\r\n\t});\r\n\r\n\t$('#update_invoice_calculaiton_' + invoice_id).click(function(evt) {\r\n\t\tBERLIN3.common.wait('tabViewinvoice_tabview_' + invoice_id + '_1');\r\n\t\t$.post('accounting.pl', {\r\n\t\t\tsection: 'invoices',\r\n\t\t\taction:'update_invoice_calculation',\r\n\t\t\tinvoice_id: invoice_id\r\n\t\t}, function(data) {\r\n\t\t\t$('#tabViewinvoice_tabview_' + invoice_id + '_1').load('accounting.pl', {\r\n\t\t\t\tsection: 'invoices',\r\n\t\t\t\taction: 'invoice_tab_invoice_lines',\r\n\t\t\t\tinvoice_id: invoice_id\r\n\t\t\t});\r\n\r\n\t\t}, \"json\");\r\n\t});\r\n\r\n\t$('#vat_rate1_' + invoice_id).blur(function(evt) {\r\n\t\tberlin3.common.modify(evt.target);\r\n\t\tlet vat_rate = $(evt.target).val();\r\n\t\t$(evt.target).val(Number(vat_rate).toFixed(2));\r\n\t});\r\n\r\n\t$('#vat_rate2_' + invoice_id).blur(function(evt) {\r\n\t\tberlin3.common.modify(evt.target);\r\n\t\tlet vat_rate = $(evt.target).val();\r\n\t\t$(evt.target).val(Number(vat_rate).toFixed(2));\r\n\t});\r\n\r\n})();\r\n\r\n$(document).ready(function(){\r\n\tberlin3.invoices.enDisbleDivsOnLockFlag($(\"<div></div>\").attr('invoice_id', \"575\").attr('lock_flag', \"\"));\r\n});\r\n\r\n</script>\r\n"
          },
          "redirectURL": "",
          "headersSize": 530,
          "bodySize": 3381
        },
        "cache": {},
        "timings": {
          "blocked": 0,
          "dns": 0,
          "connect": 0,
          "ssl": 0,
          "send": 0,
          "wait": 470,
          "receive": 0
        },
        "time": 470,
        "_securityState": "secure",
        "serverIPAddress": "79.125.7.197",
        "connection": "443",
        "pageref": "page_2"
      }
    ]
  }
}